<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è‹±è¯­å•è¯å¤§å†’é™© - äººæ•™ç‰ˆå…«å¹´çº§ä¸‹å†Œ(2024ç‰ˆ)</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            padding-top: 70px;
        }

        .nav-bar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
            padding: 0 20px;
        }

        .nav-bar-inner {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 50px;
        }

        .nav-logo {
            display: flex;
            align-items: center;
            gap: 10px;
            text-decoration: none;
            color: #333;
        }

        .nav-logo-icon {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 16px;
        }

        .nav-logo-text {
            font-weight: 700;
            font-size: 16px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .nav-links {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nav-link {
            padding: 6px 14px;
            border-radius: 20px;
            text-decoration: none;
            font-size: 13px;
            font-weight: 500;
            transition: all 0.2s ease;
            color: #666;
            background: #f5f5f5;
        }

        .nav-link:hover {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            transform: translateY(-1px);
        }

        .nav-link.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .stats-bar {
            background: white;
            border-radius: 15px;
            padding: 15px 30px;
            display: flex;
            justify-content: space-around;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            flex-wrap: wrap;
            gap: 15px;
        }

        .stat-item {
            text-align: center;
            min-width: 100px;
        }

        .stat-value {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
        }

        .stat-label {
            color: #666;
            font-size: 0.9em;
        }

        .game-section {
            background: white;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .section-title {
            font-size: 1.8em;
            color: #333;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .level-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .level-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
            border: none;
            font-size: 1em;
        }

        .level-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
        }

        .level-card.locked {
            background: #ccc;
            cursor: not-allowed;
            opacity: 0.6;
        }

        .level-card.completed {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
        }

        .level-card.current {
            box-shadow: 0 0 0 4px #ffd700;
        }

        .level-icon {
            font-size: 3em;
            margin-bottom: 10px;
        }

        .level-name {
            font-size: 1.3em;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .level-sections {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 10px;
        }

        .section-badge {
            background: rgba(255,255,255,0.2);
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.85em;
        }

        .level-wordcount {
            background: rgba(255,255,255,0.2);
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9em;
            margin-top: 10px;
            display: inline-block;
        }

        .mode-buttons {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-bottom: 30px;
        }

        .mode-btn {
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s;
            background: #667eea;
            color: white;
        }

        .mode-btn:hover {
            background: #5568d3;
            transform: scale(1.05);
        }

        .mode-btn.active {
            background: #11998e;
            box-shadow: 0 5px 15px rgba(17, 153, 142, 0.4);
        }

        .game-area {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 30px;
            min-height: 400px;
        }

        .unit-title {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }

        .word-card {
            background: white;
            border-radius: 15px;
            padding: 40px;
            text-align: center;
            margin: 20px 0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .word-english {
            font-size: 3em;
            color: #667eea;
            margin-bottom: 10px;
        }

        .word-chinese {
            font-size: 1.5em;
            color: #666;
        }

        .word-pronunciation {
            color: #999;
            font-style: italic;
            margin-top: 10px;
            font-size: 1.2em;
        }

        .input-area {
            margin: 20px 0;
        }

        .input-area input {
            width: 100%;
            max-width: 400px;
            padding: 15px 20px;
            font-size: 1.2em;
            border: 2px solid #ddd;
            border-radius: 10px;
            outline: none;
            transition: border-color 0.3s;
        }

        .input-area input:focus {
            border-color: #667eea;
        }

        .input-area input.correct {
            border-color: #11998e;
            background: #e8f5e9;
        }

        .input-area input.wrong {
            border-color: #e74c3c;
            background: #ffebee;
        }

        .action-btn {
            padding: 15px 40px;
            font-size: 1.2em;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            margin: 10px;
            transition: all 0.3s;
        }

        .btn-primary {
            background: #667eea;
            color: white;
        }

        .btn-primary:hover {
            background: #5568d3;
        }

        .btn-success {
            background: #11998e;
            color: white;
        }

        .btn-success:hover {
            background: #0d7d74;
        }

        .btn-danger {
            background: #e74c3c;
            color: white;
        }

        .btn-danger:hover {
            background: #c0392b;
        }

        .match-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .match-card {
            background: white;
            padding: 20px 15px;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            border: 3px solid #ddd;
            transition: all 0.3s;
            font-size: 1em;
            user-select: none;
            min-height: 70px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .match-card:hover {
            border-color: #667eea;
            transform: scale(1.02);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .match-card.selected {
            border-color: #667eea;
            background: linear-gradient(135deg, #e8eaf6 0%, #c5cae9 100%);
            transform: scale(1.05);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.5);
        }

        .match-card.matched {
            border-color: #11998e;
            background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
            opacity: 0.6;
            pointer-events: none;
            cursor: default;
        }

        .match-card.wrong {
            border-color: #e74c3c;
            background: #ffebee;
            animation: shake 0.5s;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .action-btn.recording {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%) !important;
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .feedback {
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
            font-size: 1.2em;
            display: none;
            font-weight: bold;
        }

        .feedback.correct {
            background: #e8f5e9;
            color: #0d7d74;
            display: block;
            border: 2px solid #11998e;
        }

        .feedback.wrong {
            background: #ffebee;
            color: #c0392b;
            display: block;
            border: 2px solid #e74c3c;
        }

        .skip-link {
            position: absolute;
            top: -40px;
            left: 0;
            background: #667eea;
            color: white;
            padding: 8px 16px;
            border-radius: 0 0 10px 0;
            z-index: 100;
            transition: top 0.3s;
        }

        .skip-link:focus {
            top: 0;
        }

        .action-btn:focus,
        .mode-btn:focus,
        .level-card:focus,
        .match-card:focus {
            outline: 3px solid #ffd700;
            outline-offset: 2px;
        }

        input:focus-visible {
            outline: 3px solid #667eea;
            outline-offset: 2px;
        }

        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            margin: 20px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            width: 0%;
            transition: width 0.5s;
        }

        .timer {
            font-size: 2em;
            text-align: center;
            color: #e74c3c;
            margin: 20px 0;
            font-weight: bold;
        }

        .achievements {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .achievement {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            border: 2px solid #ddd;
        }

        .achievement.unlocked {
            border-color: #ffd700;
            background: linear-gradient(135deg, #fff9e6 0%, #fff 100%);
        }

        .achievement-icon {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .match-info {
            text-align: center;
            margin-bottom: 15px;
            font-size: 1.1em;
            color: #666;
        }

        .match-info span {
            color: #667eea;
            font-weight: bold;
        }

        .card-front, .card-back {
            transition: all 0.3s;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8em;
            }
            
            .stats-bar {
                flex-direction: column;
                gap: 15px;
            }
            
            .match-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .mode-buttons {
                flex-direction: column;
            }
            
            .unit-title {
                flex-direction: column;
                gap: 10px;
                text-align: center;
            }
            
            .level-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <nav class="nav-bar">
        <div class="nav-bar-inner">
            <a href="/blog/" class="nav-logo">
                <div class="nav-logo-icon">ğŸ“š</div>
                <span class="nav-logo-text">ZHR Blog</span>
            </a>
            <div class="nav-links">
                <a href="/blog/" class="nav-link">é¦–é¡µ</a>
                <a href="/blog/eng.html" class="nav-link active">è‹±è¯­</a>
                <a href="/blog/cem.html" class="nav-link">åŒ–å­¦</a>
                <a href="/blog/tang-poems.html" class="nav-link">å”è¯—</a>
                <a href="/blog/c-utils" class="nav-link">ä»£ç åº“</a>
            </div>
        </div>
    </nav>
    <a href="#main-content" class="skip-link">è·³è½¬åˆ°ä¸»è¦å†…å®¹</a>
    <div class="container">
        <header class="header">
            <h1>ğŸ® è‹±è¯­å•è¯å¤§å†’é™©</h1>
            <p>äººæ•™ç‰ˆå…«å¹´çº§ä¸‹å†Œï¼ˆ2024æ–°ç‰ˆï¼‰| 8å•å…ƒå®Œæ•´è¯åº“</p>
        </header>

        <nav class="stats-bar" aria-label="å­¦ä¹ ç»Ÿè®¡">
            <div class="stat-item">
                <div class="stat-value" id="totalScore" aria-live="polite">0</div>
                <div class="stat-label">æ€»ç§¯åˆ†</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="completedLevels" aria-live="polite">0/4</div>
                <div class="stat-label">å®Œæˆå•å…ƒ</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="correctWords" aria-live="polite">0</div>
                <div class="stat-label">æŒæ¡å•è¯</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="streak" aria-live="polite">0</div>
                <div class="stat-label">è¿ç»­æ­£ç¡®</div>
            </div>
        </nav>

        <section class="game-section" aria-labelledby="level-title">
            <h2 class="section-title" id="level-title">ğŸ“š é€‰æ‹©å•å…ƒå…³å¡</h2>
            <div class="level-grid" id="levelGrid" role="list" aria-label="å•å…ƒå…³å¡åˆ—è¡¨">
                <!-- å…³å¡å¡ç‰‡ç”±JSç”Ÿæˆ -->
            </div>
        </section>

        <section class="game-section" id="main-content" aria-labelledby="game-title" tabindex="-1">
            <h2 class="section-title" id="game-title">ğŸ¯ æ¸¸æˆæ¨¡å¼</h2>
            <nav class="mode-buttons" aria-label="æ¸¸æˆæ¨¡å¼é€‰æ‹©">
                <button class="mode-btn active" data-mode="card" aria-pressed="true">ï¿½ å•è¯å¡ç‰‡</button>
                <button class="mode-btn" data-mode="match" aria-pressed="false">ğŸ”— å•è¯é…å¯¹</button>
                <button class="mode-btn" data-mode="spell" aria-pressed="false">âœï¸ æ‹¼å†™æŒ‘æˆ˜</button>
                <button class="mode-btn" data-mode="fill" aria-pressed="false">ï¿½ æƒ…æ™¯å¡«ç©º</button>
            </nav>

            <div class="game-area" id="gameArea" role="region" aria-live="polite" aria-label="æ¸¸æˆå†…å®¹åŒºåŸŸ">
                <!-- æ¸¸æˆå†…å®¹åŒºåŸŸ -->
            </div>

            <div class="feedback" id="feedback" role="alert" aria-live="assertive"></div>

            <div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" aria-label="å­¦ä¹ è¿›åº¦">
                <div class="progress-fill" id="progressFill"></div>
            </div>
        </section>

        <section class="game-section" aria-labelledby="achievement-title">
            <h2 class="section-title" id="achievement-title">ğŸ… æˆå°±ç³»ç»Ÿ</h2>
            <div class="achievements" id="achievements" role="list" aria-label="æˆå°±åˆ—è¡¨">
                <!-- æˆå°±ç”±JSç”Ÿæˆ -->
            </div>
        </section>
    </div>

    <script>
        // ============================================
        // äººæ•™ç‰ˆå…«å¹´çº§ä¸‹å†Œï¼ˆ2024æ–°ç‰ˆï¼‰å®Œæ•´å•è¯è¡¨
        // å…±8ä¸ªå•å…ƒ
        // ============================================
        const wordData = {
            unit1: [
                { english: 'relax', chinese: 'æ”¾æ¾ï¼›ä¼‘æ¯', pronunciation: '/rÉªËˆlÃ¦ks/' },
                { english: 'relaxed', chinese: 'æ”¾æ¾çš„ï¼›è‡ªåœ¨çš„', pronunciation: '/rÉªËˆlÃ¦kst/' },
                { english: 'relaxing', chinese: 'ä»¤äººæ”¾æ¾çš„', pronunciation: '/rÉªËˆlÃ¦ksÉªÅ‹/' },
                { english: 'stress', chinese: 'å‹åŠ›ï¼›ç´§å¼ ', pronunciation: '/stres/' },
                { english: 'tired', chinese: 'ç–²å€¦çš„ï¼›ç´¯çš„', pronunciation: '/ËˆtaÉªÉ™rd/' },
                { english: 'balanced', chinese: 'å¹³è¡¡çš„ï¼›å‡è¡¡çš„', pronunciation: '/ËˆbÃ¦lÉ™nst/' },
                { english: 'calligraphy', chinese: 'ä¹¦æ³•', pronunciation: '/kÉ™ËˆlÉªÉ¡rÉ™fi/' },
                { english: 'ski', chinese: 'æ»‘é›ª', pronunciation: '/skiË/' },
                { english: 'program', chinese: 'ç¨‹åºï¼›èŠ‚ç›®', pronunciation: '/ËˆproÊŠÉ¡rÃ¦m/' },
                { english: 'instructor', chinese: 'æ•™ç»ƒï¼›æŒ‡å¯¼è€…', pronunciation: '/ÉªnËˆstrÊŒktÉ™r/' },
                { english: 'fear', chinese: 'å®³æ€•ï¼›ææƒ§', pronunciation: '/fÉªr/' },
                { english: 'poem', chinese: 'è¯—', pronunciation: '/ËˆpoÊŠÉ™m/' },
                { english: 'stroke', chinese: 'ç¬”ç”»ï¼›å‡»çƒ', pronunciation: '/stroÊŠk/' },
                { english: 'ink', chinese: 'å¢¨æ°´', pronunciation: '/ÉªÅ‹k/' },
                { english: 'flute', chinese: 'é•¿ç¬›', pronunciation: '/fluËt/' },
                { english: 'hiking', chinese: 'å¾’æ­¥æ—…è¡Œ', pronunciation: '/ËˆhaÉªkÉªÅ‹/' },
                { english: 'painting', chinese: 'ç»˜ç”»', pronunciation: '/ËˆpeÉªntÉªÅ‹/' },
                { english: 'programming', chinese: 'ç¼–ç¨‹', pronunciation: '/ËˆproÊŠÉ¡rÃ¦mÉªÅ‹/' },
                { english: 'activity', chinese: 'æ´»åŠ¨', pronunciation: '/Ã¦kËˆtÉªvÉ™ti/' },
                { english: 'free-time', chinese: 'ç©ºé—²æ—¶é—´', pronunciation: '/friË taÉªm/' },
                { english: 'hobby', chinese: 'çˆ±å¥½', pronunciation: '/ËˆhÉ‘Ëbi/' },
                { english: 'collect', chinese: 'æ”¶é›†', pronunciation: '/kÉ™Ëˆlekt/' },
                { english: 'stamp', chinese: 'é‚®ç¥¨', pronunciation: '/stÃ¦mp/' },
                { english: 'coin', chinese: 'ç¡¬å¸', pronunciation: '/kÉ”Éªn/' },
                { english: 'interest', chinese: 'å…´è¶£', pronunciation: '/ËˆÉªntrÉ™st/' },
                { english: 'skill', chinese: 'æŠ€èƒ½ï¼›æŠ€å·§', pronunciation: '/skÉªl/' },
                { english: 'improve', chinese: 'æ”¹å–„ï¼›æé«˜', pronunciation: '/ÉªmËˆpruËv/' },
                { english: 'confidence', chinese: 'ä¿¡å¿ƒ', pronunciation: '/ËˆkÉ‘ËnfÉªdÉ™ns/' },
                { english: 'creative', chinese: 'æœ‰åˆ›é€ åŠ›çš„', pronunciation: '/kriËˆeÉªtÉªv/' },
                { english: 'enjoyable', chinese: 'ä»¤äººæ„‰å¿«çš„', pronunciation: '/ÉªnËˆdÊ’É”ÉªÉ™bl/' }
            ],
            unit2: [
                { english: 'healthy', chinese: 'å¥åº·çš„', pronunciation: '/ËˆhelÎ¸i/' },
                { english: 'health', chinese: 'å¥åº·', pronunciation: '/helÎ¸/' },
                { english: 'diet', chinese: 'é¥®é£Ÿ', pronunciation: '/ËˆdaÉªÉ™t/' },
                { english: 'exercise', chinese: 'é”»ç‚¼ï¼›è¿åŠ¨', pronunciation: '/ËˆeksÉ™rsaÉªz/' },
                { english: 'sleep', chinese: 'ç¡çœ ', pronunciation: '/sliËp/' },
                { english: 'energy', chinese: 'èƒ½é‡ï¼›ç²¾åŠ›', pronunciation: '/ËˆenÉ™rdÊ’i/' },
                { english: 'sore', chinese: 'ç–¼ç—›çš„', pronunciation: '/sÉ”Ër/' },
                { english: 'throat', chinese: 'å–‰å’™', pronunciation: '/Î¸roÊŠt/' },
                { english: 'stomachache', chinese: 'èƒƒç—›', pronunciation: '/ËˆstÊŒmÉ™keÉªk/' },
                { english: 'fever', chinese: 'å‘çƒ§', pronunciation: '/ËˆfiËvÉ™r/' },
                { english: 'cough', chinese: 'å’³å—½', pronunciation: '/kÉ”Ëf/' },
                { english: 'toothache', chinese: 'ç‰™ç—›', pronunciation: '/ËˆtuËÎ¸eÉªk/' },
                { english: 'headache', chinese: 'å¤´ç—›', pronunciation: '/ËˆhedeÉªk/' },
                { english: 'test', chinese: 'æ£€æµ‹ï¼›æµ‹è¯•', pronunciation: '/test/' },
                { english: 'flu', chinese: 'æµæ„Ÿ', pronunciation: '/fluË/' },
                { english: 'medicine', chinese: 'è¯', pronunciation: '/Ëˆmedsn/' },
                { english: 'mask', chinese: 'å£ç½©', pronunciation: '/mÃ¦sk/' },
                { english: 'virus', chinese: 'ç—…æ¯’', pronunciation: '/ËˆvaÉªrÉ™s/' },
                { english: 'patient', chinese: 'ç—…äºº', pronunciation: '/ËˆpeÉªÊƒnt/' },
                { english: 'injury', chinese: 'ä¼¤å®³ï¼›å—ä¼¤', pronunciation: '/ËˆÉªndÊ’É™ri/' },
                { english: 'illness', chinese: 'ç–¾ç—…', pronunciation: '/ËˆÉªlnÉ™s/' },
                { english: 'pain', chinese: 'ç–¼ç—›', pronunciation: '/peÉªn/' },
                { english: 'safety', chinese: 'å®‰å…¨', pronunciation: '/ËˆseÉªfti/' },
                { english: 'fry', chinese: 'æ²¹ç‚¸', pronunciation: '/fraÉª/' },
                { english: 'stove', chinese: 'ç‚‰å­', pronunciation: '/stoÊŠv/' },
                { english: 'flame', chinese: 'ç«ç„°', pronunciation: '/fleÉªm/' },
                { english: 'panic', chinese: 'ææ…Œ', pronunciation: '/ËˆpÃ¦nÉªk/' },
                { english: 'roll', chinese: 'ç¿»æ»šï¼›æ»šåŠ¨', pronunciation: '/roÊŠl/' },
                { english: 'aid', chinese: 'å¸®åŠ©ï¼›æ´åŠ©', pronunciation: '/eÉªd/' },
                { english: 'extinguisher', chinese: 'ç­ç«å™¨', pronunciation: '/ÉªkËˆstÉªÅ‹É¡wÉªÊƒÉ™r/' },
                { english: 'smoke', chinese: 'çƒŸï¼›å¸çƒŸ', pronunciation: '/smoÊŠk/' },
                { english: 'balanced diet', chinese: 'å‡è¡¡é¥®é£Ÿ', pronunciation: '/ËˆbÃ¦lÉ™nst daÉªÉ™t/' },
                { english: 'stay up', chinese: 'ç†¬å¤œ', pronunciation: '/steÉª ÊŒp/' },
                { english: 'physical', chinese: 'èº«ä½“çš„', pronunciation: '/ËˆfÉªzÉªkl/' },
                { english: 'mental', chinese: 'ç²¾ç¥çš„ï¼›å¿ƒç†çš„', pronunciation: '/Ëˆmentl/' }
            ],
            unit3: [
                { english: 'grow', chinese: 'æˆé•¿ï¼›ç”Ÿé•¿', pronunciation: '/É¡roÊŠ/' },
                { english: 'growth', chinese: 'æˆé•¿ï¼›å¢é•¿', pronunciation: '/É¡roÊŠÎ¸/' },
                { english: 'emotion', chinese: 'æƒ…æ„Ÿï¼›æƒ…ç»ª', pronunciation: '/ÉªËˆmoÊŠÊƒn/' },
                { english: 'emotional', chinese: 'æƒ…ç»ªçš„ï¼›æƒ…æ„Ÿçš„', pronunciation: '/ÉªËˆmoÊŠÊƒÉ™nl/' },
                { english: 'upset', chinese: 'éš¾è¿‡çš„ï¼›æ²®ä¸§çš„', pronunciation: '/ÊŒpËˆset/' },
                { english: 'lonely', chinese: 'å­¤ç‹¬çš„ï¼›å¯‚å¯çš„', pronunciation: '/ËˆloÊŠnli/' },
                { english: 'shocked', chinese: 'éœ‡æƒŠçš„', pronunciation: '/ÊƒÉ‘Ëkt/' },
                { english: 'alone', chinese: 'ç‹¬è‡ªï¼›å•ç‹¬', pronunciation: '/É™ËˆloÊŠn/' },
                { english: 'control', chinese: 'æ§åˆ¶', pronunciation: '/kÉ™nËˆtroÊŠl/' },
                { english: 'anger', chinese: 'æ€’ç«ï¼›æ„¤æ€’', pronunciation: '/ËˆÃ¦Å‹É¡É™r/' },
                { english: 'angry', chinese: 'ç”Ÿæ°”çš„', pronunciation: '/ËˆÃ¦Å‹É¡ri/' },
                { english: 'advise', chinese: 'å»ºè®®ï¼›åŠå‘Š', pronunciation: '/É™dËˆvaÉªz/' },
                { english: 'advice', chinese: 'å»ºè®®', pronunciation: '/É™dËˆvaÉªs/' },
                { english: 'hurtful', chinese: 'ä¼¤æ„Ÿæƒ…çš„', pronunciation: '/ËˆhÉœËrtfl/' },
                { english: 'forgive', chinese: 'åŸè°…ï¼›å®½æ•', pronunciation: '/fÉ™rËˆÉ¡Éªv/' },
                { english: 'friendship', chinese: 'å‹è°Š', pronunciation: '/ËˆfrendÊƒÉªp/' },
                { english: 'relationship', chinese: 'å…³ç³»', pronunciation: '/rÉªËˆleÉªÊƒnÊƒÉªp/' },
                { english: 'communicate', chinese: 'äº¤æµï¼›æ²Ÿé€š', pronunciation: '/kÉ™ËˆmjuËnÉªkeÉªt/' },
                { english: 'communication', chinese: 'äº¤æµï¼›æ²Ÿé€š', pronunciation: '/kÉ™ËŒmjuËnÉªËˆkeÉªÊƒn/' },
                { english: 'understand', chinese: 'ç†è§£', pronunciation: '/ËŒÊŒndÉ™rËˆstÃ¦nd/' },
                { english: 'misunderstand', chinese: 'è¯¯è§£', pronunciation: '/ËŒmÉªsÊŒndÉ™rËˆstÃ¦nd/' },
                { english: 'apologize', chinese: 'é“æ­‰', pronunciation: '/É™ËˆpÉ‘ËlÉ™dÊ’aÉªz/' },
                { english: 'apology', chinese: 'é“æ­‰', pronunciation: '/É™ËˆpÉ‘ËlÉ™dÊ’i/' },
                { english: 'trust', chinese: 'ä¿¡ä»»', pronunciation: '/trÊŒst/' },
                { english: 'respect', chinese: 'å°Šé‡', pronunciation: '/rÉªËˆspekt/' },
                { english: 'support', chinese: 'æ”¯æŒ', pronunciation: '/sÉ™ËˆpÉ”Ërt/' },
                { english: 'encourage', chinese: 'é¼“åŠ±', pronunciation: '/ÉªnËˆkÉœËrÉªdÊ’/' },
                { english: 'confidence', chinese: 'ä¿¡å¿ƒ', pronunciation: '/ËˆkÉ‘ËnfÉªdÉ™ns/' },
                { english: 'deal with', chinese: 'å¤„ç†ï¼›å¯¹ä»˜', pronunciation: '/diËl wÉªÃ°/' },
                { english: 'problem', chinese: 'é—®é¢˜', pronunciation: '/ËˆprÉ‘ËblÉ™m/' },
                { english: 'solve', chinese: 'è§£å†³', pronunciation: '/sÉ‘Ëlv/' },
                { english: 'solution', chinese: 'è§£å†³æ–¹æ¡ˆ', pronunciation: '/sÉ™ËˆluËÊƒn/' },
                { english: 'challenge', chinese: 'æŒ‘æˆ˜', pronunciation: '/ËˆtÊƒÃ¦lÉªndÊ’/' },
                { english: 'experience', chinese: 'ç»å†ï¼›ç»éªŒ', pronunciation: '/ÉªkËˆspÉªriÉ™ns/' },
                { english: 'teenager', chinese: 'é’å°‘å¹´', pronunciation: '/ËˆtiËneÉªdÊ’É™r/' }
            ],
            unit4: [
                { english: 'wonder', chinese: 'å¥‡è§‚ï¼›å¥‡è¿¹ï¼›æƒ³çŸ¥é“', pronunciation: '/ËˆwÊŒndÉ™r/' },
                { english: 'nature', chinese: 'è‡ªç„¶', pronunciation: '/ËˆneÉªtÊƒÉ™r/' },
                { english: 'natural', chinese: 'è‡ªç„¶çš„', pronunciation: '/ËˆnÃ¦tÊƒrÉ™l/' },
                { english: 'measurement', chinese: 'æµ‹é‡ï¼›å°ºå¯¸', pronunciation: '/ËˆmeÊ’É™rmÉ™nt/' },
                { english: 'measure', chinese: 'æµ‹é‡', pronunciation: '/ËˆmeÊ’É™r/' },
                { english: 'deep', chinese: 'æ·±çš„', pronunciation: '/diËp/' },
                { english: 'depth', chinese: 'æ·±åº¦', pronunciation: '/depÎ¸/' },
                { english: 'high', chinese: 'é«˜çš„', pronunciation: '/haÉª/' },
                { english: 'height', chinese: 'é«˜åº¦', pronunciation: '/haÉªt/' },
                { english: 'long', chinese: 'é•¿çš„', pronunciation: '/lÉ”ËÅ‹/' },
                { english: 'length', chinese: 'é•¿åº¦', pronunciation: '/leÅ‹Î¸/' },
                { english: 'wide', chinese: 'å®½çš„', pronunciation: '/waÉªd/' },
                { english: 'width', chinese: 'å®½åº¦', pronunciation: '/wÉªdÎ¸/' },
                { english: 'size', chinese: 'å¤§å°ï¼›å°ºå¯¸', pronunciation: '/saÉªz/' },
                { english: 'area', chinese: 'é¢ç§¯ï¼›åœ°åŒº', pronunciation: '/ËˆeriÉ™/' },
                { english: 'population', chinese: 'äººå£', pronunciation: '/ËŒpÉ‘ËpjuËˆleÉªÊƒn/' },
                { english: 'mountain', chinese: 'å±±', pronunciation: '/ËˆmaÊŠntn/' },
                { english: 'desert', chinese: 'æ²™æ¼ ', pronunciation: '/ËˆdezÉ™rt/' },
                { english: 'ocean', chinese: 'æµ·æ´‹', pronunciation: '/ËˆoÊŠÊƒn/' },
                { english: 'river', chinese: 'æ²³æµ', pronunciation: '/ËˆrÉªvÉ™r/' },
                { english: 'lake', chinese: 'æ¹–æ³Š', pronunciation: '/leÉªk/' },
                { english: 'waterfall', chinese: 'ç€‘å¸ƒ', pronunciation: '/ËˆwÉ”ËtÉ™rfÉ”Ël/' },
                { english: 'forest', chinese: 'æ£®æ—', pronunciation: '/ËˆfÉ”ËrÉªst/' },
                { english: 'amazing', chinese: 'ä»¤äººæƒŠå¥‡çš„', pronunciation: '/É™ËˆmeÉªzÉªÅ‹/' },
                { english: 'fantastic', chinese: 'æå¥½çš„', pronunciation: '/fÃ¦nËˆtÃ¦stÉªk/' },
                { english: 'spectacular', chinese: 'å£®è§‚çš„', pronunciation: '/spekËˆtÃ¦kjÉ™lÉ™r/' },
                { english: 'explore', chinese: 'æ¢ç´¢', pronunciation: '/ÉªkËˆsplÉ”Ër/' },
                { english: 'exploration', chinese: 'æ¢ç´¢', pronunciation: '/ËŒeksplÉ™ËˆreÉªÊƒn/' },
                { english: 'discover', chinese: 'å‘ç°', pronunciation: '/dÉªËˆskÊŒvÉ™r/' },
                { english: 'discovery', chinese: 'å‘ç°', pronunciation: '/dÉªËˆskÊŒvÉ™ri/' },
                { english: 'protect', chinese: 'ä¿æŠ¤', pronunciation: '/prÉ™Ëˆtekt/' },
                { english: 'protection', chinese: 'ä¿æŠ¤', pronunciation: '/prÉ™ËˆtekÊƒn/' },
                { english: 'environment', chinese: 'ç¯å¢ƒ', pronunciation: '/ÉªnËˆvaÉªrÉ™nmÉ™nt/' },
                { english: 'climate', chinese: 'æ°”å€™', pronunciation: '/ËˆklaÉªmÉ™t/' },
                { english: 'temperature', chinese: 'æ¸©åº¦', pronunciation: '/ËˆtemprÉ™tÊƒÉ™r/' },
                { english: 'level', chinese: 'æ°´å¹³ï¼›çº§åˆ«', pronunciation: '/Ëˆlevl/' },
                { english: 'surface', chinese: 'è¡¨é¢', pronunciation: '/ËˆsÉœËrfÉªs/' },
                { english: 'below', chinese: 'åœ¨â€¦ä¸‹é¢', pronunciation: '/bÉªËˆloÊŠ/' },
                { english: 'above', chinese: 'åœ¨â€¦ä¸Šé¢', pronunciation: '/É™ËˆbÊŒv/' },
                { english: 'earth', chinese: 'åœ°çƒ', pronunciation: '/ÉœËrÎ¸/' }
            ],
            unit5: [
                { english: 'temper', chinese: 'è„¾æ°”ï¼›æ€’æ°”', pronunciation: '/ËˆtempÉ™r/' },
                { english: 'earthquake', chinese: 'åœ°éœ‡', pronunciation: '/ËˆÉœËrÎ¸kweÉªk/' },
                { english: 'typhoon', chinese: 'å°é£', pronunciation: '/taÉªËˆfuËn/' },
                { english: 'wildfire', chinese: 'é‡ç«', pronunciation: '/ËˆwaÉªldfaÉªÉ™r/' },
                { english: 'snowstorm', chinese: 'æš´é£é›ª', pronunciation: '/ËˆsnoÊŠstÉ”Ërm/' },
                { english: 'flood', chinese: 'æ´ªæ°´ï¼›æ°´ç¾', pronunciation: '/flÊŒd/' },
                { english: 'drought', chinese: 'æ—±ç¾', pronunciation: '/draÊŠt/' },
                { english: 'warn', chinese: 'è­¦å‘Š', pronunciation: '/wÉ”Ërn/' },
                { english: 'wave', chinese: 'æ³¢æµªï¼›æŒ¥æ‰‹', pronunciation: '/weÉªv/' },
                { english: 'tsunami', chinese: 'æµ·å•¸', pronunciation: '/tsuËËˆnÉ‘Ëmi/' },
                { english: 'interview', chinese: 'é‡‡è®¿ï¼›é¢è¯•', pronunciation: '/ËˆÉªntÉ™rvjuË/' },
                { english: 'possibly', chinese: 'å¯èƒ½ï¼›æˆ–è®¸', pronunciation: '/ËˆpÉ‘ËsÉ™bli/' },
                { english: 'report', chinese: 'æŠ¥å‘Šï¼›æŠ¥é“', pronunciation: '/rÉªËˆpÉ”Ërt/' },
                { english: 'neighbourhood', chinese: 'è¡—åŒºï¼›ç¤¾åŒº', pronunciation: '/ËˆneÉªbÉ™rhÊŠd/' },
                { english: 'roof', chinese: 'å±‹é¡¶', pronunciation: '/ruËf/' },
                { english: 'nearly', chinese: 'å‡ ä¹ï¼›å·®ä¸å¤š', pronunciation: '/ËˆnÉªrli/' },
                { english: 'trouble', chinese: 'éº»çƒ¦ï¼›å›°éš¾', pronunciation: '/ËˆtrÊŒbl/' },
                { english: 'relative', chinese: 'äº²æˆš', pronunciation: '/ËˆrelÉ™tÉªv/' },
                { english: 'truck', chinese: 'å¡è½¦', pronunciation: '/trÊŒk/' },
                { english: 'supply', chinese: 'ä¾›åº”ï¼›è¡¥ç»™', pronunciation: '/sÉ™ËˆplaÉª/' },
                { english: 'preparation', chinese: 'å‡†å¤‡', pronunciation: '/ËŒprepÉ™ËˆreÉªÊƒn/' },
                { english: 'power', chinese: 'ç”µåŠ›ï¼›åŠ›é‡', pronunciation: '/ËˆpaÊŠÉ™r/' },
                { english: 'thick', chinese: 'åšçš„ï¼›æµ“å¯†çš„', pronunciation: '/Î¸Éªk/' },
                { english: 'beat', chinese: 'æ•²æ‰“ï¼›è·³åŠ¨', pronunciation: '/biËt/' },
                { english: 'hide', chinese: 'èº²è—', pronunciation: '/haÉªd/' },
                { english: 'tornado', chinese: 'é¾™å·é£', pronunciation: '/tÉ”ËrËˆneÉªdoÊŠ/' },
                { english: 'worst', chinese: 'æœ€åçš„', pronunciation: '/wÉœËrst/' },
                { english: 'refuse', chinese: 'æ‹’ç»', pronunciation: '/rÉªËˆfjuËz/' },
                { english: 'security', chinese: 'å®‰å…¨ï¼›ä¿å®‰', pronunciation: '/sÉªËˆkjÊŠrÉ™ti/' },
                { english: 'guard', chinese: 'å«å…µï¼›ä¿å«', pronunciation: '/É¡É‘Ërd/' },
                { english: 'nearby', chinese: 'é™„è¿‘çš„', pronunciation: '/ËˆnÉªrbaÉª/' },
                { english: 'scream', chinese: 'å°–å«', pronunciation: '/skriËm/' },
                { english: 'thankfully', chinese: 'å¹¸äºï¼›æ„Ÿæ¿€åœ°', pronunciation: '/ËˆÎ¸Ã¦Å‹kfÉ™li/' },
                { english: 'knowledge', chinese: 'çŸ¥è¯†', pronunciation: '/ËˆnÉ‘ËlÉªdÊ’/' },
                { english: 'except for', chinese: 'é™¤â€¦ä¹‹å¤–', pronunciation: '/ÉªkËˆsept fÉ”Ër/' },
                { english: 'hero', chinese: 'è‹±é›„', pronunciation: '/ËˆhÉªÉ™roÊŠ/' },
                { english: 'landslide', chinese: 'æ»‘å¡ï¼›å¡Œæ–¹', pronunciation: '/ËˆlÃ¦ndslaÉªd/' },
                { english: 'safeguard', chinese: 'ä¿æŠ¤ï¼›æå«', pronunciation: '/ËˆseÉªfÉ¡É‘Ërd/' },
                { english: 'rescue', chinese: 'æ•‘æ´', pronunciation: '/ËˆreskjuË/' },
                { english: 'heatwave', chinese: 'çƒ­æµª', pronunciation: '/ËˆhiËtweÉªv/' },
                { english: 'firefighter', chinese: 'æ¶ˆé˜²å‘˜', pronunciation: '/ËˆfaÉªÉ™rfaÉªtÉ™r/' },
                { english: 'volunteer', chinese: 'å¿—æ„¿è€…', pronunciation: '/ËŒvÉ‘ËlÉ™nËˆtÉªr/' },
                { english: 'alarm', chinese: 'è­¦æŠ¥ï¼›é—¹é’Ÿ', pronunciation: '/É™ËˆlÉ‘Ërm/' },
                { english: 'sudden', chinese: 'çªç„¶çš„', pronunciation: '/ËˆsÊŒdn/' },
                { english: 'thunder', chinese: 'é›·ï¼›é›·å£°', pronunciation: '/ËˆÎ¸ÊŒndÉ™r/' },
                { english: 'rainstorm', chinese: 'æš´é£é›¨', pronunciation: '/ËˆreÉªnstÉ”Ërm/' },
                { english: 'unlucky', chinese: 'ä¸å¹¸çš„', pronunciation: '/ÊŒnËˆlÊŒki/' }
            ],
            unit6: [
                { english: 'shake', chinese: 'æ¡æ‰‹ï¼›æ‘‡åŠ¨', pronunciation: '/ÊƒeÉªk/' },
                { english: 'bow', chinese: 'é èº¬', pronunciation: '/baÊŠ/' },
                { english: 'bump', chinese: 'ç¢°ï¼›æ’', pronunciation: '/bÊŒmp/' },
                { english: 'fist', chinese: 'æ‹³å¤´', pronunciation: '/fÉªst/' },
                { english: 'rub', chinese: 'æ‘©æ“¦ï¼›æ‰', pronunciation: '/rÊŒb/' },
                { english: 'kiss', chinese: 'äº²å»', pronunciation: '/kÉªs/' },
                { english: 'cheek', chinese: 'è„¸é¢Š', pronunciation: '/tÊƒiËk/' },
                { english: 'hug', chinese: 'æ‹¥æŠ±', pronunciation: '/hÊŒÉ¡/' },
                { english: 'embarrassed', chinese: 'å°´å°¬çš„', pronunciation: '/ÉªmËˆbÃ¦rÉ™st/' },
                { english: 'confused', chinese: 'å›°æƒ‘çš„', pronunciation: '/kÉ™nËˆfjuËzd/' },
                { english: 'formal', chinese: 'æ­£å¼çš„', pronunciation: '/ËˆfÉ”Ërml/' },
                { english: 'curry', chinese: 'å’–å–±èœ', pronunciation: '/ËˆkÊŒri/' },
                { english: 'rude', chinese: 'ç²—é²çš„', pronunciation: '/ruËd/' },
                { english: 'uncommon', chinese: 'ç½•è§çš„', pronunciation: '/ÊŒnËˆkÉ‘ËmÉ™n/' },
                { english: 'palm', chinese: 'æ‰‹æŒ', pronunciation: '/pÉ‘Ëm/' },
                { english: 'fork', chinese: 'å‰å­', pronunciation: '/fÉ”Ërk/' },
                { english: 'manner', chinese: 'æ–¹å¼ï¼›ç¤¼ä»ª', pronunciation: '/ËˆmÃ¦nÉ™r/' },
                { english: 'confusing', chinese: 'ä»¤äººå›°æƒ‘çš„', pronunciation: '/kÉ™nËˆfjuËzÉªÅ‹/' },
                { english: 'unless', chinese: 'é™¤é', pronunciation: '/É™nËˆles/' },
                { english: 'proper', chinese: 'æ°å½“çš„', pronunciation: '/ËˆprÉ‘ËpÉ™r/' },
                { english: 'elbow', chinese: 'æ‰‹è‚˜', pronunciation: '/ËˆelboÊŠ/' },
                { english: 'chopstick', chinese: 'ç­·å­', pronunciation: '/ËˆtÊƒÉ‘ËpstÉªk/' },
                { english: 'embarrassing', chinese: 'ä½¿äººéš¾å ªçš„', pronunciation: '/ÉªmËˆbÃ¦rÉ™sÉªÅ‹/' },
                { english: 'cultural', chinese: 'æ–‡åŒ–çš„', pronunciation: '/ËˆkÊŒltÊƒÉ™rÉ™l/' },
                { english: 'custom', chinese: 'ä¹ ä¿—', pronunciation: '/ËˆkÊŒstÉ™m/' },
                { english: 'occasion', chinese: 'åœºåˆ', pronunciation: '/É™ËˆkeÉªÊ’n/' },
                { english: 'blouse', chinese: 'å¥³å¼è¡¬è¡«', pronunciation: '/blaÊŠs/' },
                { english: 'private', chinese: 'ç§äººçš„', pronunciation: '/ËˆpraÉªvÉ™t/' },
                { english: 'whether', chinese: 'æ˜¯å¦', pronunciation: '/ËˆweÃ°É™r/' },
                { english: 'married', chinese: 'å·²å©šçš„', pronunciation: '/Ëˆmerid/' },
                { english: 'unsafe', chinese: 'ä¸å®‰å…¨çš„', pronunciation: '/ÊŒnËˆseÉªf/' },
                { english: 'improper', chinese: 'ä¸åˆé€‚çš„', pronunciation: '/ÉªmËˆprÉ‘ËpÉ™r/' },
                { english: 'informal', chinese: 'éæ­£å¼çš„', pronunciation: '/ÉªnËˆfÉ”Ërml/' },
                { english: 'jeans', chinese: 'ç‰›ä»”è£¤', pronunciation: '/dÊ’iËnz/' },
                { english: 'marry', chinese: 'ç»“å©š', pronunciation: '/Ëˆmeri/' },
                { english: 'congratulate', chinese: 'ç¥è´º', pronunciation: '/kÉ™nËˆÉ¡rÃ¦tÊƒuleÉªt/' },
                { english: 'Asian', chinese: 'äºšæ´²çš„ï¼›äºšæ´²äºº', pronunciation: '/ËˆeÉªÊƒn/' },
                { english: 'tradition', chinese: 'ä¼ ç»Ÿ', pronunciation: '/trÉ™ËˆdÉªÊƒn/' },
                { english: 'correctly', chinese: 'æ­£ç¡®åœ°', pronunciation: '/kÉ™Ëˆrektli/' },
                { english: 'receive', chinese: 'æ”¶åˆ°', pronunciation: '/rÉªËˆsiËv/' },
                { english: 'impression', chinese: 'å°è±¡', pronunciation: '/ÉªmËˆpreÊƒn/' },
                { english: 'cheer', chinese: 'æ¬¢å‘¼', pronunciation: '/tÊƒÉªr/' }
            ],
            unit7: [
                { english: 'adventure', chinese: 'å†’é™©ï¼›å†’é™©ç»å†', pronunciation: '/É™dËˆventÊƒÉ™r/' },
                { english: 'fantasy', chinese: 'å¹»æƒ³ï¼›å¹»æƒ³ä½œå“', pronunciation: '/ËˆfÃ¦ntÉ™si/' },
                { english: 'mystery', chinese: 'æ‚¬ç–‘å°è¯´ï¼›å¥¥ç§˜', pronunciation: '/ËˆmÉªstri/' },
                { english: 'fiction', chinese: 'å°è¯´', pronunciation: '/ËˆfÉªkÊƒn/' },
                { english: 'science fiction', chinese: 'ç§‘å¹»å°è¯´', pronunciation: '/ËˆsaÉªÉ™ns ËˆfÉªkÊƒn/' },
                { english: 'detective', chinese: 'ä¾¦æ¢', pronunciation: '/dÉªËˆtektÉªv/' },
                { english: 'alien', chinese: 'å¤–æ˜Ÿäºº', pronunciation: '/ËˆeÉªliÉ™n/' },
                { english: 'attack', chinese: 'æ”»å‡»ï¼›è¿›æ”»', pronunciation: '/É™ËˆtÃ¦k/' },
                { english: 'historical', chinese: 'å†å²çš„', pronunciation: '/hÉªËˆstÉ”ËrÉªkl/' },
                { english: 'force', chinese: 'å¼ºè¿«ï¼›åŠ›é‡', pronunciation: '/fÉ”Ërs/' },
                { english: 'steal', chinese: 'å·ï¼›çªƒå–', pronunciation: '/stiËl/' },
                { english: 'punish', chinese: 'æƒ©ç½š', pronunciation: '/ËˆpÊŒnÉªÊƒ/' },
                { english: 'idiom', chinese: 'ä¹ è¯­ï¼›æˆè¯­', pronunciation: '/ËˆÉªdiÉ™m/' },
                { english: 'recently', chinese: 'æœ€è¿‘', pronunciation: '/ËˆriËsntli/' },
                { english: 'lost', chinese: 'è¿·è·¯çš„ï¼›ä¸¢å¤±çš„', pronunciation: '/lÉ”Ëst/' },
                { english: 'recommend', chinese: 'æ¨è', pronunciation: '/ËŒrekÉ™Ëˆmend/' },
                { english: 'society', chinese: 'ç¤¾ä¼š', pronunciation: '/sÉ™ËˆsaÉªÉ™ti/' },
                { english: 'literary', chinese: 'æ–‡å­¦çš„', pronunciation: '/ËˆlÉªtÉ™reri/' },
                { english: 'base', chinese: 'ä»¥â€¦ä¸ºåŸºç¡€ï¼›åŸºç¡€', pronunciation: '/beÉªs/' },
                { english: 'summary', chinese: 'æ€»ç»“ï¼›æ¦‚è¦', pronunciation: '/ËˆsÊŒmÉ™ri/' },
                { english: 'spoiled', chinese: 'å® åçš„', pronunciation: '/spÉ”Éªld/' },
                { english: 'selfish', chinese: 'è‡ªç§çš„', pronunciation: '/ËˆselfÉªÊƒ/' },
                { english: 'lock', chinese: 'é”', pronunciation: '/lÉ‘Ëk/' },
                { english: 'unlock', chinese: 'å¼€é”', pronunciation: '/ÊŒnËˆlÉ‘Ëk/' },
                { english: 'secret', chinese: 'ç§˜å¯†', pronunciation: '/ËˆsiËkrÉ™t/' },
                { english: 'key', chinese: 'é’¥åŒ™ï¼›å…³é”®', pronunciation: '/kiË/' },
                { english: 'discover', chinese: 'å‘ç°', pronunciation: '/dÉªËˆskÊŒvÉ™r/' },
                { english: 'garden', chinese: 'èŠ±å›­', pronunciation: '/ËˆÉ¡É‘Ërdn/' },
                { english: 'wall', chinese: 'å¢™', pronunciation: '/wÉ”Ël/' },
                { english: 'surprise', chinese: 'æƒŠå–œï¼›æƒŠè®¶', pronunciation: '/sÉ™rËˆpraÉªz/' },
                { english: 'lonely', chinese: 'å­¤ç‹¬çš„', pronunciation: '/ËˆloÊŠnli/' },
                { english: 'friend', chinese: 'æœ‹å‹', pronunciation: '/frend/' },
                { english: 'magic', chinese: 'é­”æ³•', pronunciation: '/ËˆmÃ¦dÊ’Éªk/' },
                { english: 'character', chinese: 'è§’è‰²ï¼›äººç‰©', pronunciation: '/ËˆkÃ¦rÉ™ktÉ™r/' },
                { english: 'plot', chinese: 'æƒ…èŠ‚', pronunciation: '/plÉ‘Ët/' },
                { english: 'ending', chinese: 'ç»“å±€', pronunciation: '/ËˆendÉªÅ‹/' },
                { english: 'author', chinese: 'ä½œè€…', pronunciation: '/ËˆÉ”ËÎ¸É™r/' },
                { english: 'reader', chinese: 'è¯»è€…', pronunciation: '/ËˆriËdÉ™r/' },
                { english: 'classic', chinese: 'ç»å…¸ä½œå“', pronunciation: '/ËˆklÃ¦sÉªk/' },
                { english: 'novel', chinese: 'é•¿ç¯‡å°è¯´', pronunciation: '/ËˆnÉ‘Ëvl/' }
            ],
            unit8: [
                { english: 'treasure', chinese: 'è´¢å¯Œï¼›çå®', pronunciation: '/ËˆtreÊ’É™r/' },
                { english: 'island', chinese: 'å²›', pronunciation: '/ËˆaÉªlÉ™nd/' },
                { english: 'classic', chinese: 'ç»å…¸ä½œå“', pronunciation: '/ËˆklÃ¦sÉªk/' },
                { english: 'page', chinese: 'é¡µ', pronunciation: '/peÉªdÊ’/' },
                { english: 'hurry', chinese: 'åŒ†å¿™ï¼›èµ¶å¿«', pronunciation: '/ËˆhÉœËri/' },
                { english: 'due', chinese: 'é¢„æœŸçš„ï¼›åˆ°æœŸçš„', pronunciation: '/duË/' },
                { english: 'ship', chinese: 'èˆ¹', pronunciation: '/ÊƒÉªp/' },
                { english: 'tool', chinese: 'å·¥å…·', pronunciation: '/tuËl/' },
                { english: 'gun', chinese: 'æª', pronunciation: '/É¡ÊŒn/' },
                { english: 'mark', chinese: 'è®°å·ï¼›æ ‡è®°', pronunciation: '/mÉ‘Ërk/' },
                { english: 'sand', chinese: 'æ²™å­', pronunciation: '/sÃ¦nd/' },
                { english: 'cannibal', chinese: 'é£Ÿäººè‚‰è€…', pronunciation: '/ËˆkÃ¦nÉªbl/' },
                { english: 'towards', chinese: 'æœå‘', pronunciation: '/tÉ™ËˆwÉ”Ërdz/' },
                { english: 'land', chinese: 'é™†åœ°', pronunciation: '/lÃ¦nd/' },
                { english: 'fiction', chinese: 'å°è¯´', pronunciation: '/ËˆfÉªkÊƒn/' },
                { english: 'technology', chinese: 'ç§‘æŠ€', pronunciation: '/tekËˆnÉ‘ËlÉ™dÊ’i/' },
                { english: 'French', chinese: 'æ³•è¯­ï¼›æ³•å›½çš„', pronunciation: '/frentÊƒ/' },
                { english: 'pop', chinese: 'æµè¡ŒéŸ³ä¹', pronunciation: '/pÉ‘Ëp/' },
                { english: 'rock', chinese: 'æ‘‡æ»šä¹', pronunciation: '/rÉ‘Ëk/' },
                { english: 'band', chinese: 'ä¹é˜Ÿ', pronunciation: '/bÃ¦nd/' },
                { english: 'forever', chinese: 'æ°¸è¿œ', pronunciation: '/fÉ™rËˆevÉ™r/' },
                { english: 'abroad', chinese: 'åœ¨å›½å¤–', pronunciation: '/É™ËˆbrÉ”Ëd/' },
                { english: 'fan', chinese: 'è¿·ï¼›ç²‰ä¸', pronunciation: '/fÃ¦n/' },
                { english: 'southern', chinese: 'å—æ–¹çš„', pronunciation: '/ËˆsÊŒÃ°É™rn/' },
                { english: 'modern', chinese: 'ç°ä»£çš„', pronunciation: '/ËˆmÉ‘ËdÉ™rn/' },
                { english: 'success', chinese: 'æˆåŠŸ', pronunciation: '/sÉ™kËˆses/' },
                { english: 'belong', chinese: 'å±äº', pronunciation: '/bÉªËˆlÉ”ËÅ‹/' },
                { english: 'laughter', chinese: 'ç¬‘å£°', pronunciation: '/ËˆlÃ¦ftÉ™r/' },
                { english: 'beauty', chinese: 'ç¾ï¼›ç¾ä¸½', pronunciation: '/ËˆbjuËti/' },
                { english: 'record', chinese: 'è®°å½•ï¼›å”±ç‰‡', pronunciation: '/ËˆrekÉ™rd/' },
                { english: 'introduce', chinese: 'ä»‹ç»', pronunciation: '/ËŒÉªntrÉ™ËˆduËs/' },
                { english: 'line', chinese: 'è¡Œï¼›çº¿', pronunciation: '/laÉªn/' },
                { english: 'actually', chinese: 'äº‹å®ä¸Š', pronunciation: '/ËˆÃ¦ktÊƒuÉ™li/' },
                { english: 'million', chinese: 'ç™¾ä¸‡', pronunciation: '/ËˆmÉªljÉ™n/' },
                { english: 'abroad', chinese: 'åœ¨å›½å¤–', pronunciation: '/É™ËˆbrÉ”Ëd/' },
                { english: 'study', chinese: 'å­¦ä¹ ï¼›ç ”ç©¶', pronunciation: '/ËˆstÊŒdi/' }
            ]
        };

        const levelInfo = [
            { id: 1, unit: 'unit1', name: 'Unit 1 Time to Relax', icon: 'ğŸ¨', wordCount: 30, sectionA: 'ä¼‘é—²æ´»åŠ¨', sectionB: 'çˆ±å¥½ä¸æŠ€èƒ½' },
            { id: 2, unit: 'unit2', name: 'Unit 2 Stay Healthy', icon: 'ğŸ¥', wordCount: 35, sectionA: 'å¥åº·é—®é¢˜', sectionB: 'å®‰å…¨ä¸æ€¥æ•‘' },
            { id: 3, unit: 'unit3', name: 'Unit 3 Growing Up', icon: 'ğŸŒ±', wordCount: 35, sectionA: 'æƒ…ç»ªè¡¨è¾¾', sectionB: 'äººé™…äº¤å¾€' },
            { id: 4, unit: 'unit4', name: 'Unit 4 The Wonders of Nature', icon: 'ğŸ”ï¸', wordCount: 40, sectionA: 'è‡ªç„¶å¥‡è§‚', sectionB: 'æ¢ç´¢è‡ªç„¶' },
            { id: 5, unit: 'unit5', name: 'Unit 5 Nature\'s Temper', icon: 'ğŸŒªï¸', wordCount: 47, sectionA: 'è‡ªç„¶ç¾å®³', sectionB: 'å®‰å…¨é˜²èŒƒ' },
            { id: 6, unit: 'unit6', name: 'Unit 6 Crossing Cultures', icon: 'ğŸŒ', wordCount: 42, sectionA: 'æ–‡åŒ–ç¤¼ä»ª', sectionB: 'è·¨æ–‡åŒ–äº¤æµ' },
            { id: 7, unit: 'unit7', name: 'Unit 7 A Good Read', icon: 'ğŸ“š', wordCount: 40, sectionA: 'æ–‡å­¦ç±»å‹', sectionB: 'é˜…è¯»æ¨è' },
            { id: 8, unit: 'unit8', name: 'Unit 8', icon: 'ğŸ“–', wordCount: 36, sectionA: 'ç»å…¸æ–‡å­¦', sectionB: 'éŸ³ä¹æ–‡åŒ–' }
        ];

        const achievements = [
            { id: 1, name: 'æ–°æ‰‹å‹‡å£«', icon: 'ğŸŒŸ', condition: 'å®Œæˆç¬¬1å•å…ƒ' },
            { id: 2, name: 'è¿å‡»è¾¾äºº', icon: 'ğŸ”¥', condition: 'è¿ç»­æ­£ç¡®20ä¸ª' },
            { id: 3, name: 'æ‹¼å†™å¤§å¸ˆ', icon: 'âœï¸', condition: 'æ‹¼å†™æ¨¡å¼å…¨å¯¹10æ¬¡' },
            { id: 4, name: 'å•å…ƒç‹è€…', icon: 'ğŸ‘‘', condition: 'å®Œæˆå…¨éƒ¨8å•å…ƒ' },
            { id: 5, name: 'è¯æ±‡è¾¾äºº', icon: 'ğŸ“–', condition: 'æŒæ¡100ä¸ªå•è¯' },
            { id: 6, name: 'å®Œç¾é€šå…³', icon: 'ğŸ†', condition: 'å…¨éƒ¨å•å…ƒæ»¡åˆ†' }
        ];

        // æ¸¸æˆçŠ¶æ€
        let gameState = {
            currentLevel: 1,
            currentMode: 'card',
            score: 0,
            completedLevels: [],
            correctWords: 0,
            streak: 0,
            maxStreak: 0,
            unlockedAchievements: [],
            spellCorrectCount: 0,
            masteredWords: []
        };

        // é…å¯¹æ¸¸æˆçŠ¶æ€
        let matchState = {
            selectedCards: [],
            matchedPairs: 0,
            totalPairs: 0
        };

        // è¯­éŸ³æœ—è¯»åŠŸèƒ½
        let speechSynthesis = window.speechSynthesis;
        let currentUtterance = null;
        let speechRate = 0.8;

        function speakWord(word, rate = speechRate) {
            if (speechSynthesis.speaking) {
                speechSynthesis.cancel();
            }
            
            currentUtterance = new SpeechSynthesisUtterance(word);
            currentUtterance.lang = 'en-US';
            currentUtterance.rate = rate;
            currentUtterance.pitch = 1;
            
            const voices = speechSynthesis.getVoices();
            const englishVoice = voices.find(voice => voice.lang.includes('en'));
            if (englishVoice) {
                currentUtterance.voice = englishVoice;
            }
            
            speechSynthesis.speak(currentUtterance);
        }

        function speakWordSlowly(word) {
            speakWord(word, 0.5);
        }

        function stopSpeaking() {
            if (speechSynthesis.speaking) {
                speechSynthesis.cancel();
            }
        }

        // è¯­éŸ³è¯†åˆ«åŠŸèƒ½
        let recognition = null;
        let isListening = false;
        let currentMatchCard = null;

        function initSpeechRecognition() {
            if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                recognition = new SpeechRecognition();
                recognition.lang = 'en-US';
                recognition.continuous = false;
                recognition.interimResults = false;
                recognition.maxAlternatives = 3;

                recognition.onstart = () => {
                    isListening = true;
                    updateMicButton(true);
                };

                recognition.onend = () => {
                    isListening = false;
                    updateMicButton(false);
                };

                recognition.onerror = (event) => {
                    isListening = false;
                    updateMicButton(false);
                    console.log('è¯­éŸ³è¯†åˆ«é”™è¯¯:', event.error);
                    if (event.error === 'no-speech') {
                        showFeedback('ğŸ¤ æœªæ£€æµ‹åˆ°è¯­éŸ³ï¼Œè¯·é‡è¯•', 'wrong');
                    } else if (event.error === 'not-allowed') {
                        showFeedback('ğŸ¤ è¯·å…è®¸éº¦å…‹é£æƒé™', 'wrong');
                    }
                };

                recognition.onresult = (event) => {
                    const results = event.results[0];
                    let spokenWord = '';
                    for (let i = 0; i < results.length; i++) {
                        spokenWord += results[i].transcript + ' ';
                    }
                    spokenWord = spokenWord.trim().toLowerCase();
                    checkSpokenWord(spokenWord);
                };
            }
        }

        function startListening() {
            if (!recognition) {
                initSpeechRecognition();
            }
            
            if (!recognition) {
                showFeedback('ğŸ¤ æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³è¯†åˆ«', 'wrong');
                return;
            }

            if (isListening) {
                recognition.stop();
                return;
            }

            try {
                recognition.start();
                showFeedback('ğŸ¤ è¯·è¯´å‡ºè‹±æ–‡å•è¯...', 'info');
            } catch (e) {
                console.log('è¯­éŸ³è¯†åˆ«å¯åŠ¨å¤±è´¥:', e);
            }
        }

        function updateMicButton(listening) {
            const micBtn = document.getElementById('micBtn');
            if (micBtn) {
                if (listening) {
                    micBtn.innerHTML = 'ğŸ”´ å½•éŸ³ä¸­...';
                    micBtn.classList.add('recording');
                } else {
                    micBtn.innerHTML = 'ğŸ¤ è¯­éŸ³åŒ¹é…';
                    micBtn.classList.remove('recording');
                }
            }
        }

        function checkSpokenWord(spokenWord) {
            const currentWord = document.getElementById('currentMatchWord');
            if (!currentWord) return;
            
            const targetWord = currentWord.value.toLowerCase();
            const spokenWords = spokenWord.split(' ');
            
            let matched = false;
            for (let word of spokenWords) {
                if (word === targetWord || 
                    word === targetWord + 's' || 
                    word === targetWord + 'es' ||
                    word === targetWord + 'ed' ||
                    word === targetWord + 'ing' ||
                    targetWord.indexOf(word) === 0) {
                    matched = true;
                    break;
                }
            }

            if (matched) {
                showFeedback(`âœ“ æ­£ç¡®ï¼ä½ è¯´äº† "${spokenWord}" +10åˆ†`, 'correct');
                speakWord(targetWord);
                updateScore(10);
                updateStreak(true);
                updateProgress();
                if (currentMatchCard) {
                    autoMatchCard(currentMatchCard);
                }
            } else {
                showFeedback(`âœ— ä½ è¯´çš„æ˜¯ "${spokenWord}"ï¼Œæ­£ç¡®ç­”æ¡ˆæ˜¯ "${targetWord}"`, 'wrong');
                speakWord(targetWord);
                updateStreak(false);
            }
        }

        function autoMatchCard(card) {
            const cardId = card.dataset.id;
            const matchGrid = document.getElementById('matchGrid');
            const allCards = matchGrid.querySelectorAll('.match-card');
            
            allCards.forEach(c => {
                if (c.dataset.id === cardId && !c.classList.contains('matched')) {
                    c.classList.add('selected');
                    matchState.selectedCards.push(c);
                }
            });

            if (matchState.selectedCards.length >= 2) {
                setTimeout(() => checkMatch(), 300);
            }
        }

        // åŠ æƒéšæœºé€‰æ‹©å•è¯ï¼ˆå·²æŒæ¡çš„å•è¯å‡ºç°æ¦‚ç‡é™ä½ï¼‰
        function getWeightedRandomWord(words) {
            const weights = words.map(word => {
                if (gameState.masteredWords.includes(word.english)) {
                    return 0.2;
                }
                return 1;
            });
            
            const totalWeight = weights.reduce((sum, w) => sum + w, 0);
            let random = Math.random() * totalWeight;
            
            for (let i = 0; i < words.length; i++) {
                random -= weights[i];
                if (random <= 0) {
                    return words[i];
                }
            }
            
            return words[words.length - 1];
        }

        // åŠ æƒéšæœºé€‰æ‹©å¤šä¸ªå•è¯
        function getWeightedRandomWords(words, count) {
            const availableWords = [...words];
            const selected = [];
            
            for (let i = 0; i < Math.min(count, availableWords.length); i++) {
                const word = getWeightedRandomWord(availableWords);
                selected.push(word);
                const index = availableWords.indexOf(word);
                if (index > -1) {
                    availableWords.splice(index, 1);
                }
            }
            
            return selected;
        }

        // åˆå§‹åŒ–æ¸¸æˆ
        function initGame() {
            renderLevels();
            renderAchievements();
            loadGameMode();
            updateStats();
            loadProgress();
        }

        // ä¿å­˜è¿›åº¦
        function saveProgress() {
            localStorage.setItem('wordGameProgress2024', JSON.stringify(gameState));
        }

        // åŠ è½½è¿›åº¦
        function loadProgress() {
            const saved = localStorage.getItem('wordGameProgress2024');
            if (saved) {
                const data = JSON.parse(saved);
                gameState = { ...gameState, ...data };
                updateStats();
                renderLevels();
                renderAchievements();
            }
        }

        // æ¸²æŸ“å…³å¡
        function renderLevels() {
            const levelGrid = document.getElementById('levelGrid');
            levelGrid.innerHTML = '';

            levelInfo.forEach(level => {
                const card = document.createElement('button');
                card.className = 'level-card';
                card.setAttribute('role', 'listitem');
                card.setAttribute('aria-label', `${level.name}, ${level.wordCount}ä¸ªå•è¯${gameState.completedLevels.includes(level.id) ? ', å·²å®Œæˆ' : ''}`);
                
                if (gameState.completedLevels.includes(level.id)) {
                    card.classList.add('completed');
                    card.setAttribute('aria-disabled', 'false');
                }
                
                if (gameState.currentLevel === level.id) {
                    card.classList.add('current');
                    card.setAttribute('aria-current', 'true');
                }
                
                if (level.id > 1 && !gameState.completedLevels.includes(level.id - 1) && !gameState.completedLevels.includes(level.id)) {
                    card.classList.add('locked');
                    card.disabled = true;
                    card.setAttribute('aria-disabled', 'true');
                }

                card.innerHTML = `
                    <div class="level-icon" aria-hidden="true">${level.icon}</div>
                    <div class="level-name">${level.name}</div>
                    <div class="level-sections">
                        <span class="section-badge">Section A</span>
                        <span class="section-badge">Section B</span>
                    </div>
                    <div class="level-wordcount">${level.wordCount}è¯</div>
                `;

                card.onclick = () => selectLevel(level.id);
                levelGrid.appendChild(card);
            });
        }

        // é€‰æ‹©å…³å¡
        function selectLevel(levelId) {
            gameState.currentLevel = levelId;
            saveProgress();
            loadGameMode();
            
            document.getElementById('gameArea').scrollIntoView({ 
                behavior: 'smooth' 
            });
        }

        // æ¸²æŸ“æˆå°±
        function renderAchievements() {
            const achievementsDiv = document.getElementById('achievements');
            achievementsDiv.innerHTML = '';

            achievements.forEach(achievement => {
                const div = document.createElement('div');
                div.className = 'achievement';
                div.setAttribute('role', 'listitem');
                
                const isUnlocked = gameState.unlockedAchievements.includes(achievement.id);
                if (isUnlocked) {
                    div.classList.add('unlocked');
                }
                div.setAttribute('aria-label', `${achievement.name}: ${achievement.condition}${isUnlocked ? ', å·²è§£é”' : ', æœªè§£é”'}`);

                div.innerHTML = `
                    <div class="achievement-icon" aria-hidden="true">${achievement.icon}</div>
                    <div><strong>${achievement.name}</strong></div>
                    <div style="color: #555; font-size: 0.9em;">${achievement.condition}</div>
                `;

                achievementsDiv.appendChild(div);
            });
        }

        // åŠ è½½æ¸¸æˆæ¨¡å¼
        function loadGameMode() {
            const gameArea = document.getElementById('gameArea');
            const currentUnit = levelInfo[gameState.currentLevel - 1].unit;
            const words = wordData[currentUnit];
            const levelName = levelInfo[gameState.currentLevel - 1].name;

            // é‡ç½®é…å¯¹çŠ¶æ€
            matchState = {
                selectedCards: [],
                matchedPairs: 0,
                totalPairs: Math.min(8, words.length)
            };

            switch(gameState.currentMode) {
                case 'match':
                    renderMatchGame(words, gameArea, levelName);
                    break;
                case 'spell':
                    renderSpellGame(words, gameArea, levelName);
                    break;
                case 'fill':
                    renderFillGame(words, gameArea, levelName);
                    break;
                case 'card':
                    renderCardGame(words, gameArea, levelName);
                    break;
            }
        }

        // é…å¯¹æ¸¸æˆ
        function renderMatchGame(words, container, levelName) {
            const selectedWords = getWeightedRandomWords(words, matchState.totalPairs);
            
            let html = `<div class="unit-title">
                <span>${levelName} - ğŸ”— å•è¯é…å¯¹èµ›</span>
                <span class="level-wordcount">å…±${selectedWords.length}å¯¹</span>
            </div>`;
            html += '<div class="match-info" aria-live="polite">å·²é…å¯¹ï¼š<span id="matchedCount">0</span> / <span id="totalCount">' + selectedWords.length + '</span></div>';
            
            html += '<div style="text-align: center; margin-bottom: 15px;">';
            html += '<button id="micBtn" class="action-btn" onclick="startListening()" title="ç‚¹å‡»åè¯´å‡ºè‹±æ–‡å•è¯è¿›è¡ŒåŒ¹é…" style="font-size: 1.1em; padding: 10px 25px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">ğŸ¤ è¯­éŸ³åŒ¹é…</button>';
            html += '<span id="voiceHint" style="margin-left: 10px; color: #666; font-size: 0.9em;">ç‚¹å‡»åè¯´å‡ºè‹±æ–‡å•è¯</span>';
            html += '</div>';
            
            html += '<div class="match-grid" id="matchGrid" role="grid" aria-label="å•è¯é…å¯¹å¡ç‰‡åŒºåŸŸ">';

            let cards = [];
            selectedWords.forEach((word, index) => {
                cards.push({ type: 'en', text: word.english, id: index, english: word.english });
                cards.push({ type: 'zh', text: word.chinese, id: index, english: word.english });
            });

            cards.sort(() => Math.random() - 0.5);

            cards.forEach((card, index) => {
                const cardType = card.type === 'en' ? 'è‹±æ–‡' : 'ä¸­æ–‡';
                html += `<div class="match-card" role="gridcell" tabindex="0" data-type="${card.type}" data-id="${card.id}" data-english="${card.english}" data-index="${index}" aria-label="${cardType}: ${card.text}" onclick="selectMatchCard(this)" onkeydown="handleCardKeydown(event, this)">
                    ${card.text}
                </div>`;
            });

            html += '</div>';
            html += '<div style="text-align: center; margin-top: 20px;">';
            html += '<button class="action-btn btn-success" onclick="loadGameMode()">ğŸ”„ é‡æ–°å¼€å§‹</button>';
            html += '<button class="action-btn btn-primary" onclick="changeMode(\'spell\')">â¡ï¸ åˆ‡æ¢æ¨¡å¼</button>';
            html += '</div>';
            html += '<input type="hidden" id="currentMatchWord" value="">';

            container.innerHTML = html;

            document.getElementById('matchedCount').textContent = '0';
            document.getElementById('totalCount').textContent = selectedWords.length;
            
            if (!recognition) {
                initSpeechRecognition();
            }
        }

        // å¤„ç†å¡ç‰‡é”®ç›˜äº‹ä»¶
        function handleCardKeydown(event, card) {
            if (event.key === 'Enter' || event.key === ' ') {
                event.preventDefault();
                selectMatchCard(card);
            }
        }

        // é€‰æ‹©é…å¯¹å¡ç‰‡
        function selectMatchCard(card) {
            if (card.classList.contains('matched')) return;
            if (matchState.selectedCards.length >= 2) return;

            if (matchState.selectedCards.includes(card)) {
                card.classList.remove('selected');
                matchState.selectedCards = matchState.selectedCards.filter(c => c !== card);
                return;
            }

            card.classList.add('selected');
            matchState.selectedCards.push(card);
            
            if (card.dataset.type === 'en') {
                speakWord(card.textContent.trim());
            } else {
                const currentWordInput = document.getElementById('currentMatchWord');
                if (currentWordInput) {
                    currentWordInput.value = card.dataset.english;
                    currentMatchCard = card;
                }
            }

            if (matchState.selectedCards.length === 2) {
                setTimeout(() => checkMatch(), 300);
            }
        }

        // æ£€æŸ¥é…å¯¹
        function checkMatch() {
            const cards = matchState.selectedCards;
            if (cards.length !== 2) return;

            const type1 = cards[0].dataset.type;
            const type2 = cards[1].dataset.type;
            const id1 = cards[0].dataset.id;
            const id2 = cards[1].dataset.id;

            if (type1 !== type2 && id1 === id2) {
                cards.forEach(card => {
                    card.classList.remove('selected');
                    card.classList.add('matched');
                });
                
                matchState.matchedPairs++;
                const matchedEl = document.getElementById('matchedCount');
                if (matchedEl) matchedEl.textContent = matchState.matchedPairs;
                
                showFeedback('âœ“ é…å¯¹æ­£ç¡®ï¼+10åˆ†', 'correct');
                updateScore(10);
                updateStreak(true);
                
                if (matchState.matchedPairs >= matchState.totalPairs) {
                    setTimeout(() => {
                        showFeedback('ğŸ‰ æ­å–œï¼å…¨éƒ¨é…å¯¹å®Œæˆï¼+50åˆ†', 'correct');
                        updateScore(50);
                        completeLevel();
                    }, 500);
                }
            } else {
                cards.forEach(card => {
                    card.classList.add('wrong');
                    setTimeout(() => {
                        card.classList.remove('wrong', 'selected');
                    }, 500);
                });
                
                showFeedback('âœ— é…å¯¹é”™è¯¯ï¼Œå†è¯•ä¸€æ¬¡', 'wrong');
                updateStreak(false);
            }

            matchState.selectedCards = [];
            updateProgress();
        }

        // å®Œæˆå…³å¡
        function completeLevel() {
            if (!gameState.completedLevels.includes(gameState.currentLevel)) {
                gameState.completedLevels.push(gameState.currentLevel);
                saveProgress();
                renderLevels();
                updateStats();
                checkAchievements();
            }
        }

        // æ‹¼å†™æ¸¸æˆ
        function renderSpellGame(words, container, levelName) {
            const randomWord = getWeightedRandomWord(words);
            
            let html = `<div class="unit-title">
                <span>${levelName} - âœï¸ æ‹¼å†™æŒ‘æˆ˜</span>
                <span class="level-wordcount">å·²æ­£ç¡®${gameState.spellCorrectCount}æ¬¡</span>
            </div>`;
            html += '<p style="text-align: center; color: #555; margin-bottom: 20px;">å¬è¯­éŸ³æ‹¼å†™å•è¯ï¼Œæˆ–ç‚¹å‡»ğŸ¤æŒ‰é’®è¯­éŸ³è¾“å…¥</p>';
            html += '<div class="word-card" role="region" aria-label="å•è¯æç¤º">';
            html += `<div class="word-chinese">${randomWord.chinese}</div>`;
            html += `<div class="word-pronunciation">${randomWord.pronunciation}</div>`;
            html += '</div>';
            html += '<div style="text-align: center; margin-bottom: 15px;">';
            html += `<button class="action-btn" onclick="speakWord('${randomWord.english}')" title="æ­£å¸¸è¯­é€Ÿæœ—è¯»" style="font-size: 1.2em; padding: 10px 20px;">ğŸ”Š æœ—è¯»</button>`;
            html += `<button class="action-btn" onclick="speakWordSlowly('${randomWord.english}')" title="æ…¢é€Ÿæœ—è¯»" style="font-size: 1.2em; padding: 10px 20px;">ğŸ¢ æ…¢è¯»</button>`;
            html += `<button id="spellMicBtn" class="action-btn" onclick="startSpellListening()" title="è¯­éŸ³è¾“å…¥ç­”æ¡ˆ" style="font-size: 1.2em; padding: 10px 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">ğŸ¤ è¯­éŸ³è¾“å…¥</button>`;
            html += '</div>';
            html += '<div class="input-area">';
            html += `<label for="spellInput" class="sr-only">è¾“å…¥è‹±æ–‡å•è¯</label>`;
            html += `<input type="text" id="spellInput" placeholder="è¾“å…¥è‹±æ–‡å•è¯æˆ–ç‚¹å‡»ğŸ¤è¯­éŸ³è¾“å…¥..." autocomplete="off" aria-describedby="spell-hint">`;
            html += `<span id="spell-hint" class="sr-only">ä¸­æ–‡æç¤ºï¼š${randomWord.chinese}ï¼Œè¯·æ‹¼å†™å¯¹åº”çš„è‹±æ–‡å•è¯</span>`;
            html += '</div>';
            html += '<div style="text-align: center;">';
            html += '<button class="action-btn btn-primary" onclick="checkSpell()">æäº¤ç­”æ¡ˆ</button>';
            html += '<button class="action-btn btn-success" onclick="loadGameMode()">ä¸‹ä¸€ä¸ª</button>';
            html += '<button class="action-btn btn-danger" onclick="showHint()">ğŸ’¡ æç¤º</button>';
            html += '</div>';
            html += `<input type="hidden" id="correctAnswer" value="${randomWord.english}">`;
            html += `<input type="hidden" id="currentWord" value="${randomWord.english}">`;

            container.innerHTML = html;

            document.getElementById('spellInput').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') checkSpell();
            });
            
            setTimeout(() => {
                const input = document.getElementById('spellInput');
                if (input) input.focus();
            }, 300);
            
            if (!recognition) {
                initSpeechRecognition();
            }
        }
        
        let spellRecognition = null;
        let isSpellListening = false;
        let fillRecognition = null;
        let isFillListening = false;
        
        function initSpellRecognition() {
            if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                spellRecognition = new SpeechRecognition();
                spellRecognition.lang = 'en-US';
                spellRecognition.continuous = false;
                spellRecognition.interimResults = false;
                spellRecognition.maxAlternatives = 1;

                spellRecognition.onstart = () => {
                    isSpellListening = true;
                    updateSpellMicButton(true);
                    showFeedback('ğŸ¤ è¯·è¯´å‡ºè‹±æ–‡å•è¯...', 'info');
                };

                spellRecognition.onend = () => {
                    isSpellListening = false;
                    updateSpellMicButton(false);
                };

                spellRecognition.onerror = (event) => {
                    isSpellListening = false;
                    updateSpellMicButton(false);
                    if (event.error === 'no-speech') {
                        showFeedback('ğŸ¤ æœªæ£€æµ‹åˆ°è¯­éŸ³ï¼Œè¯·é‡è¯•', 'wrong');
                    } else if (event.error === 'not-allowed') {
                        showFeedback('ğŸ¤ è¯·å…è®¸éº¦å…‹é£æƒé™', 'wrong');
                    }
                };

                spellRecognition.onresult = (event) => {
                    const spokenWord = event.results[0][0].transcript.trim();
                    const input = document.getElementById('spellInput');
                    if (input) {
                        input.value = spokenWord;
                        showFeedback(`ğŸ¤ è¯†åˆ«ç»“æœ: "${spokenWord}"`, 'info');
                        setTimeout(() => checkSpell(), 500);
                    }
                };
            }
        }
        
        function startSpellListening() {
            if (!spellRecognition) {
                initSpellRecognition();
            }
            
            if (!spellRecognition) {
                showFeedback('ğŸ¤ æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³è¯†åˆ«', 'wrong');
                return;
            }

            if (isSpellListening) {
                spellRecognition.stop();
                return;
            }

            try {
                spellRecognition.start();
            } catch (e) {
                console.log('è¯­éŸ³è¯†åˆ«å¯åŠ¨å¤±è´¥:', e);
            }
        }
        
        function updateSpellMicButton(listening) {
            const micBtn = document.getElementById('spellMicBtn');
            if (micBtn) {
                if (listening) {
                    micBtn.innerHTML = 'ğŸ”´ å½•éŸ³ä¸­...';
                    micBtn.classList.add('recording');
                } else {
                    micBtn.innerHTML = 'ğŸ¤ è¯­éŸ³è¾“å…¥';
                    micBtn.classList.remove('recording');
                }
            }
        }

        // å¡«ç©ºæ¸¸æˆ
        function renderFillGame(words, container, levelName) {
            const randomWord = getWeightedRandomWord(words);
            
            let html = `<div class="unit-title">
                <span>${levelName} - ğŸ“ æƒ…æ™¯å¡«ç©º</span>
            </div>`;
            html += '<p style="text-align: center; color: #555; margin-bottom: 20px;">å°†å•è¯å¡«å…¥æ­£ç¡®çš„å¥å­ä¸­</p>';
            html += '<div class="word-card" role="region" aria-label="å¡«ç©ºå¥å­">';
            html += `<div class="word-chinese" style="font-size: 1.3em;">${generateSentence(randomWord.english)}</div>`;
            html += '</div>';
            html += '<div class="input-area">';
            html += `<label for="fillInput" class="sr-only">è¾“å…¥å•è¯</label>`;
            html += `<input type="text" id="fillInput" placeholder="è¾“å…¥å•è¯..." autocomplete="off">`;
            html += '</div>';
            html += '<div style="text-align: center;">';
            html += '<button class="action-btn btn-primary" onclick="checkFill()">æäº¤ç­”æ¡ˆ</button>';
            html += '<button id="fillMicBtn" class="action-btn" onclick="startFillListening()" title="è¯­éŸ³è¾“å…¥" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">ğŸ¤ è¯­éŸ³è¾“å…¥</button>';
            html += '<button class="action-btn btn-success" onclick="loadGameMode()">ä¸‹ä¸€ä¸ª</button>';
            html += '</div>';
            html += `<input type="hidden" id="correctAnswer" value="${randomWord.english}">`;

            container.innerHTML = html;

            document.getElementById('fillInput').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') checkFill();
            });
            
            setTimeout(() => {
                const input = document.getElementById('fillInput');
                if (input) input.focus();
            }, 100);
        }
        
        function initFillRecognition() {
            if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                fillRecognition = new SpeechRecognition();
                fillRecognition.lang = 'en-US';
                fillRecognition.continuous = false;
                fillRecognition.interimResults = false;
                fillRecognition.maxAlternatives = 1;

                fillRecognition.onstart = () => {
                    isFillListening = true;
                    updateFillMicButton(true);
                    showFeedback('ğŸ¤ è¯·è¯´å‡ºè‹±æ–‡å•è¯...', 'info');
                };

                fillRecognition.onend = () => {
                    isFillListening = false;
                    updateFillMicButton(false);
                };

                fillRecognition.onerror = (event) => {
                    isFillListening = false;
                    updateFillMicButton(false);
                    if (event.error === 'no-speech') {
                        showFeedback('ğŸ¤ æœªæ£€æµ‹åˆ°è¯­éŸ³ï¼Œè¯·é‡è¯•', 'wrong');
                    } else if (event.error === 'not-allowed') {
                        showFeedback('ğŸ¤ è¯·å…è®¸éº¦å…‹é£æƒé™', 'wrong');
                    }
                };

                fillRecognition.onresult = (event) => {
                    const spokenWord = event.results[0][0].transcript.trim();
                    const input = document.getElementById('fillInput');
                    if (input) {
                        input.value = spokenWord;
                        showFeedback(`ğŸ¤ è¯†åˆ«ç»“æœ: "${spokenWord}"`, 'info');
                        setTimeout(() => checkFill(), 500);
                    }
                };
            }
        }
        
        function startFillListening() {
            if (!fillRecognition) {
                initFillRecognition();
            }
            
            if (!fillRecognition) {
                showFeedback('ğŸ¤ æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³è¯†åˆ«', 'wrong');
                return;
            }

            if (isFillListening) {
                fillRecognition.stop();
                return;
            }

            try {
                fillRecognition.start();
            } catch (e) {
                console.log('è¯­éŸ³è¯†åˆ«å¯åŠ¨å¤±è´¥:', e);
            }
        }
        
        function updateFillMicButton(listening) {
            const micBtn = document.getElementById('fillMicBtn');
            if (micBtn) {
                if (listening) {
                    micBtn.innerHTML = 'ğŸ”´ å½•éŸ³ä¸­...';
                    micBtn.classList.add('recording');
                } else {
                    micBtn.innerHTML = 'ğŸ¤ è¯­éŸ³è¾“å…¥';
                    micBtn.classList.remove('recording');
                }
            }
        }

        // ç”Ÿæˆä¾‹å¥
        function generateSentence(word) {
            const sentences = {
                'relax': "It's important to ______ after a long day of work.",
                'relaxed': "She felt very ______ after the vacation.",
                'relaxing': "Listening to music is very ______ for me.",
                'stress': "Too much ______ can be bad for your health.",
                'tired': "I feel very ______ after running for an hour.",
                'balanced': "A ______ diet is important for good health.",
                'calligraphy': "Chinese ______ is a beautiful art form.",
                'ski': "We plan to ______ in the mountains this winter.",
                'program': "The computer ______ helps us work faster.",
                'instructor': "The ______ taught us how to swim.",
                'fear': "Don't let ______ stop you from trying new things.",
                'poem': "She wrote a beautiful ______ about spring.",
                'stroke': "Each ______ in Chinese writing is important.",
                'ink': "Please put more ______ in the pen.",
                'flute': "She plays the ______ very well.",
                'hiking': "______ is a great way to enjoy nature.",
                'painting': "This ______ was created by a famous artist.",
                'programming': "Learning ______ can help you build apps.",
                'activity': "What ______ do you like to do on weekends?",
                'hobby': "Reading is my favorite ______.",
                'collect': "I like to ______ stamps from different countries.",
                'stamp': "This ______ is worth a lot of money.",
                'coin': "He found an old ______ in the garden.",
                'interest': "I have a strong ______ in music.",
                'skill': "Learning a new ______ takes time and practice.",
                'improve': "Practice helps you ______ your skills.",
                'confidence': "She has great ______ in her abilities.",
                'creative': "Artists are usually very ______ people.",
                'enjoyable': "The trip was very ______ for everyone.",
                'healthy': "Eating vegetables helps you stay ______.",
                'health': "Exercise is good for your ______.",
                'diet': "A balanced ______ is important for everyone.",
                'exercise': "You should ______ for at least 30 minutes every day.",
                'sleep': "Getting enough ______ is important for health.",
                'energy': "Breakfast gives you ______ for the day.",
                'sore': "My throat feels ______ after singing.",
                'throat': "Drink warm water for a sore ______.",
                'stomachache': "I have a ______ from eating too much.",
                'fever': "She has a high ______ and needs to rest.",
                'cough': "Cover your mouth when you ______.",
                'toothache': "A ______ can be very painful.",
                'headache': "I have a ______ from staring at the screen.",
                'test': "We have a ______ tomorrow morning.",
                'flu': "She caught the ______ and stayed home.",
                'medicine': "Take this ______ three times a day.",
                'mask': "Wear a ______ to protect yourself.",
                'virus': "The ______ spreads quickly in winter.",
                'patient': "The ______ is waiting for the doctor.",
                'injury': "He suffered a serious ______ in the accident.",
                'illness': "The ______ kept her in bed for a week.",
                'pain': "The ______ in my leg is getting better.",
                'safety': "______ is the most important thing.",
                'fry': "Don't ______ the food for too long.",
                'stove': "Turn off the ______ after cooking.",
                'flame': "Keep away from the open ______.",
                'panic': "Don't ______ in an emergency.",
                'roll': "The ball began to ______ down the hill.",
                'aid': "First ______ can save lives.",
                'extinguisher': "Use a fire ______ to put out small fires.",
                'smoke': "______ is dangerous to your health.",
                'physical': "______ exercise keeps you fit.",
                'mental': "______ health is as important as physical health.",
                'grow': "Children ______ quickly in their early years.",
                'growth': "The ______ of plants needs sunlight and water.",
                'emotion': "Learning to control your ______ is part of growing up.",
                'emotional': "She became very ______ during the movie.",
                'upset': "Don't be ______ about the small mistake.",
                'lonely': "He felt ______ after moving to a new city.",
                'shocked': "I was ______ by the unexpected news.",
                'alone': "She prefers to work ______.",
                'control': "It's hard to ______ your anger sometimes.",
                'anger': "He couldn't hide his ______.",
                'angry': "Don't get ______ over small things.",
                'advise': "I ______ you to study harder.",
                'advice': "Thank you for your good ______.",
                'hurtful': "His words were very ______ to me.",
                'forgive': "It's important to ______ others' mistakes.",
                'friendship': "A true ______ lasts forever.",
                'relationship': "A good ______ needs trust and respect.",
                'communicate': "We need to ______ more with each other.",
                'communication': "Good ______ is key to understanding.",
                'understand': "I ______ how you feel.",
                'misunderstand': "Don't ______ what I said.",
                'apologize': "You should ______ for being late.",
                'apology': "Please accept my sincere ______.",
                'trust': "______ is the foundation of friendship.",
                'respect': "We should ______ everyone's opinions.",
                'support': "Friends always ______ each other.",
                'encourage': "Teachers ______ students to do their best.",
                'deal with': "We need to ______ this problem carefully.",
                'problem': "Every ______ has a solution.",
                'solve': "Let's work together to ______ this puzzle.",
                'solution': "We need to find a ______ to this problem.",
                'challenge': "Learning a new language is a big ______.",
                'experience': "This was a valuable ______ for me.",
                'teenager': "Being a ______ can be challenging.",
                'wonder': "The Great Wall is one of the greatest ______ of the world.",
                'nature': "We should protect ______ and the environment.",
                'natural': "This is a ______ phenomenon.",
                'measurement': "The ______ of the room is important.",
                'measure': "Please ______ the length of the table.",
                'deep': "The ocean is very ______ in some places.",
                'depth': "The ______ of this lake is 50 meters.",
                'high': "Mount Qomolangma is very ______.",
                'height': "What is the ______ of this building?",
                'long': "The river is very ______.",
                'length': "The ______ of the bridge is 500 meters.",
                'wide': "This road is not ______ enough.",
                'width': "The ______ of the door is 80 centimeters.",
                'size': "What ______ do you need?",
                'area': "The ______ of this park is very large.",
                'population': "The ______ of China is over 1.4 billion.",
                'mountain': "Mount Qomolangma is the highest ______ in the world.",
                'desert': "The Sahara is the largest ______ in the world.",
                'ocean': "The ______ covers about 71% of the earth's surface.",
                'river': "The Yangtze is the longest ______ in China.",
                'lake': "We went boating on the ______.",
                'waterfall': "The ______ is beautiful after the rain.",
                'forest': "Many animals live in the ______.",
                'amazing': "The view from the top is ______.",
                'fantastic': "We had a ______ time at the party.",
                'spectacular': "The fireworks display was ______.",
                'explore': "Scientists ______ the deep ocean.",
                'exploration': "Space ______ has made great progress.",
                'discover': "Columbus ______ America in 1492.",
                'discovery': "The ______ of penicillin changed medicine.",
                'protect': "We must ______ endangered animals.",
                'protection': "Environmental ______ is everyone's responsibility.",
                'environment': "We should protect our ______.",
                'climate': "The ______ is changing due to global warming.",
                'temperature': "The ______ today is 25 degrees.",
                'level': "The water ______ is rising.",
                'surface': "About 71% of the earth's ______ is water.",
                'below': "The temperature fell ______ zero.",
                'above': "The plane flew ______ the clouds.",
                'earth': "The ______ is our only home."
            };
            return sentences[word] || `The word "${word}" fits in this sentence: ______.`;
        }

        // å•è¯å¡ç‰‡
        function renderCardGame(words, container, levelName) {
            const randomWord = getWeightedRandomWord(words);
            const isMastered = gameState.masteredWords.includes(randomWord.english);
            const showEnglishFirst = Math.random() < 0.5;
            
            let html = `<div class="unit-title">
                <span>${levelName} - ğŸ“– å•è¯å¡ç‰‡</span>
            </div>`;
            
            if (showEnglishFirst) {
                html += '<p style="text-align: center; color: #555; margin-bottom: 20px;">ç‚¹å‡»å¡ç‰‡æˆ–æŒ‰ç©ºæ ¼é”®ç¿»è½¬æŸ¥çœ‹éŸ³æ ‡å’Œä¸­æ–‡</p>';
                html += '<div class="word-card" onclick="flipCard(this)" onkeydown="handleCardFlipKeydown(event, this)" tabindex="0" role="button" aria-label="å•è¯å¡ç‰‡ï¼ŒæŒ‰ç©ºæ ¼é”®ç¿»è½¬" style="cursor: pointer;">';
                html += `<div class="card-front">`;
                html += `<div class="word-english">${randomWord.english}</div>`;
                if (isMastered) {
                    html += `<div style="color: #11998e; margin-top: 15px;">âœ“ å·²æŒæ¡</div>`;
                } else {
                    html += `<div style="color: #666; margin-top: 15px;">ğŸ‘† ç‚¹å‡»ç¿»è½¬</div>`;
                }
                html += `</div>`;
                html += `<div class="card-back" style="display: none;">`;
                html += `<div class="word-pronunciation">${randomWord.pronunciation}</div>`;
                html += `<div class="word-chinese" style="margin-top: 10px;">${randomWord.chinese}</div>`;
                html += `</div>`;
            } else {
                html += '<p style="text-align: center; color: #555; margin-bottom: 20px;">çœ‹ä¸­æ–‡è¯´å‡ºè‹±æ–‡ï¼Œç‚¹å‡»ğŸ¤è¯­éŸ³éªŒè¯æˆ–ç¿»è½¬æŸ¥çœ‹ç­”æ¡ˆ</p>';
                html += '<div class="word-card" onclick="flipCard(this)" onkeydown="handleCardFlipKeydown(event, this)" tabindex="0" role="button" aria-label="å•è¯å¡ç‰‡ï¼ŒæŒ‰ç©ºæ ¼é”®ç¿»è½¬" style="cursor: pointer;">';
                html += `<div class="card-front">`;
                html += `<div class="word-chinese">${randomWord.chinese}</div>`;
                if (isMastered) {
                    html += `<div style="color: #11998e; margin-top: 15px;">âœ“ å·²æŒæ¡</div>`;
                } else {
                    html += `<div style="color: #666; margin-top: 15px;">ğŸ‘† ç‚¹å‡»ç¿»è½¬</div>`;
                }
                html += `</div>`;
                html += `<div class="card-back" style="display: none;">`;
                html += `<div class="word-english">${randomWord.english}</div>`;
                html += `<div class="word-pronunciation" style="margin-top: 10px;">${randomWord.pronunciation}</div>`;
                html += `</div>`;
            }
            
            html += '</div>';
            html += '<div style="text-align: center; margin-top: 15px;">';
            html += `<button class="action-btn" onclick="speakWord('${randomWord.english}')" title="æœ—è¯»å•è¯" style="font-size: 1.1em;">ğŸ”Š æœ—è¯»</button>`;
            if (!showEnglishFirst) {
                html += `<button id="cardMicBtn" class="action-btn" onclick="startCardListening('${randomWord.english}')" title="è¯­éŸ³éªŒè¯" style="font-size: 1.1em; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">ğŸ¤ è¯­éŸ³éªŒè¯</button>`;
            }
            html += '</div>';
            html += '<div style="text-align: center; margin-top: 10px;">';
            html += '<button class="action-btn btn-primary" onclick="loadGameMode()">ä¸‹ä¸€ä¸ªå•è¯</button>';
            if (isMastered) {
                html += '<button class="action-btn btn-success" disabled style="opacity: 0.6;">âœ“ å·²æŒæ¡</button>';
            } else {
                html += '<button class="action-btn btn-success" onclick="markAsLearned()">âœ“ æ ‡è®°ä¸ºå·²æŒæ¡</button>';
            }
            html += '</div>';
            html += `<input type="hidden" id="currentWord" value="${randomWord.english}">`;
            html += `<input type="hidden" id="currentWordChinese" value="${randomWord.chinese}">`;

            container.innerHTML = html;
        }
        
        let cardRecognition = null;
        let isCardListening = false;
        let currentCardTargetWord = '';
        
        function startCardListening(targetWord) {
            currentCardTargetWord = targetWord.toLowerCase();
            
            if (!cardRecognition) {
                if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                    cardRecognition = new SpeechRecognition();
                    cardRecognition.lang = 'en-US';
                    cardRecognition.continuous = false;
                    cardRecognition.interimResults = false;
                    cardRecognition.maxAlternatives = 3;

                    cardRecognition.onstart = () => {
                        isCardListening = true;
                        updateCardMicButton(true);
                        showFeedback('ğŸ¤ è¯·è¯´å‡ºè‹±æ–‡å•è¯...', 'info');
                    };

                    cardRecognition.onend = () => {
                        isCardListening = false;
                        updateCardMicButton(false);
                    };

                    cardRecognition.onerror = (event) => {
                        isCardListening = false;
                        updateCardMicButton(false);
                        if (event.error === 'no-speech') {
                            showFeedback('ğŸ¤ æœªæ£€æµ‹åˆ°è¯­éŸ³ï¼Œè¯·é‡è¯•', 'wrong');
                        } else if (event.error === 'not-allowed') {
                            showFeedback('ğŸ¤ è¯·å…è®¸éº¦å…‹é£æƒé™', 'wrong');
                        }
                    };

                    cardRecognition.onresult = (event) => {
                        const results = event.results[0];
                        let spokenWord = '';
                        for (let i = 0; i < results.length; i++) {
                            spokenWord += results[i].transcript + ' ';
                        }
                        spokenWord = spokenWord.trim().toLowerCase();
                        checkCardSpokenWord(spokenWord, currentCardTargetWord);
                    };
                }
            }
            
            if (!cardRecognition) {
                showFeedback('ğŸ¤ æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³è¯†åˆ«', 'wrong');
                return;
            }

            if (isCardListening) {
                cardRecognition.stop();
                return;
            }

            try {
                cardRecognition.start();
            } catch (e) {
                console.log('è¯­éŸ³è¯†åˆ«å¯åŠ¨å¤±è´¥:', e);
            }
        }
        
        function checkCardSpokenWord(spokenWord, targetWord) {
            const spokenWords = spokenWord.split(' ');
            
            let matched = false;
            for (let word of spokenWords) {
                if (word === targetWord || 
                    word === targetWord + 's' || 
                    word === targetWord + 'es' ||
                    word === targetWord + 'ed' ||
                    word === targetWord + 'ing' ||
                    targetWord.indexOf(word) === 0) {
                    matched = true;
                    break;
                }
            }

            if (matched) {
                showFeedback(`âœ“ æ­£ç¡®ï¼ä½ è¯´äº† "${spokenWord}" +10åˆ†`, 'correct');
                speakWord(targetWord);
                updateScore(10);
                updateStreak(true);
                updateProgress();
            } else {
                showFeedback(`âœ— ä½ è¯´çš„æ˜¯ "${spokenWord}"ï¼Œæ­£ç¡®ç­”æ¡ˆæ˜¯ "${targetWord}"`, 'wrong');
                speakWord(targetWord);
                updateStreak(false);
            }
        }
        
        function updateCardMicButton(listening) {
            const micBtn = document.getElementById('cardMicBtn');
            if (micBtn) {
                if (listening) {
                    micBtn.innerHTML = 'ğŸ”´ å½•éŸ³ä¸­...';
                    micBtn.classList.add('recording');
                } else {
                    micBtn.innerHTML = 'ğŸ¤ è¯­éŸ³éªŒè¯';
                    micBtn.classList.remove('recording');
                }
            }
        }

        // å¤„ç†å¡ç‰‡ç¿»è½¬é”®ç›˜äº‹ä»¶
        function handleCardFlipKeydown(event, card) {
            if (event.key === 'Enter' || event.key === ' ') {
                event.preventDefault();
                flipCard(card);
            }
        }

        // ç¿»è½¬å¡ç‰‡
        function flipCard(card) {
            const front = card.querySelector('.card-front');
            const back = card.querySelector('.card-back');
            
            if (front.style.display !== 'none') {
                front.style.display = 'none';
                back.style.display = 'block';
            } else {
                front.style.display = 'block';
                back.style.display = 'none';
            }
        }

        // æ£€æŸ¥æ‹¼å†™
        function checkSpell() {
            const input = document.getElementById('spellInput');
            const correct = document.getElementById('correctAnswer').value;
            
            if (input.value.toLowerCase().trim() === correct.toLowerCase()) {
                input.classList.add('correct');
                input.classList.remove('wrong');
                gameState.spellCorrectCount++;
                showFeedback(`âœ“ æ­£ç¡®ï¼${correct} +15åˆ†`, 'correct');
                speakWord(correct);
                updateScore(15);
                updateStreak(true);
                saveProgress();
            } else {
                input.classList.add('wrong');
                input.classList.remove('correct');
                showFeedback(`âœ— é”™è¯¯ï¼æ­£ç¡®ç­”æ¡ˆæ˜¯ï¼š${correct}`, 'wrong');
                speakWord(correct);
                updateStreak(false);
            }

            updateProgress();
        }

        // æ£€æŸ¥å¡«ç©º
        function checkFill() {
            const input = document.getElementById('fillInput');
            const correct = document.getElementById('correctAnswer').value;
            
            if (input.value.toLowerCase().trim() === correct.toLowerCase()) {
                input.classList.add('correct');
                input.classList.remove('wrong');
                showFeedback(`âœ“ æ­£ç¡®ï¼+20åˆ†`, 'correct');
                updateScore(20);
                updateStreak(true);
            } else {
                input.classList.add('wrong');
                input.classList.remove('correct');
                showFeedback(`âœ— é”™è¯¯ï¼æ­£ç¡®ç­”æ¡ˆæ˜¯ï¼š${correct}`, 'wrong');
                updateStreak(false);
            }

            updateProgress();
        }

        // æ˜¾ç¤ºæç¤º
        function showHint() {
            const correct = document.getElementById('correctAnswer').value;
            const input = document.getElementById('spellInput');
            if (input && input.value === '') {
                input.value = correct.substring(0, 3);
                input.focus();
            }
        }

        // æ ‡è®°ä¸ºå·²æŒæ¡
        function markAsLearned() {
            const word = document.getElementById('currentWord').value;
            const chinese = document.getElementById('currentWordChinese').value;
            
            if (!gameState.masteredWords.includes(word)) {
                gameState.masteredWords.push(word);
                gameState.correctWords++;
                showFeedback(`âœ“ "${word}" å·²æ ‡è®°ä¸ºæŒæ¡ï¼`, 'correct');
            } else {
                showFeedback(`"${word}" å·²ç»æŒæ¡è¿‡äº†`, 'correct');
            }
            
            updateStats();
            checkAchievements();
            saveProgress();
        }

        // åˆ‡æ¢æ¨¡å¼
        function changeMode(mode) {
            gameState.currentMode = mode;
            document.querySelectorAll('.mode-btn').forEach(btn => {
                btn.classList.remove('active');
                btn.setAttribute('aria-pressed', 'false');
                if (btn.dataset.mode === mode) {
                    btn.classList.add('active');
                    btn.setAttribute('aria-pressed', 'true');
                }
            });
            loadGameMode();
        }

        // æ˜¾ç¤ºåé¦ˆ
        function showFeedback(message, type) {
            const feedback = document.getElementById('feedback');
            feedback.textContent = message;
            feedback.className = `feedback ${type}`;
            
            setTimeout(() => {
                feedback.className = 'feedback';
            }, 3000);
        }

        // æ›´æ–°åˆ†æ•°
        function updateScore(points) {
            gameState.score += points;
            updateStats();
            saveProgress();
        }

        // æ›´æ–°è¿å‡»
        function updateStreak(correct) {
            if (correct) {
                gameState.streak++;
                if (gameState.streak > gameState.maxStreak) {
                    gameState.maxStreak = gameState.streak;
                }
            } else {
                gameState.streak = 0;
            }
            updateStats();
            checkAchievements();
        }

        // æ›´æ–°è¿›åº¦
        function updateProgress() {
            const progress = Math.min(100, (gameState.score / 1000) * 100);
            const progressFill = document.getElementById('progressFill');
            const progressBar = progressFill.parentElement;
            progressFill.style.width = `${progress}%`;
            progressBar.setAttribute('aria-valuenow', Math.round(progress));
        }

        // æ›´æ–°ç»Ÿè®¡
        function updateStats() {
            document.getElementById('totalScore').textContent = gameState.score;
            document.getElementById('completedLevels').textContent = 
                `${gameState.completedLevels.length}/8`;
            document.getElementById('correctWords').textContent = gameState.correctWords;
            document.getElementById('streak').textContent = gameState.streak;
        }

        // æ£€æŸ¥æˆå°±
        function checkAchievements() {
            if (gameState.completedLevels.length >= 1 && !gameState.unlockedAchievements.includes(1)) {
                unlockAchievement(1);
            }
            if (gameState.maxStreak >= 20 && !gameState.unlockedAchievements.includes(2)) {
                unlockAchievement(2);
            }
            if (gameState.spellCorrectCount >= 10 && !gameState.unlockedAchievements.includes(3)) {
                unlockAchievement(3);
            }
            if (gameState.completedLevels.length >= 8 && !gameState.unlockedAchievements.includes(4)) {
                unlockAchievement(4);
            }
            if (gameState.correctWords >= 100 && !gameState.unlockedAchievements.includes(5)) {
                unlockAchievement(5);
            }
        }

        // è§£é”æˆå°±
        function unlockAchievement(id) {
            gameState.unlockedAchievements.push(id);
            const achievement = achievements.find(a => a.id === id);
            showFeedback(`ğŸ… è§£é”æˆå°±ï¼š${achievement.name}ï¼`, 'correct');
            renderAchievements();
            saveProgress();
        }

        // æ¨¡å¼åˆ‡æ¢
        document.querySelectorAll('.mode-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.mode-btn').forEach(b => {
                    b.classList.remove('active');
                    b.setAttribute('aria-pressed', 'false');
                });
                btn.classList.add('active');
                btn.setAttribute('aria-pressed', 'true');
                gameState.currentMode = btn.dataset.mode;
                loadGameMode();
            });
        });

        // åˆå§‹åŒ–
        initGame();
    </script>
</body>
</html>