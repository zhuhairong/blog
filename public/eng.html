<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ëã±ËØ≠ÂçïËØçÂ§ßÂÜíÈô© - ‰∫∫ÊïôÁâàÂÖ´Âπ¥Á∫ß‰∏ãÂÜå(2024Áâà)</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .stats-bar {
            background: white;
            border-radius: 15px;
            padding: 15px 30px;
            display: flex;
            justify-content: space-around;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            flex-wrap: wrap;
            gap: 15px;
        }

        .stat-item {
            text-align: center;
            min-width: 100px;
        }

        .stat-value {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
        }

        .stat-label {
            color: #666;
            font-size: 0.9em;
        }

        .game-section {
            background: white;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .section-title {
            font-size: 1.8em;
            color: #333;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .level-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .level-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
            border: none;
            font-size: 1em;
        }

        .level-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
        }

        .level-card.locked {
            background: #ccc;
            cursor: not-allowed;
            opacity: 0.6;
        }

        .level-card.completed {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
        }

        .level-card.current {
            box-shadow: 0 0 0 4px #ffd700;
        }

        .level-icon {
            font-size: 3em;
            margin-bottom: 10px;
        }

        .level-name {
            font-size: 1.3em;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .level-sections {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 10px;
        }

        .section-badge {
            background: rgba(255,255,255,0.2);
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.85em;
        }

        .level-wordcount {
            background: rgba(255,255,255,0.2);
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9em;
            margin-top: 10px;
            display: inline-block;
        }

        .mode-buttons {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-bottom: 30px;
        }

        .mode-btn {
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s;
            background: #667eea;
            color: white;
        }

        .mode-btn:hover {
            background: #5568d3;
            transform: scale(1.05);
        }

        .mode-btn.active {
            background: #11998e;
            box-shadow: 0 5px 15px rgba(17, 153, 142, 0.4);
        }

        .game-area {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 30px;
            min-height: 400px;
        }

        .unit-title {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }

        .word-card {
            background: white;
            border-radius: 15px;
            padding: 40px;
            text-align: center;
            margin: 20px 0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .word-english {
            font-size: 3em;
            color: #667eea;
            margin-bottom: 10px;
        }

        .word-chinese {
            font-size: 1.5em;
            color: #666;
        }

        .word-pronunciation {
            color: #999;
            font-style: italic;
            margin-top: 10px;
            font-size: 1.2em;
        }

        .input-area {
            margin: 20px 0;
        }

        .input-area input {
            width: 100%;
            max-width: 400px;
            padding: 15px 20px;
            font-size: 1.2em;
            border: 2px solid #ddd;
            border-radius: 10px;
            outline: none;
            transition: border-color 0.3s;
        }

        .input-area input:focus {
            border-color: #667eea;
        }

        .input-area input.correct {
            border-color: #11998e;
            background: #e8f5e9;
        }

        .input-area input.wrong {
            border-color: #e74c3c;
            background: #ffebee;
        }

        .action-btn {
            padding: 15px 40px;
            font-size: 1.2em;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            margin: 10px;
            transition: all 0.3s;
        }

        .btn-primary {
            background: #667eea;
            color: white;
        }

        .btn-primary:hover {
            background: #5568d3;
        }

        .btn-success {
            background: #11998e;
            color: white;
        }

        .btn-success:hover {
            background: #0d7d74;
        }

        .btn-danger {
            background: #e74c3c;
            color: white;
        }

        .btn-danger:hover {
            background: #c0392b;
        }

        .match-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .match-card {
            background: white;
            padding: 20px 15px;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            border: 3px solid #ddd;
            transition: all 0.3s;
            font-size: 1em;
            user-select: none;
            min-height: 70px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .match-card:hover {
            border-color: #667eea;
            transform: scale(1.02);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .match-card.selected {
            border-color: #667eea;
            background: linear-gradient(135deg, #e8eaf6 0%, #c5cae9 100%);
            transform: scale(1.05);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.5);
        }

        .match-card.matched {
            border-color: #11998e;
            background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
            opacity: 0.6;
            pointer-events: none;
            cursor: default;
        }

        .match-card.wrong {
            border-color: #e74c3c;
            background: #ffebee;
            animation: shake 0.5s;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .action-btn.recording {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%) !important;
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .feedback {
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
            font-size: 1.2em;
            display: none;
            font-weight: bold;
        }

        .feedback.correct {
            background: #e8f5e9;
            color: #0d7d74;
            display: block;
            border: 2px solid #11998e;
        }

        .feedback.wrong {
            background: #ffebee;
            color: #c0392b;
            display: block;
            border: 2px solid #e74c3c;
        }

        .skip-link {
            position: absolute;
            top: -40px;
            left: 0;
            background: #667eea;
            color: white;
            padding: 8px 16px;
            border-radius: 0 0 10px 0;
            z-index: 100;
            transition: top 0.3s;
        }

        .skip-link:focus {
            top: 0;
        }

        .action-btn:focus,
        .mode-btn:focus,
        .level-card:focus,
        .match-card:focus {
            outline: 3px solid #ffd700;
            outline-offset: 2px;
        }

        input:focus-visible {
            outline: 3px solid #667eea;
            outline-offset: 2px;
        }

        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            margin: 20px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            width: 0%;
            transition: width 0.5s;
        }

        .timer {
            font-size: 2em;
            text-align: center;
            color: #e74c3c;
            margin: 20px 0;
            font-weight: bold;
        }

        .achievements {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .achievement {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            border: 2px solid #ddd;
        }

        .achievement.unlocked {
            border-color: #ffd700;
            background: linear-gradient(135deg, #fff9e6 0%, #fff 100%);
        }

        .achievement-icon {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .match-info {
            text-align: center;
            margin-bottom: 15px;
            font-size: 1.1em;
            color: #666;
        }

        .match-info span {
            color: #667eea;
            font-weight: bold;
        }

        .card-front, .card-back {
            transition: all 0.3s;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8em;
            }
            
            .stats-bar {
                flex-direction: column;
                gap: 15px;
            }
            
            .match-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .mode-buttons {
                flex-direction: column;
            }
            
            .unit-title {
                flex-direction: column;
                gap: 10px;
                text-align: center;
            }
            
            .level-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <a href="#main-content" class="skip-link">Ë∑≥ËΩ¨Âà∞‰∏ªË¶ÅÂÜÖÂÆπ</a>
    <div class="container">
        <header class="header">
            <h1>üéÆ Ëã±ËØ≠ÂçïËØçÂ§ßÂÜíÈô©</h1>
            <p>‰∫∫ÊïôÁâàÂÖ´Âπ¥Á∫ß‰∏ãÂÜåÔºà2024Êñ∞ÁâàÔºâ| 8ÂçïÂÖÉÂÆåÊï¥ËØçÂ∫ì</p>
        </header>

        <nav class="stats-bar" aria-label="Â≠¶‰π†ÁªüËÆ°">
            <div class="stat-item">
                <div class="stat-value" id="totalScore" aria-live="polite">0</div>
                <div class="stat-label">ÊÄªÁßØÂàÜ</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="completedLevels" aria-live="polite">0/4</div>
                <div class="stat-label">ÂÆåÊàêÂçïÂÖÉ</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="correctWords" aria-live="polite">0</div>
                <div class="stat-label">ÊéåÊè°ÂçïËØç</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="streak" aria-live="polite">0</div>
                <div class="stat-label">ËøûÁª≠Ê≠£Á°Æ</div>
            </div>
        </nav>

        <section class="game-section" aria-labelledby="level-title">
            <h2 class="section-title" id="level-title">üìö ÈÄâÊã©ÂçïÂÖÉÂÖ≥Âç°</h2>
            <div class="level-grid" id="levelGrid" role="list" aria-label="ÂçïÂÖÉÂÖ≥Âç°ÂàóË°®">
                <!-- ÂÖ≥Âç°Âç°ÁâáÁî±JSÁîüÊàê -->
            </div>
        </section>

        <section class="game-section" id="main-content" aria-labelledby="game-title" tabindex="-1">
            <h2 class="section-title" id="game-title">üéØ Ê∏∏ÊàèÊ®°Âºè</h2>
            <nav class="mode-buttons" aria-label="Ê∏∏ÊàèÊ®°ÂºèÈÄâÊã©">
                <button class="mode-btn active" data-mode="card" aria-pressed="true">ÔøΩ ÂçïËØçÂç°Áâá</button>
                <button class="mode-btn" data-mode="match" aria-pressed="false">üîó ÂçïËØçÈÖçÂØπ</button>
                <button class="mode-btn" data-mode="spell" aria-pressed="false">‚úçÔ∏è ÊãºÂÜôÊåëÊàò</button>
                <button class="mode-btn" data-mode="fill" aria-pressed="false">ÔøΩ ÊÉÖÊôØÂ°´Á©∫</button>
            </nav>

            <div class="game-area" id="gameArea" role="region" aria-live="polite" aria-label="Ê∏∏ÊàèÂÜÖÂÆπÂå∫Âüü">
                <!-- Ê∏∏ÊàèÂÜÖÂÆπÂå∫Âüü -->
            </div>

            <div class="feedback" id="feedback" role="alert" aria-live="assertive"></div>

            <div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" aria-label="Â≠¶‰π†ËøõÂ∫¶">
                <div class="progress-fill" id="progressFill"></div>
            </div>
        </section>

        <section class="game-section" aria-labelledby="achievement-title">
            <h2 class="section-title" id="achievement-title">üèÖ ÊàêÂ∞±Á≥ªÁªü</h2>
            <div class="achievements" id="achievements" role="list" aria-label="ÊàêÂ∞±ÂàóË°®">
                <!-- ÊàêÂ∞±Áî±JSÁîüÊàê -->
            </div>
        </section>
    </div>

    <script>
        // ============================================
        // ‰∫∫ÊïôÁâàÂÖ´Âπ¥Á∫ß‰∏ãÂÜåÔºà2024Êñ∞ÁâàÔºâÂÆåÊï¥ÂçïËØçË°®
        // ÂÖ±8‰∏™ÂçïÂÖÉ
        // ============================================
        const wordData = {
            unit1: [
                { english: 'relax', chinese: 'ÊîæÊùæÔºõ‰ºëÊÅØ', pronunciation: '/r…™Ààl√¶ks/' },
                { english: 'relaxed', chinese: 'ÊîæÊùæÁöÑÔºõËá™Âú®ÁöÑ', pronunciation: '/r…™Ààl√¶kst/' },
                { english: 'relaxing', chinese: '‰ª§‰∫∫ÊîæÊùæÁöÑ', pronunciation: '/r…™Ààl√¶ks…™≈ã/' },
                { english: 'stress', chinese: 'ÂéãÂäõÔºõÁ¥ßÂº†', pronunciation: '/stres/' },
                { english: 'tired', chinese: 'Áñ≤ÂÄ¶ÁöÑÔºõÁ¥ØÁöÑ', pronunciation: '/Ààta…™…ôrd/' },
                { english: 'balanced', chinese: 'Âπ≥Ë°°ÁöÑÔºõÂùáË°°ÁöÑ', pronunciation: '/Ààb√¶l…ônst/' },
                { english: 'calligraphy', chinese: '‰π¶Ê≥ï', pronunciation: '/k…ôÀàl…™…°r…ôfi/' },
                { english: 'ski', chinese: 'ÊªëÈõ™', pronunciation: '/skiÀê/' },
                { english: 'program', chinese: 'Á®ãÂ∫èÔºõËäÇÁõÆ', pronunciation: '/Ààpro ä…°r√¶m/' },
                { english: 'instructor', chinese: 'ÊïôÁªÉÔºõÊåáÂØºËÄÖ', pronunciation: '/…™nÀàstr åkt…ôr/' },
                { english: 'fear', chinese: 'ÂÆ≥ÊÄïÔºõÊÅêÊÉß', pronunciation: '/f…™r/' },
                { english: 'poem', chinese: 'ËØó', pronunciation: '/Ààpo ä…ôm/' },
                { english: 'stroke', chinese: 'Á¨îÁîªÔºõÂáªÁêÉ', pronunciation: '/stro äk/' },
                { english: 'ink', chinese: 'Â¢®Ê∞¥', pronunciation: '/…™≈ãk/' },
                { english: 'flute', chinese: 'ÈïøÁ¨õ', pronunciation: '/fluÀêt/' },
                { english: 'hiking', chinese: 'ÂæíÊ≠•ÊóÖË°å', pronunciation: '/Ààha…™k…™≈ã/' },
                { english: 'painting', chinese: 'ÁªòÁîª', pronunciation: '/Ààpe…™nt…™≈ã/' },
                { english: 'programming', chinese: 'ÁºñÁ®ã', pronunciation: '/Ààpro ä…°r√¶m…™≈ã/' },
                { english: 'activity', chinese: 'Ê¥ªÂä®', pronunciation: '/√¶kÀàt…™v…ôti/' },
                { english: 'free-time', chinese: 'Á©∫Èó≤Êó∂Èó¥', pronunciation: '/friÀê ta…™m/' },
                { english: 'hobby', chinese: 'Áà±Â•Ω', pronunciation: '/Ààh…ëÀêbi/' },
                { english: 'collect', chinese: 'Êî∂ÈõÜ', pronunciation: '/k…ôÀàlekt/' },
                { english: 'stamp', chinese: 'ÈÇÆÁ•®', pronunciation: '/st√¶mp/' },
                { english: 'coin', chinese: 'Á°¨Â∏Å', pronunciation: '/k…î…™n/' },
                { english: 'interest', chinese: 'ÂÖ¥Ë∂£', pronunciation: '/Àà…™ntr…ôst/' },
                { english: 'skill', chinese: 'ÊäÄËÉΩÔºõÊäÄÂ∑ß', pronunciation: '/sk…™l/' },
                { english: 'improve', chinese: 'ÊîπÂñÑÔºõÊèêÈ´ò', pronunciation: '/…™mÀàpruÀêv/' },
                { english: 'confidence', chinese: '‰ø°ÂøÉ', pronunciation: '/Ààk…ëÀênf…™d…ôns/' },
                { english: 'creative', chinese: 'ÊúâÂàõÈÄ†ÂäõÁöÑ', pronunciation: '/kriÀàe…™t…™v/' },
                { english: 'enjoyable', chinese: '‰ª§‰∫∫ÊÑâÂø´ÁöÑ', pronunciation: '/…™nÀàd í…î…™…ôbl/' }
            ],
            unit2: [
                { english: 'healthy', chinese: 'ÂÅ•Â∫∑ÁöÑ', pronunciation: '/ÀàhelŒ∏i/' },
                { english: 'health', chinese: 'ÂÅ•Â∫∑', pronunciation: '/helŒ∏/' },
                { english: 'diet', chinese: 'È•ÆÈ£ü', pronunciation: '/Ààda…™…ôt/' },
                { english: 'exercise', chinese: 'ÈîªÁÇºÔºõËøêÂä®', pronunciation: '/Ààeks…ôrsa…™z/' },
                { english: 'sleep', chinese: 'Áù°Áú†', pronunciation: '/sliÀêp/' },
                { english: 'energy', chinese: 'ËÉΩÈáèÔºõÁ≤æÂäõ', pronunciation: '/Ààen…ôrd íi/' },
                { english: 'sore', chinese: 'ÁñºÁóõÁöÑ', pronunciation: '/s…îÀêr/' },
                { english: 'throat', chinese: 'ÂñâÂíô', pronunciation: '/Œ∏ro ät/' },
                { english: 'stomachache', chinese: 'ËÉÉÁóõ', pronunciation: '/Ààst åm…ôke…™k/' },
                { english: 'fever', chinese: 'ÂèëÁÉß', pronunciation: '/ÀàfiÀêv…ôr/' },
                { english: 'cough', chinese: 'Âí≥ÂóΩ', pronunciation: '/k…îÀêf/' },
                { english: 'toothache', chinese: 'ÁâôÁóõ', pronunciation: '/ÀàtuÀêŒ∏e…™k/' },
                { english: 'headache', chinese: 'Â§¥Áóõ', pronunciation: '/Ààhede…™k/' },
                { english: 'test', chinese: 'Ê£ÄÊµãÔºõÊµãËØï', pronunciation: '/test/' },
                { english: 'flu', chinese: 'ÊµÅÊÑü', pronunciation: '/fluÀê/' },
                { english: 'medicine', chinese: 'ËçØ', pronunciation: '/Ààmedsn/' },
                { english: 'mask', chinese: 'Âè£ÁΩ©', pronunciation: '/m√¶sk/' },
                { english: 'virus', chinese: 'ÁóÖÊØí', pronunciation: '/Ààva…™r…ôs/' },
                { english: 'patient', chinese: 'ÁóÖ‰∫∫', pronunciation: '/Ààpe…™ Ént/' },
                { english: 'injury', chinese: '‰º§ÂÆ≥ÔºõÂèó‰º§', pronunciation: '/Àà…™nd í…ôri/' },
                { english: 'illness', chinese: 'ÁñæÁóÖ', pronunciation: '/Àà…™ln…ôs/' },
                { english: 'pain', chinese: 'ÁñºÁóõ', pronunciation: '/pe…™n/' },
                { english: 'safety', chinese: 'ÂÆâÂÖ®', pronunciation: '/Ààse…™fti/' },
                { english: 'fry', chinese: 'Ê≤πÁÇ∏', pronunciation: '/fra…™/' },
                { english: 'stove', chinese: 'ÁÇâÂ≠ê', pronunciation: '/sto äv/' },
                { english: 'flame', chinese: 'ÁÅ´ÁÑ∞', pronunciation: '/fle…™m/' },
                { english: 'panic', chinese: 'ÊÅêÊÖå', pronunciation: '/Ààp√¶n…™k/' },
                { english: 'roll', chinese: 'ÁøªÊªöÔºõÊªöÂä®', pronunciation: '/ro äl/' },
                { english: 'aid', chinese: 'Â∏ÆÂä©ÔºõÊè¥Âä©', pronunciation: '/e…™d/' },
                { english: 'extinguisher', chinese: 'ÁÅ≠ÁÅ´Âô®', pronunciation: '/…™kÀàst…™≈ã…°w…™ É…ôr/' },
                { english: 'smoke', chinese: 'ÁÉüÔºõÂê∏ÁÉü', pronunciation: '/smo äk/' },
                { english: 'balanced diet', chinese: 'ÂùáË°°È•ÆÈ£ü', pronunciation: '/Ààb√¶l…ônst da…™…ôt/' },
                { english: 'stay up', chinese: 'ÁÜ¨Â§ú', pronunciation: '/ste…™  åp/' },
                { english: 'physical', chinese: 'Ë∫´‰ΩìÁöÑ', pronunciation: '/Ààf…™z…™kl/' },
                { english: 'mental', chinese: 'Á≤æÁ•ûÁöÑÔºõÂøÉÁêÜÁöÑ', pronunciation: '/Ààmentl/' }
            ],
            unit3: [
                { english: 'grow', chinese: 'ÊàêÈïøÔºõÁîüÈïø', pronunciation: '/…°ro ä/' },
                { english: 'growth', chinese: 'ÊàêÈïøÔºõÂ¢ûÈïø', pronunciation: '/…°ro äŒ∏/' },
                { english: 'emotion', chinese: 'ÊÉÖÊÑüÔºõÊÉÖÁª™', pronunciation: '/…™Ààmo ä Én/' },
                { english: 'emotional', chinese: 'ÊÉÖÁª™ÁöÑÔºõÊÉÖÊÑüÁöÑ', pronunciation: '/…™Ààmo ä É…ônl/' },
                { english: 'upset', chinese: 'ÈöæËøáÁöÑÔºõÊ≤Æ‰∏ßÁöÑ', pronunciation: '/ åpÀàset/' },
                { english: 'lonely', chinese: 'Â≠§Áã¨ÁöÑÔºõÂØÇÂØûÁöÑ', pronunciation: '/Ààlo änli/' },
                { english: 'shocked', chinese: 'ÈúáÊÉäÁöÑ', pronunciation: '/ É…ëÀêkt/' },
                { english: 'alone', chinese: 'Áã¨Ëá™ÔºõÂçïÁã¨', pronunciation: '/…ôÀàlo än/' },
                { english: 'control', chinese: 'ÊéßÂà∂', pronunciation: '/k…ônÀàtro äl/' },
                { english: 'anger', chinese: 'ÊÄíÁÅ´ÔºõÊÑ§ÊÄí', pronunciation: '/Àà√¶≈ã…°…ôr/' },
                { english: 'angry', chinese: 'ÁîüÊ∞îÁöÑ', pronunciation: '/Àà√¶≈ã…°ri/' },
                { english: 'advise', chinese: 'Âª∫ËÆÆÔºõÂäùÂëä', pronunciation: '/…ôdÀàva…™z/' },
                { english: 'advice', chinese: 'Âª∫ËÆÆ', pronunciation: '/…ôdÀàva…™s/' },
                { english: 'hurtful', chinese: '‰º§ÊÑüÊÉÖÁöÑ', pronunciation: '/Ààh…úÀêrtfl/' },
                { english: 'forgive', chinese: 'ÂéüË∞ÖÔºõÂÆΩÊÅï', pronunciation: '/f…ôrÀà…°…™v/' },
                { english: 'friendship', chinese: 'ÂèãË∞ä', pronunciation: '/Ààfrend É…™p/' },
                { english: 'relationship', chinese: 'ÂÖ≥Á≥ª', pronunciation: '/r…™Ààle…™ Én É…™p/' },
                { english: 'communicate', chinese: '‰∫§ÊµÅÔºõÊ≤üÈÄö', pronunciation: '/k…ôÀàmjuÀên…™ke…™t/' },
                { english: 'communication', chinese: '‰∫§ÊµÅÔºõÊ≤üÈÄö', pronunciation: '/k…ôÀåmjuÀên…™Ààke…™ Én/' },
                { english: 'understand', chinese: 'ÁêÜËß£', pronunciation: '/Àå ånd…ôrÀàst√¶nd/' },
                { english: 'misunderstand', chinese: 'ËØØËß£', pronunciation: '/Àåm…™s ånd…ôrÀàst√¶nd/' },
                { english: 'apologize', chinese: 'ÈÅìÊ≠â', pronunciation: '/…ôÀàp…ëÀêl…ôd ía…™z/' },
                { english: 'apology', chinese: 'ÈÅìÊ≠â', pronunciation: '/…ôÀàp…ëÀêl…ôd íi/' },
                { english: 'trust', chinese: '‰ø°‰ªª', pronunciation: '/tr åst/' },
                { english: 'respect', chinese: 'Â∞äÈáç', pronunciation: '/r…™Ààspekt/' },
                { english: 'support', chinese: 'ÊîØÊåÅ', pronunciation: '/s…ôÀàp…îÀêrt/' },
                { english: 'encourage', chinese: 'ÈºìÂä±', pronunciation: '/…™nÀàk…úÀêr…™d í/' },
                { english: 'confidence', chinese: '‰ø°ÂøÉ', pronunciation: '/Ààk…ëÀênf…™d…ôns/' },
                { english: 'deal with', chinese: 'Â§ÑÁêÜÔºõÂØπ‰ªò', pronunciation: '/diÀêl w…™√∞/' },
                { english: 'problem', chinese: 'ÈóÆÈ¢ò', pronunciation: '/Ààpr…ëÀêbl…ôm/' },
                { english: 'solve', chinese: 'Ëß£ÂÜ≥', pronunciation: '/s…ëÀêlv/' },
                { english: 'solution', chinese: 'Ëß£ÂÜ≥ÊñπÊ°à', pronunciation: '/s…ôÀàluÀê Én/' },
                { english: 'challenge', chinese: 'ÊåëÊàò', pronunciation: '/Ààt É√¶l…™nd í/' },
                { english: 'experience', chinese: 'ÁªèÂéÜÔºõÁªèÈ™å', pronunciation: '/…™kÀàsp…™ri…ôns/' },
                { english: 'teenager', chinese: 'ÈùíÂ∞ëÂπ¥', pronunciation: '/ÀàtiÀêne…™d í…ôr/' }
            ],
            unit4: [
                { english: 'wonder', chinese: 'Â•áËßÇÔºõÂ•áËøπÔºõÊÉ≥Áü•ÈÅì', pronunciation: '/Ààw ånd…ôr/' },
                { english: 'nature', chinese: 'Ëá™ÁÑ∂', pronunciation: '/Ààne…™t É…ôr/' },
                { english: 'natural', chinese: 'Ëá™ÁÑ∂ÁöÑ', pronunciation: '/Ààn√¶t Ér…ôl/' },
                { english: 'measurement', chinese: 'ÊµãÈáèÔºõÂ∞∫ÂØ∏', pronunciation: '/Ààme í…ôrm…ônt/' },
                { english: 'measure', chinese: 'ÊµãÈáè', pronunciation: '/Ààme í…ôr/' },
                { english: 'deep', chinese: 'Ê∑±ÁöÑ', pronunciation: '/diÀêp/' },
                { english: 'depth', chinese: 'Ê∑±Â∫¶', pronunciation: '/depŒ∏/' },
                { english: 'high', chinese: 'È´òÁöÑ', pronunciation: '/ha…™/' },
                { english: 'height', chinese: 'È´òÂ∫¶', pronunciation: '/ha…™t/' },
                { english: 'long', chinese: 'ÈïøÁöÑ', pronunciation: '/l…îÀê≈ã/' },
                { english: 'length', chinese: 'ÈïøÂ∫¶', pronunciation: '/le≈ãŒ∏/' },
                { english: 'wide', chinese: 'ÂÆΩÁöÑ', pronunciation: '/wa…™d/' },
                { english: 'width', chinese: 'ÂÆΩÂ∫¶', pronunciation: '/w…™dŒ∏/' },
                { english: 'size', chinese: 'Â§ßÂ∞èÔºõÂ∞∫ÂØ∏', pronunciation: '/sa…™z/' },
                { english: 'area', chinese: 'Èù¢ÁßØÔºõÂú∞Âå∫', pronunciation: '/Ààeri…ô/' },
                { english: 'population', chinese: '‰∫∫Âè£', pronunciation: '/Àåp…ëÀêpjuÀàle…™ Én/' },
                { english: 'mountain', chinese: 'Â±±', pronunciation: '/Ààma äntn/' },
                { english: 'desert', chinese: 'Ê≤ôÊº†', pronunciation: '/Ààdez…ôrt/' },
                { english: 'ocean', chinese: 'Êµ∑Ê¥ã', pronunciation: '/Àào ä Én/' },
                { english: 'river', chinese: 'Ê≤≥ÊµÅ', pronunciation: '/Ààr…™v…ôr/' },
                { english: 'lake', chinese: 'ÊπñÊ≥ä', pronunciation: '/le…™k/' },
                { english: 'waterfall', chinese: 'ÁÄëÂ∏É', pronunciation: '/Ààw…îÀêt…ôrf…îÀêl/' },
                { english: 'forest', chinese: 'Ê£ÆÊûó', pronunciation: '/Ààf…îÀêr…™st/' },
                { english: 'amazing', chinese: '‰ª§‰∫∫ÊÉäÂ•áÁöÑ', pronunciation: '/…ôÀàme…™z…™≈ã/' },
                { english: 'fantastic', chinese: 'ÊûÅÂ•ΩÁöÑ', pronunciation: '/f√¶nÀàt√¶st…™k/' },
                { english: 'spectacular', chinese: 'Â£ÆËßÇÁöÑ', pronunciation: '/spekÀàt√¶kj…ôl…ôr/' },
                { english: 'explore', chinese: 'Êé¢Á¥¢', pronunciation: '/…™kÀàspl…îÀêr/' },
                { english: 'exploration', chinese: 'Êé¢Á¥¢', pronunciation: '/Àåekspl…ôÀàre…™ Én/' },
                { english: 'discover', chinese: 'ÂèëÁé∞', pronunciation: '/d…™Ààsk åv…ôr/' },
                { english: 'discovery', chinese: 'ÂèëÁé∞', pronunciation: '/d…™Ààsk åv…ôri/' },
                { english: 'protect', chinese: '‰øùÊä§', pronunciation: '/pr…ôÀàtekt/' },
                { english: 'protection', chinese: '‰øùÊä§', pronunciation: '/pr…ôÀàtek Én/' },
                { english: 'environment', chinese: 'ÁéØÂ¢É', pronunciation: '/…™nÀàva…™r…ônm…ônt/' },
                { english: 'climate', chinese: 'Ê∞îÂÄô', pronunciation: '/Ààkla…™m…ôt/' },
                { english: 'temperature', chinese: 'Ê∏©Â∫¶', pronunciation: '/Ààtempr…ôt É…ôr/' },
                { english: 'level', chinese: 'Ê∞¥Âπ≥ÔºõÁ∫ßÂà´', pronunciation: '/Ààlevl/' },
                { english: 'surface', chinese: 'Ë°®Èù¢', pronunciation: '/Ààs…úÀêrf…™s/' },
                { english: 'below', chinese: 'Âú®‚Ä¶‰∏ãÈù¢', pronunciation: '/b…™Ààlo ä/' },
                { english: 'above', chinese: 'Âú®‚Ä¶‰∏äÈù¢', pronunciation: '/…ôÀàb åv/' },
                { english: 'earth', chinese: 'Âú∞ÁêÉ', pronunciation: '/…úÀêrŒ∏/' }
            ],
            unit5: [
                { english: 'temper', chinese: 'ËÑæÊ∞îÔºõÊÄíÊ∞î', pronunciation: '/Ààtemp…ôr/' },
                { english: 'earthquake', chinese: 'Âú∞Èúá', pronunciation: '/Àà…úÀêrŒ∏kwe…™k/' },
                { english: 'typhoon', chinese: 'Âè∞È£é', pronunciation: '/ta…™ÀàfuÀên/' },
                { english: 'wildfire', chinese: 'ÈáéÁÅ´', pronunciation: '/Ààwa…™ldfa…™…ôr/' },
                { english: 'snowstorm', chinese: 'Êö¥È£éÈõ™', pronunciation: '/Ààsno äst…îÀêrm/' },
                { english: 'flood', chinese: 'Ê¥™Ê∞¥ÔºõÊ∞¥ÁÅæ', pronunciation: '/fl åd/' },
                { english: 'drought', chinese: 'Êó±ÁÅæ', pronunciation: '/dra ät/' },
                { english: 'warn', chinese: 'Ë≠¶Âëä', pronunciation: '/w…îÀêrn/' },
                { english: 'wave', chinese: 'Ê≥¢Êµ™ÔºõÊå•Êâã', pronunciation: '/we…™v/' },
                { english: 'tsunami', chinese: 'Êµ∑Âï∏', pronunciation: '/tsuÀêÀàn…ëÀêmi/' },
                { english: 'interview', chinese: 'ÈááËÆøÔºõÈù¢ËØï', pronunciation: '/Àà…™nt…ôrvjuÀê/' },
                { english: 'possibly', chinese: 'ÂèØËÉΩÔºõÊàñËÆ∏', pronunciation: '/Ààp…ëÀês…ôbli/' },
                { english: 'report', chinese: 'Êä•ÂëäÔºõÊä•ÈÅì', pronunciation: '/r…™Ààp…îÀêrt/' },
                { english: 'neighbourhood', chinese: 'Ë°óÂå∫ÔºõÁ§æÂå∫', pronunciation: '/Ààne…™b…ôrh äd/' },
                { english: 'roof', chinese: 'Â±ãÈ°∂', pronunciation: '/ruÀêf/' },
                { english: 'nearly', chinese: 'Âá†‰πéÔºõÂ∑Æ‰∏çÂ§ö', pronunciation: '/Ààn…™rli/' },
                { english: 'trouble', chinese: 'È∫ªÁÉ¶ÔºõÂõ∞Èöæ', pronunciation: '/Ààtr åbl/' },
                { english: 'relative', chinese: '‰∫≤Êàö', pronunciation: '/Ààrel…ôt…™v/' },
                { english: 'truck', chinese: 'Âç°ËΩ¶', pronunciation: '/tr åk/' },
                { english: 'supply', chinese: '‰æõÂ∫îÔºõË°•Áªô', pronunciation: '/s…ôÀàpla…™/' },
                { english: 'preparation', chinese: 'ÂáÜÂ§á', pronunciation: '/Àåprep…ôÀàre…™ Én/' },
                { english: 'power', chinese: 'ÁîµÂäõÔºõÂäõÈáè', pronunciation: '/Ààpa ä…ôr/' },
                { english: 'thick', chinese: 'ÂéöÁöÑÔºõÊµìÂØÜÁöÑ', pronunciation: '/Œ∏…™k/' },
                { english: 'beat', chinese: 'Êï≤ÊâìÔºõË∑≥Âä®', pronunciation: '/biÀêt/' },
                { english: 'hide', chinese: 'Ë∫≤Ëóè', pronunciation: '/ha…™d/' },
                { english: 'tornado', chinese: 'ÈæôÂç∑È£é', pronunciation: '/t…îÀêrÀàne…™do ä/' },
                { english: 'worst', chinese: 'ÊúÄÂùèÁöÑ', pronunciation: '/w…úÀêrst/' },
                { english: 'refuse', chinese: 'ÊãíÁªù', pronunciation: '/r…™ÀàfjuÀêz/' },
                { english: 'security', chinese: 'ÂÆâÂÖ®Ôºõ‰øùÂÆâ', pronunciation: '/s…™Ààkj är…ôti/' },
                { english: 'guard', chinese: 'Âç´ÂÖµÔºõ‰øùÂç´', pronunciation: '/…°…ëÀêrd/' },
                { english: 'nearby', chinese: 'ÈôÑËøëÁöÑ', pronunciation: '/Ààn…™rba…™/' },
                { english: 'scream', chinese: 'Â∞ñÂè´', pronunciation: '/skriÀêm/' },
                { english: 'thankfully', chinese: 'Âπ∏‰∫èÔºõÊÑüÊøÄÂú∞', pronunciation: '/ÀàŒ∏√¶≈ãkf…ôli/' },
                { english: 'knowledge', chinese: 'Áü•ËØÜ', pronunciation: '/Ààn…ëÀêl…™d í/' },
                { english: 'except for', chinese: 'Èô§‚Ä¶‰πãÂ§ñ', pronunciation: '/…™kÀàsept f…îÀêr/' },
                { english: 'hero', chinese: 'Ëã±ÈõÑ', pronunciation: '/Ààh…™…ôro ä/' },
                { english: 'landslide', chinese: 'ÊªëÂù°ÔºõÂ°åÊñπ', pronunciation: '/Ààl√¶ndsla…™d/' },
                { english: 'safeguard', chinese: '‰øùÊä§ÔºõÊççÂç´', pronunciation: '/Ààse…™f…°…ëÀêrd/' },
                { english: 'rescue', chinese: 'ÊïëÊè¥', pronunciation: '/ÀàreskjuÀê/' },
                { english: 'heatwave', chinese: 'ÁÉ≠Êµ™', pronunciation: '/ÀàhiÀêtwe…™v/' },
                { english: 'firefighter', chinese: 'Ê∂àÈò≤Âëò', pronunciation: '/Ààfa…™…ôrfa…™t…ôr/' },
                { english: 'volunteer', chinese: 'ÂøóÊÑøËÄÖ', pronunciation: '/Àåv…ëÀêl…ônÀàt…™r/' },
                { english: 'alarm', chinese: 'Ë≠¶Êä•ÔºõÈóπÈíü', pronunciation: '/…ôÀàl…ëÀêrm/' },
                { english: 'sudden', chinese: 'Á™ÅÁÑ∂ÁöÑ', pronunciation: '/Ààs ådn/' },
                { english: 'thunder', chinese: 'Èõ∑ÔºõÈõ∑Â£∞', pronunciation: '/ÀàŒ∏ ånd…ôr/' },
                { english: 'rainstorm', chinese: 'Êö¥È£éÈõ®', pronunciation: '/Ààre…™nst…îÀêrm/' },
                { english: 'unlucky', chinese: '‰∏çÂπ∏ÁöÑ', pronunciation: '/ ånÀàl åki/' }
            ],
            unit6: [
                { english: 'shake', chinese: 'Êè°ÊâãÔºõÊëáÂä®', pronunciation: '/ Ée…™k/' },
                { english: 'bow', chinese: 'Èû†Ë∫¨', pronunciation: '/ba ä/' },
                { english: 'bump', chinese: 'Á¢∞ÔºõÊíû', pronunciation: '/b åmp/' },
                { english: 'fist', chinese: 'Êã≥Â§¥', pronunciation: '/f…™st/' },
                { english: 'rub', chinese: 'Êë©Êì¶ÔºõÊèâ', pronunciation: '/r åb/' },
                { english: 'kiss', chinese: '‰∫≤Âêª', pronunciation: '/k…™s/' },
                { english: 'cheek', chinese: 'ËÑ∏È¢ä', pronunciation: '/t ÉiÀêk/' },
                { english: 'hug', chinese: 'Êã•Êä±', pronunciation: '/h å…°/' },
                { english: 'embarrassed', chinese: 'Â∞¥Â∞¨ÁöÑ', pronunciation: '/…™mÀàb√¶r…ôst/' },
                { english: 'confused', chinese: 'Âõ∞ÊÉëÁöÑ', pronunciation: '/k…ônÀàfjuÀêzd/' },
                { english: 'formal', chinese: 'Ê≠£ÂºèÁöÑ', pronunciation: '/Ààf…îÀêrml/' },
                { english: 'curry', chinese: 'ÂíñÂñ±Ëèú', pronunciation: '/Ààk åri/' },
                { english: 'rude', chinese: 'Á≤óÈ≤ÅÁöÑ', pronunciation: '/ruÀêd/' },
                { english: 'uncommon', chinese: 'ÁΩïËßÅÁöÑ', pronunciation: '/ ånÀàk…ëÀêm…ôn/' },
                { english: 'palm', chinese: 'ÊâãÊéå', pronunciation: '/p…ëÀêm/' },
                { english: 'fork', chinese: 'ÂèâÂ≠ê', pronunciation: '/f…îÀêrk/' },
                { english: 'manner', chinese: 'ÊñπÂºèÔºõÁ§º‰ª™', pronunciation: '/Ààm√¶n…ôr/' },
                { english: 'confusing', chinese: '‰ª§‰∫∫Âõ∞ÊÉëÁöÑ', pronunciation: '/k…ônÀàfjuÀêz…™≈ã/' },
                { english: 'unless', chinese: 'Èô§Èùû', pronunciation: '/…ônÀàles/' },
                { english: 'proper', chinese: 'ÊÅ∞ÂΩìÁöÑ', pronunciation: '/Ààpr…ëÀêp…ôr/' },
                { english: 'elbow', chinese: 'ÊâãËÇò', pronunciation: '/Ààelbo ä/' },
                { english: 'chopstick', chinese: 'Á≠∑Â≠ê', pronunciation: '/Ààt É…ëÀêpst…™k/' },
                { english: 'embarrassing', chinese: '‰Ωø‰∫∫ÈöæÂ†™ÁöÑ', pronunciation: '/…™mÀàb√¶r…ôs…™≈ã/' },
                { english: 'cultural', chinese: 'ÊñáÂåñÁöÑ', pronunciation: '/Ààk ålt É…ôr…ôl/' },
                { english: 'custom', chinese: '‰π†‰øó', pronunciation: '/Ààk åst…ôm/' },
                { english: 'occasion', chinese: 'Âú∫Âêà', pronunciation: '/…ôÀàke…™ ín/' },
                { english: 'blouse', chinese: 'Â•≥ÂºèË°¨Ë°´', pronunciation: '/bla äs/' },
                { english: 'private', chinese: 'ÁßÅ‰∫∫ÁöÑ', pronunciation: '/Ààpra…™v…ôt/' },
                { english: 'whether', chinese: 'ÊòØÂê¶', pronunciation: '/Ààwe√∞…ôr/' },
                { english: 'married', chinese: 'Â∑≤Â©öÁöÑ', pronunciation: '/Ààmerid/' },
                { english: 'unsafe', chinese: '‰∏çÂÆâÂÖ®ÁöÑ', pronunciation: '/ ånÀàse…™f/' },
                { english: 'improper', chinese: '‰∏çÂêàÈÄÇÁöÑ', pronunciation: '/…™mÀàpr…ëÀêp…ôr/' },
                { english: 'informal', chinese: 'ÈùûÊ≠£ÂºèÁöÑ', pronunciation: '/…™nÀàf…îÀêrml/' },
                { english: 'jeans', chinese: 'Áâõ‰ªîË£§', pronunciation: '/d íiÀênz/' },
                { english: 'marry', chinese: 'ÁªìÂ©ö', pronunciation: '/Ààmeri/' },
                { english: 'congratulate', chinese: 'Á•ùË¥∫', pronunciation: '/k…ônÀà…°r√¶t Éule…™t/' },
                { english: 'Asian', chinese: '‰∫öÊ¥≤ÁöÑÔºõ‰∫öÊ¥≤‰∫∫', pronunciation: '/Ààe…™ Én/' },
                { english: 'tradition', chinese: '‰º†Áªü', pronunciation: '/tr…ôÀàd…™ Én/' },
                { english: 'correctly', chinese: 'Ê≠£Á°ÆÂú∞', pronunciation: '/k…ôÀàrektli/' },
                { english: 'receive', chinese: 'Êî∂Âà∞', pronunciation: '/r…™ÀàsiÀêv/' },
                { english: 'impression', chinese: 'Âç∞Ë±°', pronunciation: '/…™mÀàpre Én/' },
                { english: 'cheer', chinese: 'Ê¨¢Âëº', pronunciation: '/t É…™r/' }
            ],
            unit7: [
                { english: 'adventure', chinese: 'ÂÜíÈô©ÔºõÂÜíÈô©ÁªèÂéÜ', pronunciation: '/…ôdÀàvent É…ôr/' },
                { english: 'fantasy', chinese: 'ÂπªÊÉ≥ÔºõÂπªÊÉ≥‰ΩúÂìÅ', pronunciation: '/Ààf√¶nt…ôsi/' },
                { english: 'mystery', chinese: 'ÊÇ¨ÁñëÂ∞èËØ¥ÔºõÂ••Áßò', pronunciation: '/Ààm…™stri/' },
                { english: 'fiction', chinese: 'Â∞èËØ¥', pronunciation: '/Ààf…™k Én/' },
                { english: 'science fiction', chinese: 'ÁßëÂπªÂ∞èËØ¥', pronunciation: '/Ààsa…™…ôns Ààf…™k Én/' },
                { english: 'detective', chinese: '‰æ¶Êé¢', pronunciation: '/d…™Ààtekt…™v/' },
                { english: 'alien', chinese: 'Â§ñÊòü‰∫∫', pronunciation: '/Ààe…™li…ôn/' },
                { english: 'attack', chinese: 'ÊîªÂáªÔºõËøõÊîª', pronunciation: '/…ôÀàt√¶k/' },
                { english: 'historical', chinese: 'ÂéÜÂè≤ÁöÑ', pronunciation: '/h…™Ààst…îÀêr…™kl/' },
                { english: 'force', chinese: 'Âº∫Ëø´ÔºõÂäõÈáè', pronunciation: '/f…îÀêrs/' },
                { english: 'steal', chinese: 'ÂÅ∑ÔºõÁ™ÉÂèñ', pronunciation: '/stiÀêl/' },
                { english: 'punish', chinese: 'ÊÉ©ÁΩö', pronunciation: '/Ààp ån…™ É/' },
                { english: 'idiom', chinese: '‰π†ËØ≠ÔºõÊàêËØ≠', pronunciation: '/Àà…™di…ôm/' },
                { english: 'recently', chinese: 'ÊúÄËøë', pronunciation: '/ÀàriÀêsntli/' },
                { english: 'lost', chinese: 'Ëø∑Ë∑ØÁöÑÔºõ‰∏¢Â§±ÁöÑ', pronunciation: '/l…îÀêst/' },
                { english: 'recommend', chinese: 'Êé®Ëçê', pronunciation: '/Àårek…ôÀàmend/' },
                { english: 'society', chinese: 'Á§æ‰ºö', pronunciation: '/s…ôÀàsa…™…ôti/' },
                { english: 'literary', chinese: 'ÊñáÂ≠¶ÁöÑ', pronunciation: '/Ààl…™t…ôreri/' },
                { english: 'base', chinese: '‰ª•‚Ä¶‰∏∫Âü∫Á°ÄÔºõÂü∫Á°Ä', pronunciation: '/be…™s/' },
                { english: 'summary', chinese: 'ÊÄªÁªìÔºõÊ¶ÇË¶Å', pronunciation: '/Ààs åm…ôri/' },
                { english: 'spoiled', chinese: 'ÂÆ†ÂùèÁöÑ', pronunciation: '/sp…î…™ld/' },
                { english: 'selfish', chinese: 'Ëá™ÁßÅÁöÑ', pronunciation: '/Ààself…™ É/' },
                { english: 'lock', chinese: 'ÈîÅ', pronunciation: '/l…ëÀêk/' },
                { english: 'unlock', chinese: 'ÂºÄÈîÅ', pronunciation: '/ ånÀàl…ëÀêk/' },
                { english: 'secret', chinese: 'ÁßòÂØÜ', pronunciation: '/ÀàsiÀêkr…ôt/' },
                { english: 'key', chinese: 'Èí•ÂåôÔºõÂÖ≥ÈîÆ', pronunciation: '/kiÀê/' },
                { english: 'discover', chinese: 'ÂèëÁé∞', pronunciation: '/d…™Ààsk åv…ôr/' },
                { english: 'garden', chinese: 'Ëä±Âõ≠', pronunciation: '/Àà…°…ëÀêrdn/' },
                { english: 'wall', chinese: 'Â¢ô', pronunciation: '/w…îÀêl/' },
                { english: 'surprise', chinese: 'ÊÉäÂñúÔºõÊÉäËÆ∂', pronunciation: '/s…ôrÀàpra…™z/' },
                { english: 'lonely', chinese: 'Â≠§Áã¨ÁöÑ', pronunciation: '/Ààlo änli/' },
                { english: 'friend', chinese: 'ÊúãÂèã', pronunciation: '/frend/' },
                { english: 'magic', chinese: 'È≠îÊ≥ï', pronunciation: '/Ààm√¶d í…™k/' },
                { english: 'character', chinese: 'ËßíËâ≤Ôºõ‰∫∫Áâ©', pronunciation: '/Ààk√¶r…ôkt…ôr/' },
                { english: 'plot', chinese: 'ÊÉÖËäÇ', pronunciation: '/pl…ëÀêt/' },
                { english: 'ending', chinese: 'ÁªìÂ±Ä', pronunciation: '/Ààend…™≈ã/' },
                { english: 'author', chinese: '‰ΩúËÄÖ', pronunciation: '/Àà…îÀêŒ∏…ôr/' },
                { english: 'reader', chinese: 'ËØªËÄÖ', pronunciation: '/ÀàriÀêd…ôr/' },
                { english: 'classic', chinese: 'ÁªèÂÖ∏‰ΩúÂìÅ', pronunciation: '/Ààkl√¶s…™k/' },
                { english: 'novel', chinese: 'ÈïøÁØáÂ∞èËØ¥', pronunciation: '/Ààn…ëÀêvl/' }
            ],
            unit8: [
                { english: 'treasure', chinese: 'Ë¥¢ÂØåÔºõÁèçÂÆù', pronunciation: '/Ààtre í…ôr/' },
                { english: 'island', chinese: 'Â≤õ', pronunciation: '/Ààa…™l…ônd/' },
                { english: 'classic', chinese: 'ÁªèÂÖ∏‰ΩúÂìÅ', pronunciation: '/Ààkl√¶s…™k/' },
                { english: 'page', chinese: 'È°µ', pronunciation: '/pe…™d í/' },
                { english: 'hurry', chinese: 'ÂåÜÂøôÔºõËµ∂Âø´', pronunciation: '/Ààh…úÀêri/' },
                { english: 'due', chinese: 'È¢ÑÊúüÁöÑÔºõÂà∞ÊúüÁöÑ', pronunciation: '/duÀê/' },
                { english: 'ship', chinese: 'Ëàπ', pronunciation: '/ É…™p/' },
                { english: 'tool', chinese: 'Â∑•ÂÖ∑', pronunciation: '/tuÀêl/' },
                { english: 'gun', chinese: 'Êû™', pronunciation: '/…° ån/' },
                { english: 'mark', chinese: 'ËÆ∞Âè∑ÔºõÊ†áËÆ∞', pronunciation: '/m…ëÀêrk/' },
                { english: 'sand', chinese: 'Ê≤ôÂ≠ê', pronunciation: '/s√¶nd/' },
                { english: 'cannibal', chinese: 'È£ü‰∫∫ËÇâËÄÖ', pronunciation: '/Ààk√¶n…™bl/' },
                { english: 'towards', chinese: 'ÊúùÂêë', pronunciation: '/t…ôÀàw…îÀêrdz/' },
                { english: 'land', chinese: 'ÈôÜÂú∞', pronunciation: '/l√¶nd/' },
                { english: 'fiction', chinese: 'Â∞èËØ¥', pronunciation: '/Ààf…™k Én/' },
                { english: 'technology', chinese: 'ÁßëÊäÄ', pronunciation: '/tekÀàn…ëÀêl…ôd íi/' },
                { english: 'French', chinese: 'Ê≥ïËØ≠ÔºõÊ≥ïÂõΩÁöÑ', pronunciation: '/frent É/' },
                { english: 'pop', chinese: 'ÊµÅË°åÈü≥‰πê', pronunciation: '/p…ëÀêp/' },
                { english: 'rock', chinese: 'ÊëáÊªö‰πê', pronunciation: '/r…ëÀêk/' },
                { english: 'band', chinese: '‰πêÈòü', pronunciation: '/b√¶nd/' },
                { english: 'forever', chinese: 'Ê∞∏Ëøú', pronunciation: '/f…ôrÀàev…ôr/' },
                { english: 'abroad', chinese: 'Âú®ÂõΩÂ§ñ', pronunciation: '/…ôÀàbr…îÀêd/' },
                { english: 'fan', chinese: 'Ëø∑ÔºõÁ≤â‰∏ù', pronunciation: '/f√¶n/' },
                { english: 'southern', chinese: 'ÂçóÊñπÁöÑ', pronunciation: '/Ààs å√∞…ôrn/' },
                { english: 'modern', chinese: 'Áé∞‰ª£ÁöÑ', pronunciation: '/Ààm…ëÀêd…ôrn/' },
                { english: 'success', chinese: 'ÊàêÂäü', pronunciation: '/s…ôkÀàses/' },
                { english: 'belong', chinese: 'Â±û‰∫é', pronunciation: '/b…™Ààl…îÀê≈ã/' },
                { english: 'laughter', chinese: 'Á¨ëÂ£∞', pronunciation: '/Ààl√¶ft…ôr/' },
                { english: 'beauty', chinese: 'ÁæéÔºõÁæé‰∏Ω', pronunciation: '/ÀàbjuÀêti/' },
                { english: 'record', chinese: 'ËÆ∞ÂΩïÔºõÂî±Áâá', pronunciation: '/Ààrek…ôrd/' },
                { english: 'introduce', chinese: '‰ªãÁªç', pronunciation: '/Àå…™ntr…ôÀàduÀês/' },
                { english: 'line', chinese: 'Ë°åÔºõÁ∫ø', pronunciation: '/la…™n/' },
                { english: 'actually', chinese: '‰∫ãÂÆû‰∏ä', pronunciation: '/Àà√¶kt Éu…ôli/' },
                { english: 'million', chinese: 'Áôæ‰∏á', pronunciation: '/Ààm…™lj…ôn/' },
                { english: 'abroad', chinese: 'Âú®ÂõΩÂ§ñ', pronunciation: '/…ôÀàbr…îÀêd/' },
                { english: 'study', chinese: 'Â≠¶‰π†ÔºõÁ†îÁ©∂', pronunciation: '/Ààst ådi/' }
            ]
        };

        const levelInfo = [
            { id: 1, unit: 'unit1', name: 'Unit 1 Time to Relax', icon: 'üé®', wordCount: 30, sectionA: '‰ºëÈó≤Ê¥ªÂä®', sectionB: 'Áà±Â•Ω‰∏éÊäÄËÉΩ' },
            { id: 2, unit: 'unit2', name: 'Unit 2 Stay Healthy', icon: 'üè•', wordCount: 35, sectionA: 'ÂÅ•Â∫∑ÈóÆÈ¢ò', sectionB: 'ÂÆâÂÖ®‰∏éÊÄ•Êïë' },
            { id: 3, unit: 'unit3', name: 'Unit 3 Growing Up', icon: 'üå±', wordCount: 35, sectionA: 'ÊÉÖÁª™Ë°®Ëææ', sectionB: '‰∫∫ÈôÖ‰∫§ÂæÄ' },
            { id: 4, unit: 'unit4', name: 'Unit 4 The Wonders of Nature', icon: 'üèîÔ∏è', wordCount: 40, sectionA: 'Ëá™ÁÑ∂Â•áËßÇ', sectionB: 'Êé¢Á¥¢Ëá™ÁÑ∂' },
            { id: 5, unit: 'unit5', name: 'Unit 5 Nature\'s Temper', icon: 'üå™Ô∏è', wordCount: 47, sectionA: 'Ëá™ÁÑ∂ÁÅæÂÆ≥', sectionB: 'ÂÆâÂÖ®Èò≤ËåÉ' },
            { id: 6, unit: 'unit6', name: 'Unit 6 Crossing Cultures', icon: 'üåè', wordCount: 42, sectionA: 'ÊñáÂåñÁ§º‰ª™', sectionB: 'Ë∑®ÊñáÂåñ‰∫§ÊµÅ' },
            { id: 7, unit: 'unit7', name: 'Unit 7 A Good Read', icon: 'üìö', wordCount: 40, sectionA: 'ÊñáÂ≠¶Á±ªÂûã', sectionB: 'ÈòÖËØªÊé®Ëçê' },
            { id: 8, unit: 'unit8', name: 'Unit 8', icon: 'üìñ', wordCount: 36, sectionA: 'ÁªèÂÖ∏ÊñáÂ≠¶', sectionB: 'Èü≥‰πêÊñáÂåñ' }
        ];

        const achievements = [
            { id: 1, name: 'Êñ∞ÊâãÂãáÂ£´', icon: 'üåü', condition: 'ÂÆåÊàêÁ¨¨1ÂçïÂÖÉ' },
            { id: 2, name: 'ËøûÂáªËææ‰∫∫', icon: 'üî•', condition: 'ËøûÁª≠Ê≠£Á°Æ20‰∏™' },
            { id: 3, name: 'ÊãºÂÜôÂ§ßÂ∏à', icon: '‚úçÔ∏è', condition: 'ÊãºÂÜôÊ®°ÂºèÂÖ®ÂØπ10Ê¨°' },
            { id: 4, name: 'ÂçïÂÖÉÁéãËÄÖ', icon: 'üëë', condition: 'ÂÆåÊàêÂÖ®ÈÉ®8ÂçïÂÖÉ' },
            { id: 5, name: 'ËØçÊ±áËææ‰∫∫', icon: 'üìñ', condition: 'ÊéåÊè°100‰∏™ÂçïËØç' },
            { id: 6, name: 'ÂÆåÁæéÈÄöÂÖ≥', icon: 'üèÜ', condition: 'ÂÖ®ÈÉ®ÂçïÂÖÉÊª°ÂàÜ' }
        ];

        // Ê∏∏ÊàèÁä∂ÊÄÅ
        let gameState = {
            currentLevel: 1,
            currentMode: 'card',
            score: 0,
            completedLevels: [],
            correctWords: 0,
            streak: 0,
            maxStreak: 0,
            unlockedAchievements: [],
            spellCorrectCount: 0,
            masteredWords: []
        };

        // ÈÖçÂØπÊ∏∏ÊàèÁä∂ÊÄÅ
        let matchState = {
            selectedCards: [],
            matchedPairs: 0,
            totalPairs: 0
        };

        // ËØ≠Èü≥ÊúóËØªÂäüËÉΩ
        let speechSynthesis = window.speechSynthesis;
        let currentUtterance = null;
        let speechRate = 0.8;

        function speakWord(word, rate = speechRate) {
            if (speechSynthesis.speaking) {
                speechSynthesis.cancel();
            }
            
            currentUtterance = new SpeechSynthesisUtterance(word);
            currentUtterance.lang = 'en-US';
            currentUtterance.rate = rate;
            currentUtterance.pitch = 1;
            
            const voices = speechSynthesis.getVoices();
            const englishVoice = voices.find(voice => voice.lang.includes('en'));
            if (englishVoice) {
                currentUtterance.voice = englishVoice;
            }
            
            speechSynthesis.speak(currentUtterance);
        }

        function speakWordSlowly(word) {
            speakWord(word, 0.5);
        }

        function stopSpeaking() {
            if (speechSynthesis.speaking) {
                speechSynthesis.cancel();
            }
        }

        // ËØ≠Èü≥ËØÜÂà´ÂäüËÉΩ
        let recognition = null;
        let isListening = false;
        let currentMatchCard = null;

        function initSpeechRecognition() {
            if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                recognition = new SpeechRecognition();
                recognition.lang = 'en-US';
                recognition.continuous = false;
                recognition.interimResults = false;
                recognition.maxAlternatives = 3;

                recognition.onstart = () => {
                    isListening = true;
                    updateMicButton(true);
                };

                recognition.onend = () => {
                    isListening = false;
                    updateMicButton(false);
                };

                recognition.onerror = (event) => {
                    isListening = false;
                    updateMicButton(false);
                    console.log('ËØ≠Èü≥ËØÜÂà´ÈîôËØØ:', event.error);
                    if (event.error === 'no-speech') {
                        showFeedback('üé§ Êú™Ê£ÄÊµãÂà∞ËØ≠Èü≥ÔºåËØ∑ÈáçËØï', 'wrong');
                    } else if (event.error === 'not-allowed') {
                        showFeedback('üé§ ËØ∑ÂÖÅËÆ∏È∫¶ÂÖãÈ£éÊùÉÈôê', 'wrong');
                    }
                };

                recognition.onresult = (event) => {
                    const results = event.results[0];
                    let spokenWord = '';
                    for (let i = 0; i < results.length; i++) {
                        spokenWord += results[i].transcript + ' ';
                    }
                    spokenWord = spokenWord.trim().toLowerCase();
                    checkSpokenWord(spokenWord);
                };
            }
        }

        function startListening() {
            if (!recognition) {
                initSpeechRecognition();
            }
            
            if (!recognition) {
                showFeedback('üé§ ÊÇ®ÁöÑÊµèËßàÂô®‰∏çÊîØÊåÅËØ≠Èü≥ËØÜÂà´', 'wrong');
                return;
            }

            if (isListening) {
                recognition.stop();
                return;
            }

            try {
                recognition.start();
                showFeedback('üé§ ËØ∑ËØ¥Âá∫Ëã±ÊñáÂçïËØç...', 'info');
            } catch (e) {
                console.log('ËØ≠Èü≥ËØÜÂà´ÂêØÂä®Â§±Ë¥•:', e);
            }
        }

        function updateMicButton(listening) {
            const micBtn = document.getElementById('micBtn');
            if (micBtn) {
                if (listening) {
                    micBtn.innerHTML = 'üî¥ ÂΩïÈü≥‰∏≠...';
                    micBtn.classList.add('recording');
                } else {
                    micBtn.innerHTML = 'üé§ ËØ≠Èü≥ÂåπÈÖç';
                    micBtn.classList.remove('recording');
                }
            }
        }

        function checkSpokenWord(spokenWord) {
            const currentWord = document.getElementById('currentMatchWord');
            if (!currentWord) return;
            
            const targetWord = currentWord.value.toLowerCase();
            const spokenWords = spokenWord.split(' ');
            
            let matched = false;
            for (let word of spokenWords) {
                if (word === targetWord || 
                    word === targetWord + 's' || 
                    word === targetWord + 'es' ||
                    word === targetWord + 'ed' ||
                    word === targetWord + 'ing' ||
                    targetWord.indexOf(word) === 0) {
                    matched = true;
                    break;
                }
            }

            if (matched) {
                showFeedback(`‚úì Ê≠£Á°ÆÔºÅ‰Ω†ËØ¥‰∫Ü "${spokenWord}" +10ÂàÜ`, 'correct');
                speakWord(targetWord);
                updateScore(10);
                updateStreak(true);
                updateProgress();
                if (currentMatchCard) {
                    autoMatchCard(currentMatchCard);
                }
            } else {
                showFeedback(`‚úó ‰Ω†ËØ¥ÁöÑÊòØ "${spokenWord}"ÔºåÊ≠£Á°ÆÁ≠îÊ°àÊòØ "${targetWord}"`, 'wrong');
                speakWord(targetWord);
                updateStreak(false);
            }
        }

        function autoMatchCard(card) {
            const cardId = card.dataset.id;
            const matchGrid = document.getElementById('matchGrid');
            const allCards = matchGrid.querySelectorAll('.match-card');
            
            allCards.forEach(c => {
                if (c.dataset.id === cardId && !c.classList.contains('matched')) {
                    c.classList.add('selected');
                    matchState.selectedCards.push(c);
                }
            });

            if (matchState.selectedCards.length >= 2) {
                setTimeout(() => checkMatch(), 300);
            }
        }

        // Âä†ÊùÉÈöèÊú∫ÈÄâÊã©ÂçïËØçÔºàÂ∑≤ÊéåÊè°ÁöÑÂçïËØçÂá∫Áé∞Ê¶ÇÁéáÈôç‰ΩéÔºâ
        function getWeightedRandomWord(words) {
            const weights = words.map(word => {
                if (gameState.masteredWords.includes(word.english)) {
                    return 0.2;
                }
                return 1;
            });
            
            const totalWeight = weights.reduce((sum, w) => sum + w, 0);
            let random = Math.random() * totalWeight;
            
            for (let i = 0; i < words.length; i++) {
                random -= weights[i];
                if (random <= 0) {
                    return words[i];
                }
            }
            
            return words[words.length - 1];
        }

        // Âä†ÊùÉÈöèÊú∫ÈÄâÊã©Â§ö‰∏™ÂçïËØç
        function getWeightedRandomWords(words, count) {
            const availableWords = [...words];
            const selected = [];
            
            for (let i = 0; i < Math.min(count, availableWords.length); i++) {
                const word = getWeightedRandomWord(availableWords);
                selected.push(word);
                const index = availableWords.indexOf(word);
                if (index > -1) {
                    availableWords.splice(index, 1);
                }
            }
            
            return selected;
        }

        // ÂàùÂßãÂåñÊ∏∏Êàè
        function initGame() {
            renderLevels();
            renderAchievements();
            loadGameMode();
            updateStats();
            loadProgress();
        }

        // ‰øùÂ≠òËøõÂ∫¶
        function saveProgress() {
            localStorage.setItem('wordGameProgress2024', JSON.stringify(gameState));
        }

        // Âä†ËΩΩËøõÂ∫¶
        function loadProgress() {
            const saved = localStorage.getItem('wordGameProgress2024');
            if (saved) {
                const data = JSON.parse(saved);
                gameState = { ...gameState, ...data };
                updateStats();
                renderLevels();
                renderAchievements();
            }
        }

        // Ê∏≤ÊüìÂÖ≥Âç°
        function renderLevels() {
            const levelGrid = document.getElementById('levelGrid');
            levelGrid.innerHTML = '';

            levelInfo.forEach(level => {
                const card = document.createElement('button');
                card.className = 'level-card';
                card.setAttribute('role', 'listitem');
                card.setAttribute('aria-label', `${level.name}, ${level.wordCount}‰∏™ÂçïËØç${gameState.completedLevels.includes(level.id) ? ', Â∑≤ÂÆåÊàê' : ''}`);
                
                if (gameState.completedLevels.includes(level.id)) {
                    card.classList.add('completed');
                    card.setAttribute('aria-disabled', 'false');
                }
                
                if (gameState.currentLevel === level.id) {
                    card.classList.add('current');
                    card.setAttribute('aria-current', 'true');
                }
                
                if (level.id > 1 && !gameState.completedLevels.includes(level.id - 1) && !gameState.completedLevels.includes(level.id)) {
                    card.classList.add('locked');
                    card.disabled = true;
                    card.setAttribute('aria-disabled', 'true');
                }

                card.innerHTML = `
                    <div class="level-icon" aria-hidden="true">${level.icon}</div>
                    <div class="level-name">${level.name}</div>
                    <div class="level-sections">
                        <span class="section-badge">Section A</span>
                        <span class="section-badge">Section B</span>
                    </div>
                    <div class="level-wordcount">${level.wordCount}ËØç</div>
                `;

                card.onclick = () => selectLevel(level.id);
                levelGrid.appendChild(card);
            });
        }

        // ÈÄâÊã©ÂÖ≥Âç°
        function selectLevel(levelId) {
            gameState.currentLevel = levelId;
            saveProgress();
            loadGameMode();
            
            document.getElementById('gameArea').scrollIntoView({ 
                behavior: 'smooth' 
            });
        }

        // Ê∏≤ÊüìÊàêÂ∞±
        function renderAchievements() {
            const achievementsDiv = document.getElementById('achievements');
            achievementsDiv.innerHTML = '';

            achievements.forEach(achievement => {
                const div = document.createElement('div');
                div.className = 'achievement';
                div.setAttribute('role', 'listitem');
                
                const isUnlocked = gameState.unlockedAchievements.includes(achievement.id);
                if (isUnlocked) {
                    div.classList.add('unlocked');
                }
                div.setAttribute('aria-label', `${achievement.name}: ${achievement.condition}${isUnlocked ? ', Â∑≤Ëß£ÈîÅ' : ', Êú™Ëß£ÈîÅ'}`);

                div.innerHTML = `
                    <div class="achievement-icon" aria-hidden="true">${achievement.icon}</div>
                    <div><strong>${achievement.name}</strong></div>
                    <div style="color: #555; font-size: 0.9em;">${achievement.condition}</div>
                `;

                achievementsDiv.appendChild(div);
            });
        }

        // Âä†ËΩΩÊ∏∏ÊàèÊ®°Âºè
        function loadGameMode() {
            const gameArea = document.getElementById('gameArea');
            const currentUnit = levelInfo[gameState.currentLevel - 1].unit;
            const words = wordData[currentUnit];
            const levelName = levelInfo[gameState.currentLevel - 1].name;

            // ÈáçÁΩÆÈÖçÂØπÁä∂ÊÄÅ
            matchState = {
                selectedCards: [],
                matchedPairs: 0,
                totalPairs: Math.min(8, words.length)
            };

            switch(gameState.currentMode) {
                case 'match':
                    renderMatchGame(words, gameArea, levelName);
                    break;
                case 'spell':
                    renderSpellGame(words, gameArea, levelName);
                    break;
                case 'fill':
                    renderFillGame(words, gameArea, levelName);
                    break;
                case 'card':
                    renderCardGame(words, gameArea, levelName);
                    break;
            }
        }

        // ÈÖçÂØπÊ∏∏Êàè
        function renderMatchGame(words, container, levelName) {
            const selectedWords = getWeightedRandomWords(words, matchState.totalPairs);
            
            let html = `<div class="unit-title">
                <span>${levelName} - üîó ÂçïËØçÈÖçÂØπËµõ</span>
                <span class="level-wordcount">ÂÖ±${selectedWords.length}ÂØπ</span>
            </div>`;
            html += '<div class="match-info" aria-live="polite">Â∑≤ÈÖçÂØπÔºö<span id="matchedCount">0</span> / <span id="totalCount">' + selectedWords.length + '</span></div>';
            
            html += '<div style="text-align: center; margin-bottom: 15px;">';
            html += '<button id="micBtn" class="action-btn" onclick="startListening()" title="ÁÇπÂáªÂêéËØ¥Âá∫Ëã±ÊñáÂçïËØçËøõË°åÂåπÈÖç" style="font-size: 1.1em; padding: 10px 25px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">üé§ ËØ≠Èü≥ÂåπÈÖç</button>';
            html += '<span id="voiceHint" style="margin-left: 10px; color: #666; font-size: 0.9em;">ÁÇπÂáªÂêéËØ¥Âá∫Ëã±ÊñáÂçïËØç</span>';
            html += '</div>';
            
            html += '<div class="match-grid" id="matchGrid" role="grid" aria-label="ÂçïËØçÈÖçÂØπÂç°ÁâáÂå∫Âüü">';

            let cards = [];
            selectedWords.forEach((word, index) => {
                cards.push({ type: 'en', text: word.english, id: index, english: word.english });
                cards.push({ type: 'zh', text: word.chinese, id: index, english: word.english });
            });

            cards.sort(() => Math.random() - 0.5);

            cards.forEach((card, index) => {
                const cardType = card.type === 'en' ? 'Ëã±Êñá' : '‰∏≠Êñá';
                html += `<div class="match-card" role="gridcell" tabindex="0" data-type="${card.type}" data-id="${card.id}" data-english="${card.english}" data-index="${index}" aria-label="${cardType}: ${card.text}" onclick="selectMatchCard(this)" onkeydown="handleCardKeydown(event, this)">
                    ${card.text}
                </div>`;
            });

            html += '</div>';
            html += '<div style="text-align: center; margin-top: 20px;">';
            html += '<button class="action-btn btn-success" onclick="loadGameMode()">üîÑ ÈáçÊñ∞ÂºÄÂßã</button>';
            html += '<button class="action-btn btn-primary" onclick="changeMode(\'spell\')">‚û°Ô∏è ÂàáÊç¢Ê®°Âºè</button>';
            html += '</div>';
            html += '<input type="hidden" id="currentMatchWord" value="">';

            container.innerHTML = html;

            document.getElementById('matchedCount').textContent = '0';
            document.getElementById('totalCount').textContent = selectedWords.length;
            
            if (!recognition) {
                initSpeechRecognition();
            }
        }

        // Â§ÑÁêÜÂç°ÁâáÈîÆÁõò‰∫ã‰ª∂
        function handleCardKeydown(event, card) {
            if (event.key === 'Enter' || event.key === ' ') {
                event.preventDefault();
                selectMatchCard(card);
            }
        }

        // ÈÄâÊã©ÈÖçÂØπÂç°Áâá
        function selectMatchCard(card) {
            if (card.classList.contains('matched')) return;
            if (matchState.selectedCards.length >= 2) return;

            if (matchState.selectedCards.includes(card)) {
                card.classList.remove('selected');
                matchState.selectedCards = matchState.selectedCards.filter(c => c !== card);
                return;
            }

            card.classList.add('selected');
            matchState.selectedCards.push(card);
            
            if (card.dataset.type === 'en') {
                speakWord(card.textContent.trim());
            } else {
                const currentWordInput = document.getElementById('currentMatchWord');
                if (currentWordInput) {
                    currentWordInput.value = card.dataset.english;
                    currentMatchCard = card;
                }
            }

            if (matchState.selectedCards.length === 2) {
                setTimeout(() => checkMatch(), 300);
            }
        }

        // Ê£ÄÊü•ÈÖçÂØπ
        function checkMatch() {
            const cards = matchState.selectedCards;
            if (cards.length !== 2) return;

            const type1 = cards[0].dataset.type;
            const type2 = cards[1].dataset.type;
            const id1 = cards[0].dataset.id;
            const id2 = cards[1].dataset.id;

            if (type1 !== type2 && id1 === id2) {
                cards.forEach(card => {
                    card.classList.remove('selected');
                    card.classList.add('matched');
                });
                
                matchState.matchedPairs++;
                const matchedEl = document.getElementById('matchedCount');
                if (matchedEl) matchedEl.textContent = matchState.matchedPairs;
                
                showFeedback('‚úì ÈÖçÂØπÊ≠£Á°ÆÔºÅ+10ÂàÜ', 'correct');
                updateScore(10);
                updateStreak(true);
                
                if (matchState.matchedPairs >= matchState.totalPairs) {
                    setTimeout(() => {
                        showFeedback('üéâ ÊÅ≠ÂñúÔºÅÂÖ®ÈÉ®ÈÖçÂØπÂÆåÊàêÔºÅ+50ÂàÜ', 'correct');
                        updateScore(50);
                        completeLevel();
                    }, 500);
                }
            } else {
                cards.forEach(card => {
                    card.classList.add('wrong');
                    setTimeout(() => {
                        card.classList.remove('wrong', 'selected');
                    }, 500);
                });
                
                showFeedback('‚úó ÈÖçÂØπÈîôËØØÔºåÂÜçËØï‰∏ÄÊ¨°', 'wrong');
                updateStreak(false);
            }

            matchState.selectedCards = [];
            updateProgress();
        }

        // ÂÆåÊàêÂÖ≥Âç°
        function completeLevel() {
            if (!gameState.completedLevels.includes(gameState.currentLevel)) {
                gameState.completedLevels.push(gameState.currentLevel);
                saveProgress();
                renderLevels();
                updateStats();
                checkAchievements();
            }
        }

        // ÊãºÂÜôÊ∏∏Êàè
        function renderSpellGame(words, container, levelName) {
            const randomWord = getWeightedRandomWord(words);
            
            let html = `<div class="unit-title">
                <span>${levelName} - ‚úçÔ∏è ÊãºÂÜôÊåëÊàò</span>
                <span class="level-wordcount">Â∑≤Ê≠£Á°Æ${gameState.spellCorrectCount}Ê¨°</span>
            </div>`;
            html += '<p style="text-align: center; color: #555; margin-bottom: 20px;">Âê¨ËØ≠Èü≥ÊãºÂÜôÂçïËØçÔºåÊàñÁÇπÂáªüé§ÊåâÈíÆËØ≠Èü≥ËæìÂÖ•</p>';
            html += '<div class="word-card" role="region" aria-label="ÂçïËØçÊèêÁ§∫">';
            html += `<div class="word-chinese">${randomWord.chinese}</div>`;
            html += `<div class="word-pronunciation">${randomWord.pronunciation}</div>`;
            html += '</div>';
            html += '<div style="text-align: center; margin-bottom: 15px;">';
            html += `<button class="action-btn" onclick="speakWord('${randomWord.english}')" title="Ê≠£Â∏∏ËØ≠ÈÄüÊúóËØª" style="font-size: 1.2em; padding: 10px 20px;">üîä ÊúóËØª</button>`;
            html += `<button class="action-btn" onclick="speakWordSlowly('${randomWord.english}')" title="ÊÖ¢ÈÄüÊúóËØª" style="font-size: 1.2em; padding: 10px 20px;">üê¢ ÊÖ¢ËØª</button>`;
            html += `<button id="spellMicBtn" class="action-btn" onclick="startSpellListening()" title="ËØ≠Èü≥ËæìÂÖ•Á≠îÊ°à" style="font-size: 1.2em; padding: 10px 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">üé§ ËØ≠Èü≥ËæìÂÖ•</button>`;
            html += '</div>';
            html += '<div class="input-area">';
            html += `<label for="spellInput" class="sr-only">ËæìÂÖ•Ëã±ÊñáÂçïËØç</label>`;
            html += `<input type="text" id="spellInput" placeholder="ËæìÂÖ•Ëã±ÊñáÂçïËØçÊàñÁÇπÂáªüé§ËØ≠Èü≥ËæìÂÖ•..." autocomplete="off" aria-describedby="spell-hint">`;
            html += `<span id="spell-hint" class="sr-only">‰∏≠ÊñáÊèêÁ§∫Ôºö${randomWord.chinese}ÔºåËØ∑ÊãºÂÜôÂØπÂ∫îÁöÑËã±ÊñáÂçïËØç</span>`;
            html += '</div>';
            html += '<div style="text-align: center;">';
            html += '<button class="action-btn btn-primary" onclick="checkSpell()">Êèê‰∫§Á≠îÊ°à</button>';
            html += '<button class="action-btn btn-success" onclick="loadGameMode()">‰∏ã‰∏Ä‰∏™</button>';
            html += '<button class="action-btn btn-danger" onclick="showHint()">üí° ÊèêÁ§∫</button>';
            html += '</div>';
            html += `<input type="hidden" id="correctAnswer" value="${randomWord.english}">`;
            html += `<input type="hidden" id="currentWord" value="${randomWord.english}">`;

            container.innerHTML = html;

            document.getElementById('spellInput').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') checkSpell();
            });
            
            setTimeout(() => {
                const input = document.getElementById('spellInput');
                if (input) input.focus();
            }, 300);
            
            if (!recognition) {
                initSpeechRecognition();
            }
        }
        
        let spellRecognition = null;
        let isSpellListening = false;
        
        function initSpellRecognition() {
            if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                spellRecognition = new SpeechRecognition();
                spellRecognition.lang = 'en-US';
                spellRecognition.continuous = false;
                spellRecognition.interimResults = false;
                spellRecognition.maxAlternatives = 1;

                spellRecognition.onstart = () => {
                    isSpellListening = true;
                    updateSpellMicButton(true);
                    showFeedback('üé§ ËØ∑ËØ¥Âá∫Ëã±ÊñáÂçïËØç...', 'info');
                };

                spellRecognition.onend = () => {
                    isSpellListening = false;
                    updateSpellMicButton(false);
                };

                spellRecognition.onerror = (event) => {
                    isSpellListening = false;
                    updateSpellMicButton(false);
                    if (event.error === 'no-speech') {
                        showFeedback('üé§ Êú™Ê£ÄÊµãÂà∞ËØ≠Èü≥ÔºåËØ∑ÈáçËØï', 'wrong');
                    } else if (event.error === 'not-allowed') {
                        showFeedback('üé§ ËØ∑ÂÖÅËÆ∏È∫¶ÂÖãÈ£éÊùÉÈôê', 'wrong');
                    }
                };

                spellRecognition.onresult = (event) => {
                    const spokenWord = event.results[0][0].transcript.trim();
                    const input = document.getElementById('spellInput');
                    if (input) {
                        input.value = spokenWord;
                        showFeedback(`üé§ ËØÜÂà´ÁªìÊûú: "${spokenWord}"`, 'info');
                        setTimeout(() => checkSpell(), 500);
                    }
                };
            }
        }
        
        function startSpellListening() {
            if (!spellRecognition) {
                initSpellRecognition();
            }
            
            if (!spellRecognition) {
                showFeedback('üé§ ÊÇ®ÁöÑÊµèËßàÂô®‰∏çÊîØÊåÅËØ≠Èü≥ËØÜÂà´', 'wrong');
                return;
            }

            if (isSpellListening) {
                spellRecognition.stop();
                return;
            }

            try {
                spellRecognition.start();
            } catch (e) {
                console.log('ËØ≠Èü≥ËØÜÂà´ÂêØÂä®Â§±Ë¥•:', e);
            }
        }
        
        function updateSpellMicButton(listening) {
            const micBtn = document.getElementById('spellMicBtn');
            if (micBtn) {
                if (listening) {
                    micBtn.innerHTML = 'üî¥ ÂΩïÈü≥‰∏≠...';
                    micBtn.classList.add('recording');
                } else {
                    micBtn.innerHTML = 'üé§ ËØ≠Èü≥ËæìÂÖ•';
                    micBtn.classList.remove('recording');
                }
            }
        }

        // Â°´Á©∫Ê∏∏Êàè
        function renderFillGame(words, container, levelName) {
            const randomWord = getWeightedRandomWord(words);
            
            let html = `<div class="unit-title">
                <span>${levelName} - üìù ÊÉÖÊôØÂ°´Á©∫</span>
            </div>`;
            html += '<p style="text-align: center; color: #555; margin-bottom: 20px;">Â∞ÜÂçïËØçÂ°´ÂÖ•Ê≠£Á°ÆÁöÑÂè•Â≠ê‰∏≠</p>';
            html += '<div class="word-card" role="region" aria-label="Â°´Á©∫Âè•Â≠ê">';
            html += `<div class="word-chinese" style="font-size: 1.3em;">${generateSentence(randomWord.english)}</div>`;
            html += '</div>';
            html += '<div class="input-area">';
            html += `<label for="fillInput" class="sr-only">ËæìÂÖ•ÂçïËØç</label>`;
            html += `<input type="text" id="fillInput" placeholder="ËæìÂÖ•ÂçïËØç..." autocomplete="off">`;
            html += '</div>';
            html += '<div style="text-align: center;">';
            html += '<button class="action-btn btn-primary" onclick="checkFill()">Êèê‰∫§Á≠îÊ°à</button>';
            html += '<button class="action-btn btn-success" onclick="loadGameMode()">‰∏ã‰∏Ä‰∏™</button>';
            html += '</div>';
            html += `<input type="hidden" id="correctAnswer" value="${randomWord.english}">`;

            container.innerHTML = html;

            document.getElementById('fillInput').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') checkFill();
            });
            
            setTimeout(() => {
                const input = document.getElementById('fillInput');
                if (input) input.focus();
            }, 100);
        }

        // ÁîüÊàê‰æãÂè•
        function generateSentence(word) {
            const sentences = {
                'relax': "It's important to ______ after a long day of work.",
                'relaxed': "She felt very ______ after the vacation.",
                'relaxing': "Listening to music is very ______ for me.",
                'stress': "Too much ______ can be bad for your health.",
                'tired': "I feel very ______ after running for an hour.",
                'balanced': "A ______ diet is important for good health.",
                'calligraphy': "Chinese ______ is a beautiful art form.",
                'ski': "We plan to ______ in the mountains this winter.",
                'program': "The computer ______ helps us work faster.",
                'instructor': "The ______ taught us how to swim.",
                'fear': "Don't let ______ stop you from trying new things.",
                'poem': "She wrote a beautiful ______ about spring.",
                'stroke': "Each ______ in Chinese writing is important.",
                'ink': "Please put more ______ in the pen.",
                'flute': "She plays the ______ very well.",
                'hiking': "______ is a great way to enjoy nature.",
                'painting': "This ______ was created by a famous artist.",
                'programming': "Learning ______ can help you build apps.",
                'activity': "What ______ do you like to do on weekends?",
                'hobby': "Reading is my favorite ______.",
                'collect': "I like to ______ stamps from different countries.",
                'stamp': "This ______ is worth a lot of money.",
                'coin': "He found an old ______ in the garden.",
                'interest': "I have a strong ______ in music.",
                'skill': "Learning a new ______ takes time and practice.",
                'improve': "Practice helps you ______ your skills.",
                'confidence': "She has great ______ in her abilities.",
                'creative': "Artists are usually very ______ people.",
                'enjoyable': "The trip was very ______ for everyone.",
                'healthy': "Eating vegetables helps you stay ______.",
                'health': "Exercise is good for your ______.",
                'diet': "A balanced ______ is important for everyone.",
                'exercise': "You should ______ for at least 30 minutes every day.",
                'sleep': "Getting enough ______ is important for health.",
                'energy': "Breakfast gives you ______ for the day.",
                'sore': "My throat feels ______ after singing.",
                'throat': "Drink warm water for a sore ______.",
                'stomachache': "I have a ______ from eating too much.",
                'fever': "She has a high ______ and needs to rest.",
                'cough': "Cover your mouth when you ______.",
                'toothache': "A ______ can be very painful.",
                'headache': "I have a ______ from staring at the screen.",
                'test': "We have a ______ tomorrow morning.",
                'flu': "She caught the ______ and stayed home.",
                'medicine': "Take this ______ three times a day.",
                'mask': "Wear a ______ to protect yourself.",
                'virus': "The ______ spreads quickly in winter.",
                'patient': "The ______ is waiting for the doctor.",
                'injury': "He suffered a serious ______ in the accident.",
                'illness': "The ______ kept her in bed for a week.",
                'pain': "The ______ in my leg is getting better.",
                'safety': "______ is the most important thing.",
                'fry': "Don't ______ the food for too long.",
                'stove': "Turn off the ______ after cooking.",
                'flame': "Keep away from the open ______.",
                'panic': "Don't ______ in an emergency.",
                'roll': "The ball began to ______ down the hill.",
                'aid': "First ______ can save lives.",
                'extinguisher': "Use a fire ______ to put out small fires.",
                'smoke': "______ is dangerous to your health.",
                'physical': "______ exercise keeps you fit.",
                'mental': "______ health is as important as physical health.",
                'grow': "Children ______ quickly in their early years.",
                'growth': "The ______ of plants needs sunlight and water.",
                'emotion': "Learning to control your ______ is part of growing up.",
                'emotional': "She became very ______ during the movie.",
                'upset': "Don't be ______ about the small mistake.",
                'lonely': "He felt ______ after moving to a new city.",
                'shocked': "I was ______ by the unexpected news.",
                'alone': "She prefers to work ______.",
                'control': "It's hard to ______ your anger sometimes.",
                'anger': "He couldn't hide his ______.",
                'angry': "Don't get ______ over small things.",
                'advise': "I ______ you to study harder.",
                'advice': "Thank you for your good ______.",
                'hurtful': "His words were very ______ to me.",
                'forgive': "It's important to ______ others' mistakes.",
                'friendship': "A true ______ lasts forever.",
                'relationship': "A good ______ needs trust and respect.",
                'communicate': "We need to ______ more with each other.",
                'communication': "Good ______ is key to understanding.",
                'understand': "I ______ how you feel.",
                'misunderstand': "Don't ______ what I said.",
                'apologize': "You should ______ for being late.",
                'apology': "Please accept my sincere ______.",
                'trust': "______ is the foundation of friendship.",
                'respect': "We should ______ everyone's opinions.",
                'support': "Friends always ______ each other.",
                'encourage': "Teachers ______ students to do their best.",
                'deal with': "We need to ______ this problem carefully.",
                'problem': "Every ______ has a solution.",
                'solve': "Let's work together to ______ this puzzle.",
                'solution': "We need to find a ______ to this problem.",
                'challenge': "Learning a new language is a big ______.",
                'experience': "This was a valuable ______ for me.",
                'teenager': "Being a ______ can be challenging.",
                'wonder': "The Great Wall is one of the greatest ______ of the world.",
                'nature': "We should protect ______ and the environment.",
                'natural': "This is a ______ phenomenon.",
                'measurement': "The ______ of the room is important.",
                'measure': "Please ______ the length of the table.",
                'deep': "The ocean is very ______ in some places.",
                'depth': "The ______ of this lake is 50 meters.",
                'high': "Mount Qomolangma is very ______.",
                'height': "What is the ______ of this building?",
                'long': "The river is very ______.",
                'length': "The ______ of the bridge is 500 meters.",
                'wide': "This road is not ______ enough.",
                'width': "The ______ of the door is 80 centimeters.",
                'size': "What ______ do you need?",
                'area': "The ______ of this park is very large.",
                'population': "The ______ of China is over 1.4 billion.",
                'mountain': "Mount Qomolangma is the highest ______ in the world.",
                'desert': "The Sahara is the largest ______ in the world.",
                'ocean': "The ______ covers about 71% of the earth's surface.",
                'river': "The Yangtze is the longest ______ in China.",
                'lake': "We went boating on the ______.",
                'waterfall': "The ______ is beautiful after the rain.",
                'forest': "Many animals live in the ______.",
                'amazing': "The view from the top is ______.",
                'fantastic': "We had a ______ time at the party.",
                'spectacular': "The fireworks display was ______.",
                'explore': "Scientists ______ the deep ocean.",
                'exploration': "Space ______ has made great progress.",
                'discover': "Columbus ______ America in 1492.",
                'discovery': "The ______ of penicillin changed medicine.",
                'protect': "We must ______ endangered animals.",
                'protection': "Environmental ______ is everyone's responsibility.",
                'environment': "We should protect our ______.",
                'climate': "The ______ is changing due to global warming.",
                'temperature': "The ______ today is 25 degrees.",
                'level': "The water ______ is rising.",
                'surface': "About 71% of the earth's ______ is water.",
                'below': "The temperature fell ______ zero.",
                'above': "The plane flew ______ the clouds.",
                'earth': "The ______ is our only home."
            };
            return sentences[word] || `The word "${word}" fits in this sentence: ______.`;
        }

        // ÂçïËØçÂç°Áâá
        function renderCardGame(words, container, levelName) {
            const randomWord = getWeightedRandomWord(words);
            const isMastered = gameState.masteredWords.includes(randomWord.english);
            const showEnglishFirst = Math.random() < 0.5;
            
            let html = `<div class="unit-title">
                <span>${levelName} - üìñ ÂçïËØçÂç°Áâá</span>
            </div>`;
            
            if (showEnglishFirst) {
                html += '<p style="text-align: center; color: #555; margin-bottom: 20px;">ÁÇπÂáªÂç°ÁâáÊàñÊåâÁ©∫Ê†ºÈîÆÁøªËΩ¨Êü•ÁúãÈü≥Ê†áÂíå‰∏≠Êñá</p>';
                html += '<div class="word-card" onclick="flipCard(this)" onkeydown="handleCardFlipKeydown(event, this)" tabindex="0" role="button" aria-label="ÂçïËØçÂç°ÁâáÔºåÊåâÁ©∫Ê†ºÈîÆÁøªËΩ¨" style="cursor: pointer;">';
                html += `<div class="card-front">`;
                html += `<div class="word-english">${randomWord.english}</div>`;
                if (isMastered) {
                    html += `<div style="color: #11998e; margin-top: 15px;">‚úì Â∑≤ÊéåÊè°</div>`;
                } else {
                    html += `<div style="color: #666; margin-top: 15px;">üëÜ ÁÇπÂáªÁøªËΩ¨</div>`;
                }
                html += `</div>`;
                html += `<div class="card-back" style="display: none;">`;
                html += `<div class="word-pronunciation">${randomWord.pronunciation}</div>`;
                html += `<div class="word-chinese" style="margin-top: 10px;">${randomWord.chinese}</div>`;
                html += `</div>`;
            } else {
                html += '<p style="text-align: center; color: #555; margin-bottom: 20px;">Áúã‰∏≠ÊñáËØ¥Âá∫Ëã±ÊñáÔºåÁÇπÂáªüé§ËØ≠Èü≥È™åËØÅÊàñÁøªËΩ¨Êü•ÁúãÁ≠îÊ°à</p>';
                html += '<div class="word-card" onclick="flipCard(this)" onkeydown="handleCardFlipKeydown(event, this)" tabindex="0" role="button" aria-label="ÂçïËØçÂç°ÁâáÔºåÊåâÁ©∫Ê†ºÈîÆÁøªËΩ¨" style="cursor: pointer;">';
                html += `<div class="card-front">`;
                html += `<div class="word-chinese">${randomWord.chinese}</div>`;
                if (isMastered) {
                    html += `<div style="color: #11998e; margin-top: 15px;">‚úì Â∑≤ÊéåÊè°</div>`;
                } else {
                    html += `<div style="color: #666; margin-top: 15px;">üëÜ ÁÇπÂáªÁøªËΩ¨</div>`;
                }
                html += `</div>`;
                html += `<div class="card-back" style="display: none;">`;
                html += `<div class="word-english">${randomWord.english}</div>`;
                html += `<div class="word-pronunciation" style="margin-top: 10px;">${randomWord.pronunciation}</div>`;
                html += `</div>`;
            }
            
            html += '</div>';
            html += '<div style="text-align: center; margin-top: 15px;">';
            html += `<button class="action-btn" onclick="speakWord('${randomWord.english}')" title="ÊúóËØªÂçïËØç" style="font-size: 1.1em;">üîä ÊúóËØª</button>`;
            if (!showEnglishFirst) {
                html += `<button id="cardMicBtn" class="action-btn" onclick="startCardListening('${randomWord.english}')" title="ËØ≠Èü≥È™åËØÅ" style="font-size: 1.1em; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">üé§ ËØ≠Èü≥È™åËØÅ</button>`;
            }
            html += '</div>';
            html += '<div style="text-align: center; margin-top: 10px;">';
            html += '<button class="action-btn btn-primary" onclick="loadGameMode()">‰∏ã‰∏Ä‰∏™ÂçïËØç</button>';
            if (isMastered) {
                html += '<button class="action-btn btn-success" disabled style="opacity: 0.6;">‚úì Â∑≤ÊéåÊè°</button>';
            } else {
                html += '<button class="action-btn btn-success" onclick="markAsLearned()">‚úì Ê†áËÆ∞‰∏∫Â∑≤ÊéåÊè°</button>';
            }
            html += '</div>';
            html += `<input type="hidden" id="currentWord" value="${randomWord.english}">`;
            html += `<input type="hidden" id="currentWordChinese" value="${randomWord.chinese}">`;

            container.innerHTML = html;
        }
        
        let cardRecognition = null;
        let isCardListening = false;
        let currentCardTargetWord = '';
        
        function startCardListening(targetWord) {
            currentCardTargetWord = targetWord.toLowerCase();
            
            if (!cardRecognition) {
                if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                    cardRecognition = new SpeechRecognition();
                    cardRecognition.lang = 'en-US';
                    cardRecognition.continuous = false;
                    cardRecognition.interimResults = false;
                    cardRecognition.maxAlternatives = 3;

                    cardRecognition.onstart = () => {
                        isCardListening = true;
                        updateCardMicButton(true);
                        showFeedback('üé§ ËØ∑ËØ¥Âá∫Ëã±ÊñáÂçïËØç...', 'info');
                    };

                    cardRecognition.onend = () => {
                        isCardListening = false;
                        updateCardMicButton(false);
                    };

                    cardRecognition.onerror = (event) => {
                        isCardListening = false;
                        updateCardMicButton(false);
                        if (event.error === 'no-speech') {
                            showFeedback('üé§ Êú™Ê£ÄÊµãÂà∞ËØ≠Èü≥ÔºåËØ∑ÈáçËØï', 'wrong');
                        } else if (event.error === 'not-allowed') {
                            showFeedback('üé§ ËØ∑ÂÖÅËÆ∏È∫¶ÂÖãÈ£éÊùÉÈôê', 'wrong');
                        }
                    };

                    cardRecognition.onresult = (event) => {
                        const results = event.results[0];
                        let spokenWord = '';
                        for (let i = 0; i < results.length; i++) {
                            spokenWord += results[i].transcript + ' ';
                        }
                        spokenWord = spokenWord.trim().toLowerCase();
                        checkCardSpokenWord(spokenWord, currentCardTargetWord);
                    };
                }
            }
            
            if (!cardRecognition) {
                showFeedback('üé§ ÊÇ®ÁöÑÊµèËßàÂô®‰∏çÊîØÊåÅËØ≠Èü≥ËØÜÂà´', 'wrong');
                return;
            }

            if (isCardListening) {
                cardRecognition.stop();
                return;
            }

            try {
                cardRecognition.start();
            } catch (e) {
                console.log('ËØ≠Èü≥ËØÜÂà´ÂêØÂä®Â§±Ë¥•:', e);
            }
        }
        
        function checkCardSpokenWord(spokenWord, targetWord) {
            const spokenWords = spokenWord.split(' ');
            
            let matched = false;
            for (let word of spokenWords) {
                if (word === targetWord || 
                    word === targetWord + 's' || 
                    word === targetWord + 'es' ||
                    word === targetWord + 'ed' ||
                    word === targetWord + 'ing' ||
                    targetWord.indexOf(word) === 0) {
                    matched = true;
                    break;
                }
            }

            if (matched) {
                showFeedback(`‚úì Ê≠£Á°ÆÔºÅ‰Ω†ËØ¥‰∫Ü "${spokenWord}" +10ÂàÜ`, 'correct');
                speakWord(targetWord);
                updateScore(10);
                updateStreak(true);
                updateProgress();
            } else {
                showFeedback(`‚úó ‰Ω†ËØ¥ÁöÑÊòØ "${spokenWord}"ÔºåÊ≠£Á°ÆÁ≠îÊ°àÊòØ "${targetWord}"`, 'wrong');
                speakWord(targetWord);
                updateStreak(false);
            }
        }
        
        function updateCardMicButton(listening) {
            const micBtn = document.getElementById('cardMicBtn');
            if (micBtn) {
                if (listening) {
                    micBtn.innerHTML = 'üî¥ ÂΩïÈü≥‰∏≠...';
                    micBtn.classList.add('recording');
                } else {
                    micBtn.innerHTML = 'üé§ ËØ≠Èü≥È™åËØÅ';
                    micBtn.classList.remove('recording');
                }
            }
        }

        // Â§ÑÁêÜÂç°ÁâáÁøªËΩ¨ÈîÆÁõò‰∫ã‰ª∂
        function handleCardFlipKeydown(event, card) {
            if (event.key === 'Enter' || event.key === ' ') {
                event.preventDefault();
                flipCard(card);
            }
        }

        // ÁøªËΩ¨Âç°Áâá
        function flipCard(card) {
            const front = card.querySelector('.card-front');
            const back = card.querySelector('.card-back');
            
            if (front.style.display !== 'none') {
                front.style.display = 'none';
                back.style.display = 'block';
            } else {
                front.style.display = 'block';
                back.style.display = 'none';
            }
        }

        // Ê£ÄÊü•ÊãºÂÜô
        function checkSpell() {
            const input = document.getElementById('spellInput');
            const correct = document.getElementById('correctAnswer').value;
            
            if (input.value.toLowerCase().trim() === correct.toLowerCase()) {
                input.classList.add('correct');
                input.classList.remove('wrong');
                gameState.spellCorrectCount++;
                showFeedback(`‚úì Ê≠£Á°ÆÔºÅ${correct} +15ÂàÜ`, 'correct');
                speakWord(correct);
                updateScore(15);
                updateStreak(true);
                saveProgress();
            } else {
                input.classList.add('wrong');
                input.classList.remove('correct');
                showFeedback(`‚úó ÈîôËØØÔºÅÊ≠£Á°ÆÁ≠îÊ°àÊòØÔºö${correct}`, 'wrong');
                speakWord(correct);
                updateStreak(false);
            }

            updateProgress();
        }

        // Ê£ÄÊü•Â°´Á©∫
        function checkFill() {
            const input = document.getElementById('fillInput');
            const correct = document.getElementById('correctAnswer').value;
            
            if (input.value.toLowerCase().trim() === correct.toLowerCase()) {
                input.classList.add('correct');
                input.classList.remove('wrong');
                showFeedback(`‚úì Ê≠£Á°ÆÔºÅ+20ÂàÜ`, 'correct');
                updateScore(20);
                updateStreak(true);
            } else {
                input.classList.add('wrong');
                input.classList.remove('correct');
                showFeedback(`‚úó ÈîôËØØÔºÅÊ≠£Á°ÆÁ≠îÊ°àÊòØÔºö${correct}`, 'wrong');
                updateStreak(false);
            }

            updateProgress();
        }

        // ÊòæÁ§∫ÊèêÁ§∫
        function showHint() {
            const correct = document.getElementById('correctAnswer').value;
            const input = document.getElementById('spellInput');
            if (input && input.value === '') {
                input.value = correct.substring(0, 3);
                input.focus();
            }
        }

        // Ê†áËÆ∞‰∏∫Â∑≤ÊéåÊè°
        function markAsLearned() {
            const word = document.getElementById('currentWord').value;
            const chinese = document.getElementById('currentWordChinese').value;
            
            if (!gameState.masteredWords.includes(word)) {
                gameState.masteredWords.push(word);
                gameState.correctWords++;
                showFeedback(`‚úì "${word}" Â∑≤Ê†áËÆ∞‰∏∫ÊéåÊè°ÔºÅ`, 'correct');
            } else {
                showFeedback(`"${word}" Â∑≤ÁªèÊéåÊè°Ëøá‰∫Ü`, 'correct');
            }
            
            updateStats();
            checkAchievements();
            saveProgress();
        }

        // ÂàáÊç¢Ê®°Âºè
        function changeMode(mode) {
            gameState.currentMode = mode;
            document.querySelectorAll('.mode-btn').forEach(btn => {
                btn.classList.remove('active');
                btn.setAttribute('aria-pressed', 'false');
                if (btn.dataset.mode === mode) {
                    btn.classList.add('active');
                    btn.setAttribute('aria-pressed', 'true');
                }
            });
            loadGameMode();
        }

        // ÊòæÁ§∫ÂèçÈ¶à
        function showFeedback(message, type) {
            const feedback = document.getElementById('feedback');
            feedback.textContent = message;
            feedback.className = `feedback ${type}`;
            
            setTimeout(() => {
                feedback.className = 'feedback';
            }, 3000);
        }

        // Êõ¥Êñ∞ÂàÜÊï∞
        function updateScore(points) {
            gameState.score += points;
            updateStats();
            saveProgress();
        }

        // Êõ¥Êñ∞ËøûÂáª
        function updateStreak(correct) {
            if (correct) {
                gameState.streak++;
                if (gameState.streak > gameState.maxStreak) {
                    gameState.maxStreak = gameState.streak;
                }
            } else {
                gameState.streak = 0;
            }
            updateStats();
            checkAchievements();
        }

        // Êõ¥Êñ∞ËøõÂ∫¶
        function updateProgress() {
            const progress = Math.min(100, (gameState.score / 1000) * 100);
            const progressFill = document.getElementById('progressFill');
            const progressBar = progressFill.parentElement;
            progressFill.style.width = `${progress}%`;
            progressBar.setAttribute('aria-valuenow', Math.round(progress));
        }

        // Êõ¥Êñ∞ÁªüËÆ°
        function updateStats() {
            document.getElementById('totalScore').textContent = gameState.score;
            document.getElementById('completedLevels').textContent = 
                `${gameState.completedLevels.length}/8`;
            document.getElementById('correctWords').textContent = gameState.correctWords;
            document.getElementById('streak').textContent = gameState.streak;
        }

        // Ê£ÄÊü•ÊàêÂ∞±
        function checkAchievements() {
            if (gameState.completedLevels.length >= 1 && !gameState.unlockedAchievements.includes(1)) {
                unlockAchievement(1);
            }
            if (gameState.maxStreak >= 20 && !gameState.unlockedAchievements.includes(2)) {
                unlockAchievement(2);
            }
            if (gameState.spellCorrectCount >= 10 && !gameState.unlockedAchievements.includes(3)) {
                unlockAchievement(3);
            }
            if (gameState.completedLevels.length >= 8 && !gameState.unlockedAchievements.includes(4)) {
                unlockAchievement(4);
            }
            if (gameState.correctWords >= 100 && !gameState.unlockedAchievements.includes(5)) {
                unlockAchievement(5);
            }
        }

        // Ëß£ÈîÅÊàêÂ∞±
        function unlockAchievement(id) {
            gameState.unlockedAchievements.push(id);
            const achievement = achievements.find(a => a.id === id);
            showFeedback(`üèÖ Ëß£ÈîÅÊàêÂ∞±Ôºö${achievement.name}ÔºÅ`, 'correct');
            renderAchievements();
            saveProgress();
        }

        // Ê®°ÂºèÂàáÊç¢
        document.querySelectorAll('.mode-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.mode-btn').forEach(b => {
                    b.classList.remove('active');
                    b.setAttribute('aria-pressed', 'false');
                });
                btn.classList.add('active');
                btn.setAttribute('aria-pressed', 'true');
                gameState.currentMode = btn.dataset.mode;
                loadGameMode();
            });
        });

        // ÂàùÂßãÂåñ
        initGame();
    </script>
</body>
</html>